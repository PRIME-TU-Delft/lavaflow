import{S as F,i as J,s as y,y as b,a as R,z as v,c as L,A as k,b as g,d as $,f as E,g as m,B as w,h as p,I as N,o as K,k as z,q as h,l as G,m as H,r as S,n as X,G as j,H as _,e as T,v as P}from"../chunks/index.525666b8.mjs";import{g as q}from"../chunks/navigation.da2d0a62.mjs";import{A as I}from"../chunks/ActionButton.b6436ad5.mjs";import{A as O}from"../chunks/ActionMenu.61217329.mjs";import{E as Q}from"../chunks/ErrorMessage.e4cefdaa.mjs";import{M as U}from"../chunks/Menubar.9b380d9b.mjs";import{P as W}from"../chunks/P5PreviewCurves.afee0185.mjs";import{c as Y}from"../chunks/contourLineStore.51cd97ee.mjs";import{d as Z}from"../chunks/difficultyStore.73951052.mjs";import{g as B}from"../chunks/gltfStore.4f83be3c.mjs";function x(i){let t,o;return{c(){t=z("div"),o=h("Re-scan"),this.h()},l(e){t=G(e,"DIV",{slot:!0});var r=H(t);o=S(r,"Re-scan"),r.forEach(p),this.h()},h(){X(t,"slot","backTitle")},m(e,r){g(e,t,r),j(t,o)},p:_,d(e){e&&p(t)}}}function C(i){let t,o;return t=new W({props:{curves:i[3]?.curves}}),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,r){k(t,e,r),o=!0},p(e,r){const s={};r&8&&(s.curves=e[3]?.curves),t.$set(s)},i(e){o||(m(t.$$.fragment,e),o=!0)},o(e){$(t.$$.fragment,e),o=!1},d(e){w(t,e)}}}function V(i){let t,o;return t=new Q({props:{error:i[0].error}}),t.$on("dismiss",i[4]),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,r){k(t,e,r),o=!0},p(e,r){const s={};r&1&&(s.error=e[0].error),t.$set(s)},i(e){o||(m(t.$$.fragment,e),o=!0)},o(e){$(t.$$.fragment,e),o=!1},d(e){w(t,e)}}}function ee(i){let t;return{c(){t=h("Show in 3D model")},l(o){t=S(o,"Show in 3D model")},m(o,e){g(o,t,e)},d(o){o&&p(t)}}}function te(i){let t,o;return{c(){t=z("div"),o=h("Loading contour lines"),this.h()},l(e){t=G(e,"DIV",{slot:!0});var r=H(t);o=S(r,"Loading contour lines"),r.forEach(p),this.h()},h(){X(t,"slot","loading")},m(e,r){g(e,t,r),j(t,o)},p:_,d(e){e&&p(t)}}}function re(i){let t,o;return t=new I({props:{loading:!i[1],href:"/visual/ar",$$slots:{default:[se]},$$scope:{ctx:i}}}),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,r){k(t,e,r),o=!0},p(e,r){const s={};r&2&&(s.loading=!e[1]),r&64&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){o||(m(t.$$.fragment,e),o=!0)},o(e){$(t.$$.fragment,e),o=!1},d(e){w(t,e)}}}function oe(i){let t,o;return t=new I({props:{loading:!i[1],href:"/visual/ar",$$slots:{default:[ae]},$$scope:{ctx:i}}}),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,r){k(t,e,r),o=!0},p(e,r){const s={};r&2&&(s.loading=!e[1]),r&64&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){o||(m(t.$$.fragment,e),o=!0)},o(e){$(t.$$.fragment,e),o=!1},d(e){w(t,e)}}}function ne(i){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function se(i){let t,o="(no official support)",e;return{c(){t=h("Show in AR "),e=h(o)},l(r){t=S(r,"Show in AR "),e=S(r,o)},m(r,s){g(r,t,s),g(r,e,s)},p:_,d(r){r&&p(t),r&&p(e)}}}function ae(i){let t,o="(Recommended)",e;return{c(){t=h("Show in AR "),e=h(o)},l(r){t=S(r,"Show in AR "),e=S(r,o)},m(r,s){g(r,t,s),g(r,e,s)},p:_,d(r){r&&p(t),r&&p(e)}}}function ie(i){let t,o,e,r,s,c,f,n=i[0].error&&V(i);o=new I({props:{loading:!i[1],secondary:!0,href:"/visual/3d",$$slots:{loading:[te],default:[ee]},$$scope:{ctx:i}}});const l=[ne,oe,re],d=[];function A(a,u){return a[1]?a[2]?1:2:0}return r=A(i),s=d[r]=l[r](i),{c(){n&&n.c(),t=R(),b(o.$$.fragment),e=R(),s.c(),c=T()},l(a){n&&n.l(a),t=L(a),v(o.$$.fragment,a),e=L(a),s.l(a),c=T()},m(a,u){n&&n.m(a,u),g(a,t,u),k(o,a,u),g(a,e,u),d[r].m(a,u),g(a,c,u),f=!0},p(a,u){a[0].error?n?(n.p(a,u),u&1&&m(n,1)):(n=V(a),n.c(),m(n,1),n.m(t.parentNode,t)):n&&(P(),$(n,1,1,()=>{n=null}),E());const M={};u&2&&(M.loading=!a[1]),u&64&&(M.$$scope={dirty:u,ctx:a}),o.$set(M);let D=r;r=A(a),r===D?d[r].p(a,u):(P(),$(d[D],1,1,()=>{d[D]=null}),E(),s=d[r],s?s.p(a,u):(s=d[r]=l[r](a),s.c()),m(s,1),s.m(c.parentNode,c))},i(a){f||(m(n),m(o.$$.fragment,a),m(s),f=!0)},o(a){$(n),$(o.$$.fragment,a),$(s),f=!1},d(a){n&&n.d(a),a&&p(t),w(o,a),a&&p(e),d[r].d(a),a&&p(c)}}}function le(i){let t,o,e=i[3],r,s,c;t=new U({props:{back:"/capture",title:"preview",$$slots:{backTitle:[x]},$$scope:{ctx:i}}});let f=C(i);return s=new O({props:{$$slots:{default:[ie]},$$scope:{ctx:i}}}),{c(){b(t.$$.fragment),o=R(),f.c(),r=R(),b(s.$$.fragment)},l(n){v(t.$$.fragment,n),o=L(n),f.l(n),r=L(n),v(s.$$.fragment,n)},m(n,l){k(t,n,l),g(n,o,l),f.m(n,l),g(n,r,l),k(s,n,l),c=!0},p(n,[l]){const d={};l&64&&(d.$$scope={dirty:l,ctx:n}),t.$set(d),l&8&&y(e,e=n[3])?(P(),$(f,1,1,_),E(),f=C(n),f.c(),m(f,1),f.m(r.parentNode,r)):f.p(n,l);const A={};l&71&&(A.$$scope={dirty:l,ctx:n}),s.$set(A)},i(n){c||(m(t.$$.fragment,n),m(f),m(s.$$.fragment,n),c=!0)},o(n){$(t.$$.fragment,n),$(f),$(s.$$.fragment,n),c=!1},d(n){w(t,n),n&&p(o),f.d(n),n&&p(r),w(s,n)}}}function fe(i,t,o){let e,r;N(i,Y,l=>o(3,e=l)),N(i,Z,l=>o(5,r=l));let{data:s}=t,c=!1,f=!1;K(async()=>{if(!e.curves||!e.hierarchy)return q("/capture");console.log(e.curves),await B.setup(e,r.lava_forking),B.build(e),o(2,f=await navigator?.xr?.isSessionSupported("immersive-ar")??!1),o(1,c=!0)});const n=()=>q("/preview");return i.$$set=l=>{"data"in l&&o(0,s=l.data)},[s,c,f,e,n]}class ke extends F{constructor(t){super(),J(this,t,fe,le,y,{data:0})}}export{ke as default};
