import{S as Y,i as Q,s as U,e as R,b as d,H as F,L as _e,h as m,I as V,k as E,q as y,a as P,l as M,m as L,r as w,c as S,n as H,p as D,M as G,G as k,N,O as W,P as J,g as h,v as K,d as v,f as X,y as T,z,Q as ee,A as I,R as te,B,T as ne,w as me,u as Z}from"../chunks/index.057f4a85.mjs";import{A as x}from"../chunks/ActionButton.1b02aa5e.mjs";import{M as $e,A as de,B as be}from"../chunks/Menubar.353b8d6f.mjs";import{d as he}from"../chunks/difficultyStore.b092fb2c.mjs";import{t as A,c as ge}from"../chunks/locationStore.db8dd4e3.mjs";import{B as ke,I as ve,b as ye,c as we,d as Ce}from"../chunks/Preview.svelte_svelte_type_style_lang.fcda0ea2.mjs";import{P as Te}from"../chunks/P5PreviewCurves.23d5553f.mjs";import{c as ze}from"../chunks/contourLineStore.c24223e7.mjs";import{s as Ie}from"../chunks/sizeStore.86b501f4.mjs";function le(r,t,l){const e=r.slice();return e[8]=t[l],e[10]=l,e}function re(r){let t,l,e,n,s,i,o,a,f,u,c;function $(){return r[5](r[8])}return{c(){t=E("p"),l=y("Delete this turbine?"),e=P(),n=E("div"),s=E("button"),i=y("Yes, delete"),o=P(),a=E("button"),f=y("Cancel"),this.h()},l(p){t=M(p,"P",{class:!0});var _=L(t);l=w(_,"Delete this turbine?"),_.forEach(m),e=S(p),n=M(p,"DIV",{class:!0});var b=L(n);s=M(b,"BUTTON",{class:!0});var C=L(s);i=w(C,"Yes, delete"),C.forEach(m),o=S(b),a=M(b,"BUTTON",{class:!0});var O=L(a);f=w(O,"Cancel"),O.forEach(m),b.forEach(m),this.h()},h(){H(t,"class","mb-1 text-sm text-slate-400"),H(s,"class","bg-red-200 p-2"),H(a,"class","bg-white p-2"),H(n,"class","flex w-full gap-2 text-slate-900")},m(p,_){d(p,t,_),k(t,l),d(p,e,_),d(p,n,_),k(n,s),k(s,i),k(n,o),k(n,a),k(a,f),u||(c=[N(s,"click",W($)),N(a,"click",W(r[3]))],u=!0)},p(p,_){r=p},d(p){p&&m(t),p&&m(e),p&&m(n),u=!1,J(c)}}}function se(r){let t,l,e=r[10]+1+"",n,s,i,o,a,f=r[8].hasConfirmOpen&&re(r);function u(){return r[6](r[8])}function c(){return r[7](r[8])}return{c(){t=E("div"),l=y("Turbine "),n=y(e),s=P(),f&&f.c(),i=P(),this.h()},l($){t=M($,"DIV",{class:!0,style:!0});var p=L(t);l=w(p,"Turbine "),n=w(p,e),s=S(p),f&&f.l(p),i=S(p),p.forEach(m),this.h()},h(){H(t,"class","turbine svelte-1j1nm92"),D(t,"--pos-x",r[8].x*r[0][0]+"px"),D(t,"--pos-y",r[8].y*r[0][1]+"px"),G(t,"top",r[8].hasConfirmOpen)},m($,p){d($,t,p),k(t,l),k(t,n),k(t,s),f&&f.m(t,null),k(t,i),o||(a=[N(t,"click",W(u)),N(t,"keydown",c)],o=!0)},p($,p){r=$,r[8].hasConfirmOpen?f?f.p(r,p):(f=re(r),f.c(),f.m(t,i)):f&&(f.d(1),f=null),p&3&&D(t,"--pos-x",r[8].x*r[0][0]+"px"),p&3&&D(t,"--pos-y",r[8].y*r[0][1]+"px"),p&2&&G(t,"top",r[8].hasConfirmOpen)},d($){$&&m(t),f&&f.d(),o=!1,J(a)}}}function Be(r){let t,l=r[1]||[],e=[];for(let n=0;n<l.length;n+=1)e[n]=se(le(r,l,n));return{c(){for(let n=0;n<e.length;n+=1)e[n].c();t=R()},l(n){for(let s=0;s<e.length;s+=1)e[s].l(n);t=R()},m(n,s){for(let i=0;i<e.length;i+=1)e[i].m(n,s);d(n,t,s)},p(n,[s]){if(s&31){l=n[1]||[];let i;for(i=0;i<l.length;i+=1){const o=le(n,l,i);e[i]?e[i].p(o,s):(e[i]=se(o),e[i].c(),e[i].m(t.parentNode,t))}for(;i<e.length;i+=1)e[i].d(1);e.length=l.length}},i:F,o:F,d(n){_e(e,n),n&&m(t)}}}function Oe(r,t,l){let e;V(r,A,c=>l(1,e=c));let{sizeMult:n=[1,1]}=t;function s(c){A.remove(c.index)}function i(){A.closeAll()}function o(c){i(),A.toggleOpen(c.index)}const a=c=>s(c),f=c=>o(c),u=c=>o(c);return r.$$set=c=>{"sizeMult"in c&&l(0,n=c.sizeMult)},[n,e,s,i,o,a,f,u]}class De extends Y{constructor(t){super(),Q(this,t,Oe,Be,U,{sizeMult:0})}}function ie(r){let t=r[3]+r[4],l,e,n=oe(r);return{c(){n.c(),l=R()},l(s){n.l(s),l=R()},m(s,i){n.m(s,i),d(s,l,i),e=!0},p(s,i){i&24&&U(t,t=s[3]+s[4])?(K(),v(n,1,1,F),X(),n=oe(s),n.c(),h(n,1),n.m(l.parentNode,l)):n.p(s,i)},i(s){e||(h(n),e=!0)},o(s){v(n),e=!1},d(s){s&&m(l),n.d(s)}}}function oe(r){let t,l,e,n,s,i,o,a,f,u,c,$,p;return i=new De({props:{sizeMult:[r[3]/r[7],r[4]/r[8]]}}),f=new Te({props:{curves:r[5]?.curves}}),{c(){t=E("div"),l=E("div"),e=E("div"),n=y("Crater"),s=P(),T(i.$$.fragment),a=P(),T(f.$$.fragment),this.h()},l(_){t=M(_,"DIV",{style:!0});var b=L(t);l=M(b,"DIV",{style:!0,class:!0});var C=L(l);e=M(C,"DIV",{class:!0,style:!0});var O=L(e);n=w(O,"Crater"),O.forEach(m),s=S(C),z(i.$$.fragment,C),C.forEach(m),a=S(b),z(f.$$.fragment,b),b.forEach(m),this.h()},h(){H(e,"class","crater svelte-1jt78hw"),D(e,"--pos-y",r[6][1]*r[3]/r[7]+"px"),D(e,"--pos-x",r[6][0]*r[4]/r[8]+"px"),D(l,"aspect-ratio",r[8]+"/"+r[7]),H(l,"class","overlay svelte-1jt78hw"),ee(()=>r[13].call(l)),G(l,"tall",r[1]/r[0]>=r[8]/r[7]),D(t,"height","100%"),ee(()=>r[15].call(t))},m(_,b){d(_,t,b),k(t,l),k(l,e),k(e,n),k(l,s),I(i,l,null),r[12](l),o=te(l,r[13].bind(l)),k(t,a),I(f,t,null),u=te(t,r[15].bind(t)),c=!0,$||(p=[N(e,"click",W(r[10])),N(e,"keydown",W(r[11])),N(l,"click",r[9]),N(l,"keydown",r[14])],$=!0)},p(_,b){(!c||b&72)&&D(e,"--pos-y",_[6][1]*_[3]/_[7]+"px"),(!c||b&80)&&D(e,"--pos-x",_[6][0]*_[4]/_[8]+"px");const C={};b&24&&(C.sizeMult=[_[3]/_[7],_[4]/_[8]]),i.$set(C),(!c||b&387)&&G(l,"tall",_[1]/_[0]>=_[8]/_[7]);const O={};b&32&&(O.curves=_[5]?.curves),f.$set(O)},i(_){c||(h(i.$$.fragment,_),h(f.$$.fragment,_),c=!0)},o(_){v(i.$$.fragment,_),v(f.$$.fragment,_),c=!1},d(_){_&&m(t),B(i),r[12](null),o(),B(f),u(),$=!1,J(p)}}}function Ee(r){let t,l,e=r[5]?.curves&&ie(r);return{c(){e&&e.c(),t=R()},l(n){e&&e.l(n),t=R()},m(n,s){e&&e.m(n,s),d(n,t,s),l=!0},p(n,[s]){n[5]?.curves?e?(e.p(n,s),s&32&&h(e,1)):(e=ie(n),e.c(),h(e,1),e.m(t.parentNode,t)):e&&(K(),v(e,1,1,()=>{e=null}),X())},i(n){l||(h(e),l=!0)},o(n){v(e),l=!1},d(n){e&&e.d(n),n&&m(t)}}}function Me(r,t,l){let e,n,s,i;V(r,A,g=>l(17,e=g)),V(r,Ie,g=>l(18,n=g)),V(r,ze,g=>l(5,s=g)),V(r,ge,g=>l(6,i=g));let{height:o,width:a}=n,[f,u]=[0,0],[c,$]=[0,0],p,_;function b(g){_=p?.getBoundingClientRect();const j=(g.x-_.left)/($/a),q=(g.y-_.top)/(c/o);if(e.find(pe=>pe.hasConfirmOpen==!0)){A.closeAll();return}if(e.length>=10){console.log("cannot place more than 10 turbines");return}j<20||j>a-20||q<20||q>o-20||A.add({x:j,y:q,index:`${j.toFixed(2)}-${q.toFixed(2)}`,hasConfirmOpen:!1})}function C(g){ne.call(this,r,g)}function O(g){ne.call(this,r,g)}function ae(g){me[g?"unshift":"push"](()=>{p=g,l(2,p)})}function ue(){c=this.clientHeight,$=this.clientWidth,l(3,c),l(4,$)}const fe=()=>console.log("key");function ce(){f=this.clientHeight,u=this.clientWidth,l(0,f),l(1,u)}return r.$$.update=()=>{r.$$.dirty&7&&f+u&&(_=p?.getBoundingClientRect())},[f,u,p,c,$,s,i,o,a,b,C,O,ae,ue,fe,ce]}class Le extends Y{constructor(t){super(),Q(this,t,Me,Ee,U,{})}}function Ae(r){let t,l,e;return t=new ve({props:{path:ye}}),{c(){T(t.$$.fragment),l=y(`
		Reset turbines`)},l(n){z(t.$$.fragment,n),l=w(n,`
		Reset turbines`)},m(n,s){I(t,n,s),d(n,l,s),e=!0},p:F,i(n){e||(h(t.$$.fragment,n),e=!0)},o(n){v(t.$$.fragment,n),e=!1},d(n){B(t,n),n&&m(l)}}}function Pe(r){let t,l;return t=new ke({props:{class:"flex items-center gap-2",outline:!0,color:"red",$$slots:{default:[Ae]},$$scope:{ctx:r}}}),t.$on("click",r[2]),{c(){T(t.$$.fragment)},l(e){z(t.$$.fragment,e)},m(e,n){I(t,e,n),l=!0},p(e,n){const s={};n&32&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){l||(h(t.$$.fragment,e),l=!0)},o(e){v(t.$$.fragment,e),l=!1},d(e){B(t,e)}}}function Se(r){let t,l,e=r[0].type+"",n;return{c(){t=E("div"),l=y("Back to "),n=y(e),this.h()},l(s){t=M(s,"DIV",{slot:!0});var i=L(t);l=w(i,"Back to "),n=w(i,e),i.forEach(m),this.h()},h(){H(t,"slot","backTitle")},m(s,i){d(s,t,i),k(t,l),k(t,n)},p(s,i){i&1&&e!==(e=s[0].type+"")&&Z(n,e)},d(s){s&&m(t)}}}function He(r){let t;return{c(){t=y("Instructions")},l(l){t=w(l,"Instructions")},m(l,e){d(l,t,e)},d(l){l&&m(t)}}}function Ne(r){let t,l;return t=new x({props:{twClass:"w-full",href:"turbine-placement/instructions",secondary:!0,icon:we,$$slots:{default:[He]},$$scope:{ctx:r}}}),{c(){T(t.$$.fragment)},l(e){z(t.$$.fragment,e)},m(e,n){I(t,e,n),l=!0},p(e,n){const s={};n&32&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){l||(h(t.$$.fragment,e),l=!0)},o(e){v(t.$$.fragment,e),l=!1},d(e){B(t,e)}}}function Re(r){let t,l;return t=new x({props:{href:"/visual/"+r[0].type,icon:Ce,$$slots:{default:[We]},$$scope:{ctx:r}}}),{c(){T(t.$$.fragment)},l(e){z(t.$$.fragment,e)},m(e,n){I(t,e,n),l=!0},p(e,n){const s={};n&1&&(s.href="/visual/"+e[0].type),n&33&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){l||(h(t.$$.fragment,e),l=!0)},o(e){v(t.$$.fragment,e),l=!1},d(e){B(t,e)}}}function Ve(r){let t,l;return t=new x({props:{disabled:!0,$$slots:{default:[je]},$$scope:{ctx:r}}}),{c(){T(t.$$.fragment)},l(e){z(t.$$.fragment,e)},m(e,n){I(t,e,n),l=!0},p(e,n){const s={};n&34&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){l||(h(t.$$.fragment,e),l=!0)},o(e){v(t.$$.fragment,e),l=!1},d(e){B(t,e)}}}function We(r){let t,l=r[0].type+"",e;return{c(){t=y("Start eruption in "),e=y(l)},l(n){t=w(n,"Start eruption in "),e=w(n,l)},m(n,s){d(n,t,s),d(n,e,s)},p(n,s){s&1&&l!==(l=n[0].type+"")&&Z(e,l)},d(n){n&&m(t),n&&m(e)}}}function je(r){let t,l,e;return{c(){t=y("Click map to place "),l=y(r[1]),e=y(" more turbines")},l(n){t=w(n,"Click map to place "),l=w(n,r[1]),e=w(n," more turbines")},m(n,s){d(n,t,s),d(n,l,s),d(n,e,s)},p(n,s){s&2&&Z(l,n[1])},d(n){n&&m(t),n&&m(l),n&&m(e)}}}function qe(r){let t,l,e,n,s,i;t=new be({props:{$$slots:{default:[Ne]},$$scope:{ctx:r}}});const o=[Ve,Re],a=[];function f(u,c){return u[1]>0?0:1}return e=f(r),n=a[e]=o[e](r),{c(){T(t.$$.fragment),l=P(),n.c(),s=R()},l(u){z(t.$$.fragment,u),l=S(u),n.l(u),s=R()},m(u,c){I(t,u,c),d(u,l,c),a[e].m(u,c),d(u,s,c),i=!0},p(u,c){const $={};c&32&&($.$$scope={dirty:c,ctx:u}),t.$set($);let p=e;e=f(u),e===p?a[e].p(u,c):(K(),v(a[p],1,1,()=>{a[p]=null}),X(),n=a[e],n?n.p(u,c):(n=a[e]=o[e](u),n.c()),h(n,1),n.m(s.parentNode,s))},i(u){i||(h(t.$$.fragment,u),h(n),i=!0)},o(u){v(t.$$.fragment,u),v(n),i=!1},d(u){B(t,u),u&&m(l),a[e].d(u),u&&m(s)}}}function Fe(r){let t,l,e,n,s,i;return t=new $e({props:{back:"/visual/"+r[0].type,title:"Turbine placement",$$slots:{backTitle:[Se],default:[Pe]},$$scope:{ctx:r}}}),e=new Le({}),s=new de({props:{$$slots:{default:[qe]},$$scope:{ctx:r}}}),{c(){T(t.$$.fragment),l=P(),T(e.$$.fragment),n=P(),T(s.$$.fragment)},l(o){z(t.$$.fragment,o),l=S(o),z(e.$$.fragment,o),n=S(o),z(s.$$.fragment,o)},m(o,a){I(t,o,a),d(o,l,a),I(e,o,a),d(o,n,a),I(s,o,a),i=!0},p(o,[a]){const f={};a&1&&(f.back="/visual/"+o[0].type),a&33&&(f.$$scope={dirty:a,ctx:o}),t.$set(f);const u={};a&35&&(u.$$scope={dirty:a,ctx:o}),s.$set(u)},i(o){i||(h(t.$$.fragment,o),h(e.$$.fragment,o),h(s.$$.fragment,o),i=!0)},o(o){v(t.$$.fragment,o),v(e.$$.fragment,o),v(s.$$.fragment,o),i=!1},d(o){B(t,o),o&&m(l),B(e,o),o&&m(n),B(s,o)}}}function Ge(r,t,l){let e,n,s;V(r,A,a=>l(3,n=a)),V(r,he,a=>l(4,s=a));let{data:i}=t;function o(){A.clear()}return r.$$set=a=>{"data"in a&&l(0,i=a.data)},r.$$.update=()=>{r.$$.dirty&24&&l(1,e=s.min_steam_turbines-n.length)},[i,e,o,n,s]}class nt extends Y{constructor(t){super(),Q(this,t,Ge,Fe,U,{data:0})}}export{nt as default};
