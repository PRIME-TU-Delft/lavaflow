import{S as Y,i as Q,s as F,e as U,b as d,H as j,N as me,h as _,I as S,k as E,q as y,a as P,l as L,m as M,r as w,c as H,n as N,p as D,O as q,G as k,P as R,Q as V,R as J,g as h,v as K,d as v,f as X,y as T,z,T as ee,A as I,U as te,B,L as ne,w as _e,u as Z}from"../chunks/index.525666b8.mjs";import{A as x}from"../chunks/ActionButton.b6436ad5.mjs";import{A as $e}from"../chunks/ActionMenu.61217329.mjs";import{M as de,B as be}from"../chunks/Menubar.9b380d9b.mjs";import{d as he}from"../chunks/difficultyStore.73951052.mjs";import{t as A,c as ge}from"../chunks/locationStore.c13cff09.mjs";import{B as ke,I as ve,b as ye,c as we,d as Ce}from"../chunks/Preview.svelte_svelte_type_style_lang.069820c8.mjs";import{P as Te}from"../chunks/P5PreviewCurves.afee0185.mjs";import{c as ze}from"../chunks/contourLineStore.51cd97ee.mjs";import{s as Ie}from"../chunks/sizeStore.02e4eb31.mjs";function le(r,t,l){const e=r.slice();return e[8]=t[l],e[10]=l,e}function re(r){let t,l,e,n,s,o,i,a,f,u,c;function $(){return r[5](r[8])}return{c(){t=E("p"),l=y("Delete this turbine?"),e=P(),n=E("div"),s=E("button"),o=y("Yes, delete"),i=P(),a=E("button"),f=y("Cancel"),this.h()},l(p){t=L(p,"P",{class:!0});var m=M(t);l=w(m,"Delete this turbine?"),m.forEach(_),e=H(p),n=L(p,"DIV",{class:!0});var b=M(n);s=L(b,"BUTTON",{class:!0});var C=M(s);o=w(C,"Yes, delete"),C.forEach(_),i=H(b),a=L(b,"BUTTON",{class:!0});var O=M(a);f=w(O,"Cancel"),O.forEach(_),b.forEach(_),this.h()},h(){N(t,"class","mb-1 text-sm text-slate-400"),N(s,"class","bg-red-200 p-2"),N(a,"class","bg-white p-2"),N(n,"class","flex w-full gap-2 text-slate-900")},m(p,m){d(p,t,m),k(t,l),d(p,e,m),d(p,n,m),k(n,s),k(s,o),k(n,i),k(n,a),k(a,f),u||(c=[R(s,"click",V($)),R(a,"click",V(r[3]))],u=!0)},p(p,m){r=p},d(p){p&&_(t),p&&_(e),p&&_(n),u=!1,J(c)}}}function se(r){let t,l,e=r[10]+1+"",n,s,o,i,a,f=r[8].hasConfirmOpen&&re(r);function u(){return r[6](r[8])}function c(){return r[7](r[8])}return{c(){t=E("div"),l=y("Turbine "),n=y(e),s=P(),f&&f.c(),o=P(),this.h()},l($){t=L($,"DIV",{class:!0,style:!0});var p=M(t);l=w(p,"Turbine "),n=w(p,e),s=H(p),f&&f.l(p),o=H(p),p.forEach(_),this.h()},h(){N(t,"class","turbine svelte-1j1nm92"),D(t,"--pos-x",r[8].x*r[0][0]+"px"),D(t,"--pos-y",r[8].y*r[0][1]+"px"),q(t,"top",r[8].hasConfirmOpen)},m($,p){d($,t,p),k(t,l),k(t,n),k(t,s),f&&f.m(t,null),k(t,o),i||(a=[R(t,"click",V(u)),R(t,"keydown",c)],i=!0)},p($,p){r=$,r[8].hasConfirmOpen?f?f.p(r,p):(f=re(r),f.c(),f.m(t,o)):f&&(f.d(1),f=null),p&3&&D(t,"--pos-x",r[8].x*r[0][0]+"px"),p&3&&D(t,"--pos-y",r[8].y*r[0][1]+"px"),p&2&&q(t,"top",r[8].hasConfirmOpen)},d($){$&&_(t),f&&f.d(),i=!1,J(a)}}}function Be(r){let t,l=r[1]||[],e=[];for(let n=0;n<l.length;n+=1)e[n]=se(le(r,l,n));return{c(){for(let n=0;n<e.length;n+=1)e[n].c();t=U()},l(n){for(let s=0;s<e.length;s+=1)e[s].l(n);t=U()},m(n,s){for(let o=0;o<e.length;o+=1)e[o].m(n,s);d(n,t,s)},p(n,[s]){if(s&31){l=n[1]||[];let o;for(o=0;o<l.length;o+=1){const i=le(n,l,o);e[o]?e[o].p(i,s):(e[o]=se(i),e[o].c(),e[o].m(t.parentNode,t))}for(;o<e.length;o+=1)e[o].d(1);e.length=l.length}},i:j,o:j,d(n){me(e,n),n&&_(t)}}}function Oe(r,t,l){let e;S(r,A,c=>l(1,e=c));let{sizeMult:n=[1,1]}=t;function s(c){A.remove(c.index)}function o(){A.closeAll()}function i(c){o(),A.toggleOpen(c.index)}const a=c=>s(c),f=c=>i(c),u=c=>i(c);return r.$$set=c=>{"sizeMult"in c&&l(0,n=c.sizeMult)},[n,e,s,o,i,a,f,u]}class De extends Y{constructor(t){super(),Q(this,t,Oe,Be,F,{sizeMult:0})}}function oe(r){let t=r[3]+r[4],l,e,n=ie(r);return{c(){n.c(),l=U()},l(s){n.l(s),l=U()},m(s,o){n.m(s,o),d(s,l,o),e=!0},p(s,o){o&24&&F(t,t=s[3]+s[4])?(K(),v(n,1,1,j),X(),n=ie(s),n.c(),h(n,1),n.m(l.parentNode,l)):n.p(s,o)},i(s){e||(h(n),e=!0)},o(s){v(n),e=!1},d(s){s&&_(l),n.d(s)}}}function ie(r){let t,l,e,n,s,o,i,a,f,u,c,$,p;return o=new De({props:{sizeMult:[r[3]/r[7],r[4]/r[8]]}}),f=new Te({props:{curves:r[5]?.curves}}),{c(){t=E("div"),l=E("div"),e=E("div"),n=y("Crater"),s=P(),T(o.$$.fragment),a=P(),T(f.$$.fragment),this.h()},l(m){t=L(m,"DIV",{style:!0});var b=M(t);l=L(b,"DIV",{style:!0,class:!0});var C=M(l);e=L(C,"DIV",{class:!0,style:!0});var O=M(e);n=w(O,"Crater"),O.forEach(_),s=H(C),z(o.$$.fragment,C),C.forEach(_),a=H(b),z(f.$$.fragment,b),b.forEach(_),this.h()},h(){N(e,"class","crater svelte-1jt78hw"),D(e,"--pos-y",r[6][1]*r[3]/r[7]+"px"),D(e,"--pos-x",r[6][0]*r[4]/r[8]+"px"),D(l,"aspect-ratio",r[8]+"/"+r[7]),N(l,"class","overlay svelte-1jt78hw"),ee(()=>r[13].call(l)),q(l,"tall",r[1]/r[0]>=r[8]/r[7]),D(t,"height","100%"),ee(()=>r[15].call(t))},m(m,b){d(m,t,b),k(t,l),k(l,e),k(e,n),k(l,s),I(o,l,null),r[12](l),i=te(l,r[13].bind(l)),k(t,a),I(f,t,null),u=te(t,r[15].bind(t)),c=!0,$||(p=[R(e,"click",V(r[10])),R(e,"keydown",V(r[11])),R(l,"click",r[9]),R(l,"keydown",r[14])],$=!0)},p(m,b){(!c||b&72)&&D(e,"--pos-y",m[6][1]*m[3]/m[7]+"px"),(!c||b&80)&&D(e,"--pos-x",m[6][0]*m[4]/m[8]+"px");const C={};b&24&&(C.sizeMult=[m[3]/m[7],m[4]/m[8]]),o.$set(C),(!c||b&387)&&q(l,"tall",m[1]/m[0]>=m[8]/m[7]);const O={};b&32&&(O.curves=m[5]?.curves),f.$set(O)},i(m){c||(h(o.$$.fragment,m),h(f.$$.fragment,m),c=!0)},o(m){v(o.$$.fragment,m),v(f.$$.fragment,m),c=!1},d(m){m&&_(t),B(o),r[12](null),i(),B(f),u(),$=!1,J(p)}}}function Ee(r){let t,l,e=r[5]?.curves&&oe(r);return{c(){e&&e.c(),t=U()},l(n){e&&e.l(n),t=U()},m(n,s){e&&e.m(n,s),d(n,t,s),l=!0},p(n,[s]){n[5]?.curves?e?(e.p(n,s),s&32&&h(e,1)):(e=oe(n),e.c(),h(e,1),e.m(t.parentNode,t)):e&&(K(),v(e,1,1,()=>{e=null}),X())},i(n){l||(h(e),l=!0)},o(n){v(e),l=!1},d(n){e&&e.d(n),n&&_(t)}}}function Le(r,t,l){let e,n,s,o;S(r,A,g=>l(17,e=g)),S(r,Ie,g=>l(18,n=g)),S(r,ze,g=>l(5,s=g)),S(r,ge,g=>l(6,o=g));let{height:i,width:a}=n,[f,u]=[0,0],[c,$]=[0,0],p,m;function b(g){m=p?.getBoundingClientRect();const W=(g.x-m.left)/($/a),G=(g.y-m.top)/(c/i);if(e.find(pe=>pe.hasConfirmOpen==!0)){A.closeAll();return}if(e.length>=10){console.log("cannot place more than 10 turbines");return}W<20||W>a-20||G<20||G>i-20||A.add({x:W,y:G,index:`${W.toFixed(2)}-${G.toFixed(2)}`,hasConfirmOpen:!1})}function C(g){ne.call(this,r,g)}function O(g){ne.call(this,r,g)}function ae(g){_e[g?"unshift":"push"](()=>{p=g,l(2,p)})}function ue(){c=this.clientHeight,$=this.clientWidth,l(3,c),l(4,$)}const fe=()=>console.log("key");function ce(){f=this.clientHeight,u=this.clientWidth,l(0,f),l(1,u)}return r.$$.update=()=>{r.$$.dirty&7&&f+u&&(m=p?.getBoundingClientRect())},[f,u,p,c,$,s,o,i,a,b,C,O,ae,ue,fe,ce]}class Me extends Y{constructor(t){super(),Q(this,t,Le,Ee,F,{})}}function Ae(r){let t,l,e;return t=new ve({props:{path:ye}}),{c(){T(t.$$.fragment),l=y(`
		Reset turbines`)},l(n){z(t.$$.fragment,n),l=w(n,`
		Reset turbines`)},m(n,s){I(t,n,s),d(n,l,s),e=!0},p:j,i(n){e||(h(t.$$.fragment,n),e=!0)},o(n){v(t.$$.fragment,n),e=!1},d(n){B(t,n),n&&_(l)}}}function Pe(r){let t,l;return t=new ke({props:{class:"flex items-center gap-2",outline:!0,color:"red",$$slots:{default:[Ae]},$$scope:{ctx:r}}}),t.$on("click",r[2]),{c(){T(t.$$.fragment)},l(e){z(t.$$.fragment,e)},m(e,n){I(t,e,n),l=!0},p(e,n){const s={};n&32&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){l||(h(t.$$.fragment,e),l=!0)},o(e){v(t.$$.fragment,e),l=!1},d(e){B(t,e)}}}function He(r){let t,l,e=r[0].type.toUpperCase()+"",n;return{c(){t=E("div"),l=y("Back to "),n=y(e),this.h()},l(s){t=L(s,"DIV",{slot:!0});var o=M(t);l=w(o,"Back to "),n=w(o,e),o.forEach(_),this.h()},h(){N(t,"slot","backTitle")},m(s,o){d(s,t,o),k(t,l),k(t,n)},p(s,o){o&1&&e!==(e=s[0].type.toUpperCase()+"")&&Z(n,e)},d(s){s&&_(t)}}}function Ne(r){let t;return{c(){t=y("Instructions")},l(l){t=w(l,"Instructions")},m(l,e){d(l,t,e)},d(l){l&&_(t)}}}function Re(r){let t,l;return t=new x({props:{twClass:"w-full",href:"turbine-placement/instructions",secondary:!0,icon:we,$$slots:{default:[Ne]},$$scope:{ctx:r}}}),{c(){T(t.$$.fragment)},l(e){z(t.$$.fragment,e)},m(e,n){I(t,e,n),l=!0},p(e,n){const s={};n&32&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){l||(h(t.$$.fragment,e),l=!0)},o(e){v(t.$$.fragment,e),l=!1},d(e){B(t,e)}}}function Ue(r){let t,l;return t=new x({props:{href:"/visual/"+r[0].type,icon:Ce,$$slots:{default:[Ve]},$$scope:{ctx:r}}}),{c(){T(t.$$.fragment)},l(e){z(t.$$.fragment,e)},m(e,n){I(t,e,n),l=!0},p(e,n){const s={};n&1&&(s.href="/visual/"+e[0].type),n&33&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){l||(h(t.$$.fragment,e),l=!0)},o(e){v(t.$$.fragment,e),l=!1},d(e){B(t,e)}}}function Se(r){let t,l;return t=new x({props:{disabled:!0,$$slots:{default:[We]},$$scope:{ctx:r}}}),{c(){T(t.$$.fragment)},l(e){z(t.$$.fragment,e)},m(e,n){I(t,e,n),l=!0},p(e,n){const s={};n&34&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){l||(h(t.$$.fragment,e),l=!0)},o(e){v(t.$$.fragment,e),l=!1},d(e){B(t,e)}}}function Ve(r){let t,l=r[0].type.toUpperCase()+"",e;return{c(){t=y("Go to eruption in "),e=y(l)},l(n){t=w(n,"Go to eruption in "),e=w(n,l)},m(n,s){d(n,t,s),d(n,e,s)},p(n,s){s&1&&l!==(l=n[0].type.toUpperCase()+"")&&Z(e,l)},d(n){n&&_(t),n&&_(e)}}}function We(r){let t,l,e;return{c(){t=y("Click map to place "),l=y(r[1]),e=y(" more turbines")},l(n){t=w(n,"Click map to place "),l=w(n,r[1]),e=w(n," more turbines")},m(n,s){d(n,t,s),d(n,l,s),d(n,e,s)},p(n,s){s&2&&Z(l,n[1])},d(n){n&&_(t),n&&_(l),n&&_(e)}}}function Ge(r){let t,l,e,n,s,o;t=new be({props:{$$slots:{default:[Re]},$$scope:{ctx:r}}});const i=[Se,Ue],a=[];function f(u,c){return u[1]>0?0:1}return e=f(r),n=a[e]=i[e](r),{c(){T(t.$$.fragment),l=P(),n.c(),s=U()},l(u){z(t.$$.fragment,u),l=H(u),n.l(u),s=U()},m(u,c){I(t,u,c),d(u,l,c),a[e].m(u,c),d(u,s,c),o=!0},p(u,c){const $={};c&32&&($.$$scope={dirty:c,ctx:u}),t.$set($);let p=e;e=f(u),e===p?a[e].p(u,c):(K(),v(a[p],1,1,()=>{a[p]=null}),X(),n=a[e],n?n.p(u,c):(n=a[e]=i[e](u),n.c()),h(n,1),n.m(s.parentNode,s))},i(u){o||(h(t.$$.fragment,u),h(n),o=!0)},o(u){v(t.$$.fragment,u),v(n),o=!1},d(u){B(t,u),u&&_(l),a[e].d(u),u&&_(s)}}}function je(r){let t,l,e,n,s,o;return t=new de({props:{back:"/visual/"+r[0].type,title:"Turbine placement",$$slots:{backTitle:[He],default:[Pe]},$$scope:{ctx:r}}}),e=new Me({}),s=new $e({props:{$$slots:{default:[Ge]},$$scope:{ctx:r}}}),{c(){T(t.$$.fragment),l=P(),T(e.$$.fragment),n=P(),T(s.$$.fragment)},l(i){z(t.$$.fragment,i),l=H(i),z(e.$$.fragment,i),n=H(i),z(s.$$.fragment,i)},m(i,a){I(t,i,a),d(i,l,a),I(e,i,a),d(i,n,a),I(s,i,a),o=!0},p(i,[a]){const f={};a&1&&(f.back="/visual/"+i[0].type),a&33&&(f.$$scope={dirty:a,ctx:i}),t.$set(f);const u={};a&35&&(u.$$scope={dirty:a,ctx:i}),s.$set(u)},i(i){o||(h(t.$$.fragment,i),h(e.$$.fragment,i),h(s.$$.fragment,i),o=!0)},o(i){v(t.$$.fragment,i),v(e.$$.fragment,i),v(s.$$.fragment,i),o=!1},d(i){B(t,i),i&&_(l),B(e,i),i&&_(n),B(s,i)}}}function qe(r,t,l){let e,n,s;S(r,A,a=>l(3,n=a)),S(r,he,a=>l(4,s=a));let{data:o}=t;function i(){A.clear()}return r.$$set=a=>{"data"in a&&l(0,o=a.data)},r.$$.update=()=>{r.$$.dirty&24&&l(1,e=s.min_steam_turbines-n.length)},[o,e,i,n,s]}class lt extends Y{constructor(t){super(),Q(this,t,qe,je,F,{data:0})}}export{lt as default};
