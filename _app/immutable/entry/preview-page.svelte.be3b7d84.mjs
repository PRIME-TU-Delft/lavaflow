import{S as F,i as J,s as y,y as b,a as R,z as v,c as L,A as k,b as d,d as p,f as P,g as m,B as w,h as $,I as T,o as K,k as z,q as h,l as G,m as H,r as S,n as X,G as j,H as _,e as q,v as I}from"../chunks/index.057f4a85.mjs";import{g as B}from"../chunks/navigation.2c36f9e0.mjs";import{A as N}from"../chunks/ActionButton.1b02aa5e.mjs";import{M as O,A as Q}from"../chunks/Menubar.353b8d6f.mjs";import{E as U}from"../chunks/ErrorMessage.c5382775.mjs";import{P as W}from"../chunks/P5PreviewCurves.23d5553f.mjs";import{c as Y}from"../chunks/contourLineStore.c24223e7.mjs";import{d as Z}from"../chunks/difficultyStore.b092fb2c.mjs";import{g as C}from"../chunks/gltfStore.f8a48ec6.mjs";function x(l){let t,o;return{c(){t=z("div"),o=h("Re-scan"),this.h()},l(e){t=G(e,"DIV",{slot:!0});var r=H(t);o=S(r,"Re-scan"),r.forEach($),this.h()},h(){X(t,"slot","backTitle")},m(e,r){d(e,t,r),j(t,o)},p:_,d(e){e&&$(t)}}}function D(l){let t,o;return t=new W({props:{curves:l[3]?.curves}}),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,r){k(t,e,r),o=!0},p(e,r){const s={};r&8&&(s.curves=e[3]?.curves),t.$set(s)},i(e){o||(m(t.$$.fragment,e),o=!0)},o(e){p(t.$$.fragment,e),o=!1},d(e){w(t,e)}}}function V(l){let t,o;return t=new U({props:{error:l[0].error}}),t.$on("dismiss",l[4]),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,r){k(t,e,r),o=!0},p(e,r){const s={};r&1&&(s.error=e[0].error),t.$set(s)},i(e){o||(m(t.$$.fragment,e),o=!0)},o(e){p(t.$$.fragment,e),o=!1},d(e){w(t,e)}}}function ee(l){let t;return{c(){t=h("Show in 3d model")},l(o){t=S(o,"Show in 3d model")},m(o,e){d(o,t,e)},d(o){o&&$(t)}}}function te(l){let t,o;return{c(){t=z("div"),o=h("Loading contour lines"),this.h()},l(e){t=G(e,"DIV",{slot:!0});var r=H(t);o=S(r,"Loading contour lines"),r.forEach($),this.h()},h(){X(t,"slot","loading")},m(e,r){d(e,t,r),j(t,o)},p:_,d(e){e&&$(t)}}}function re(l){let t,o;return t=new N({props:{loading:!l[1],href:"/visual/ar",$$slots:{default:[se]},$$scope:{ctx:l}}}),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,r){k(t,e,r),o=!0},p(e,r){const s={};r&2&&(s.loading=!e[1]),r&64&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){o||(m(t.$$.fragment,e),o=!0)},o(e){p(t.$$.fragment,e),o=!1},d(e){w(t,e)}}}function oe(l){let t,o;return t=new N({props:{loading:!l[1],href:"/visual/ar",$$slots:{default:[ae]},$$scope:{ctx:l}}}),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,r){k(t,e,r),o=!0},p(e,r){const s={};r&2&&(s.loading=!e[1]),r&64&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){o||(m(t.$$.fragment,e),o=!0)},o(e){p(t.$$.fragment,e),o=!1},d(e){w(t,e)}}}function ne(l){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function se(l){let t,o="(no official support)",e;return{c(){t=h("Show in AR "),e=h(o)},l(r){t=S(r,"Show in AR "),e=S(r,o)},m(r,s){d(r,t,s),d(r,e,s)},p:_,d(r){r&&$(t),r&&$(e)}}}function ae(l){let t,o="(Recommended)",e;return{c(){t=h("Show in AR "),e=h(o)},l(r){t=S(r,"Show in AR "),e=S(r,o)},m(r,s){d(r,t,s),d(r,e,s)},p:_,d(r){r&&$(t),r&&$(e)}}}function le(l){let t,o,e,r,s,c,f,n=l[0].error&&V(l);o=new N({props:{loading:!l[1],secondary:!0,href:"/visual/3d",$$slots:{loading:[te],default:[ee]},$$scope:{ctx:l}}});const i=[ne,oe,re],g=[];function A(a,u){return a[1]?a[2]?1:2:0}return r=A(l),s=g[r]=i[r](l),{c(){n&&n.c(),t=R(),b(o.$$.fragment),e=R(),s.c(),c=q()},l(a){n&&n.l(a),t=L(a),v(o.$$.fragment,a),e=L(a),s.l(a),c=q()},m(a,u){n&&n.m(a,u),d(a,t,u),k(o,a,u),d(a,e,u),g[r].m(a,u),d(a,c,u),f=!0},p(a,u){a[0].error?n?(n.p(a,u),u&1&&m(n,1)):(n=V(a),n.c(),m(n,1),n.m(t.parentNode,t)):n&&(I(),p(n,1,1,()=>{n=null}),P());const M={};u&2&&(M.loading=!a[1]),u&64&&(M.$$scope={dirty:u,ctx:a}),o.$set(M);let E=r;r=A(a),r===E?g[r].p(a,u):(I(),p(g[E],1,1,()=>{g[E]=null}),P(),s=g[r],s?s.p(a,u):(s=g[r]=i[r](a),s.c()),m(s,1),s.m(c.parentNode,c))},i(a){f||(m(n),m(o.$$.fragment,a),m(s),f=!0)},o(a){p(n),p(o.$$.fragment,a),p(s),f=!1},d(a){n&&n.d(a),a&&$(t),w(o,a),a&&$(e),g[r].d(a),a&&$(c)}}}function ie(l){let t,o,e=l[3],r,s,c;t=new O({props:{back:"/capture",title:"preview",$$slots:{backTitle:[x]},$$scope:{ctx:l}}});let f=D(l);return s=new Q({props:{$$slots:{default:[le]},$$scope:{ctx:l}}}),{c(){b(t.$$.fragment),o=R(),f.c(),r=R(),b(s.$$.fragment)},l(n){v(t.$$.fragment,n),o=L(n),f.l(n),r=L(n),v(s.$$.fragment,n)},m(n,i){k(t,n,i),d(n,o,i),f.m(n,i),d(n,r,i),k(s,n,i),c=!0},p(n,[i]){const g={};i&64&&(g.$$scope={dirty:i,ctx:n}),t.$set(g),i&8&&y(e,e=n[3])?(I(),p(f,1,1,_),P(),f=D(n),f.c(),m(f,1),f.m(r.parentNode,r)):f.p(n,i);const A={};i&71&&(A.$$scope={dirty:i,ctx:n}),s.$set(A)},i(n){c||(m(t.$$.fragment,n),m(f),m(s.$$.fragment,n),c=!0)},o(n){p(t.$$.fragment,n),p(f),p(s.$$.fragment,n),c=!1},d(n){w(t,n),n&&$(o),f.d(n),n&&$(r),w(s,n)}}}function fe(l,t,o){let e,r;T(l,Y,i=>o(3,e=i)),T(l,Z,i=>o(5,r=i));let{data:s}=t,c=!1,f=!1;K(async()=>{if(!e.curves||!e.hierarchy)return B("/capture");console.log(e.curves),await C.setup(e,r.lava_forking),C.build(e),o(2,f=await navigator?.xr?.isSessionSupported("immersive-ar")??!1),o(1,c=!0)});const n=()=>B("/preview");return l.$$set=i=>{"data"in i&&o(0,s=i.data)},[s,c,f,e,n]}class ve extends F{constructor(t){super(),J(this,t,fe,ie,y,{data:0})}}export{ve as default};
