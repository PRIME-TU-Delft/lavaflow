import{S as K,i as Q,s as U,k as S,y as h,a as N,l as P,m as M,z as y,h as c,c as I,n as R,b as m,A as V,H as X,v as Y,d,f as Z,g as k,B as A,G as D,q as w,r as E,e as G,I as ee,u as te,w as x,N as ne,_ as q,p as j,O as se,o as le}from"../chunks/index.814eb393.js";import{B as L,I as ae,h as re,i as oe}from"../chunks/Button.a451a3d0.js";import{t as ie,a as J}from"../chunks/contourLineStore.53cb49e1.js";import{g as H}from"../chunks/gltfStore.390f1a7b.js";import{g as O}from"../chunks/navigation.ced90703.js";import{A as ue,h as fe,a as ce}from"../chunks/aframe-master.568a71a8.js";import{d as _e}from"../chunks/debugStore.95233f8f.js";import{d as me}from"../chunks/difficultyStore.77cd2ff2.js";function $e(i){let e;return{c(){e=w("Back to preview")},l(t){e=E(t,"Back to preview")},m(t,n){m(t,e,n)},d(t){t&&c(e)}}}function pe(i){let e;return{c(){e=w("Place targets")},l(t){e=E(t,"Place targets")},m(t,n){m(t,e,n)},d(t){t&&c(e)}}}function be(i){let e,t;return e=new L({props:{disabled:!0,secondary:!0,$$slots:{default:[ve]},$$scope:{ctx:i}}}),{c(){h(e.$$.fragment)},l(n){y(e.$$.fragment,n)},m(n,a){V(e,n,a),t=!0},p(n,a){const l={};a&512&&(l.$$scope={dirty:a,ctx:n}),e.$set(l)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){d(e.$$.fragment,n),t=!1},d(n){A(e,n)}}}function ge(i){let e,t,n,a;const l=[ke,de],s=[];function o(f,$){return f[0]?0:1}return e=o(i),t=s[e]=l[e](i),{c(){t.c(),n=G()},l(f){t.l(f),n=G()},m(f,$){s[e].m(f,$),m(f,n,$),a=!0},p(f,$){let g=e;e=o(f),e===g?s[e].p(f,$):(Y(),d(s[g],1,1,()=>{s[g]=null}),Z(),t=s[e],t?t.p(f,$):(t=s[e]=l[e](f),t.c()),k(t,1),t.m(n.parentNode,n))},i(f){a||(k(t),a=!0)},o(f){d(t),a=!1},d(f){s[e].d(f),f&&c(n)}}}function ve(i){let e;return{c(){e=w("Place targets to begin")},l(t){e=E(t,"Place targets to begin")},m(t,n){m(t,e,n)},d(t){t&&c(e)}}}function de(i){let e,t;return e=new L({props:{$$slots:{default:[we]},$$scope:{ctx:i}}}),e.$on("click",i[5]),{c(){h(e.$$.fragment)},l(n){y(e.$$.fragment,n)},m(n,a){V(e,n,a),t=!0},p(n,a){const l={};a&512&&(l.$$scope={dirty:a,ctx:n}),e.$set(l)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){d(e.$$.fragment,n),t=!1},d(n){A(e,n)}}}function ke(i){let e,t,n,a;return e=new L({props:{secondary:!0,$$slots:{default:[Ee]},$$scope:{ctx:i}}}),e.$on("click",i[7]),n=new L({props:{green:!0,$$slots:{default:[he]},$$scope:{ctx:i}}}),{c(){h(e.$$.fragment),t=N(),h(n.$$.fragment)},l(l){y(e.$$.fragment,l),t=I(l),y(n.$$.fragment,l)},m(l,s){V(e,l,s),m(l,t,s),V(n,l,s),a=!0},p(l,s){const o={};s&512&&(o.$$scope={dirty:s,ctx:l}),e.$set(o);const f={};s&514&&(f.$$scope={dirty:s,ctx:l}),n.$set(f)},i(l){a||(k(e.$$.fragment,l),k(n.$$.fragment,l),a=!0)},o(l){d(e.$$.fragment,l),d(n.$$.fragment,l),a=!1},d(l){A(e,l),l&&c(t),A(n,l)}}}function we(i){let e,t,n,a,l;return a=new ae({props:{path:re}}),{c(){e=S("span"),t=w("Reveal lava"),n=N(),h(a.$$.fragment)},l(s){e=P(s,"SPAN",{});var o=M(e);t=E(o,"Reveal lava"),o.forEach(c),n=I(s),y(a.$$.fragment,s)},m(s,o){m(s,e,o),X(e,t),m(s,n,o),V(a,s,o),l=!0},p:ee,i(s){l||(k(a.$$.fragment,s),l=!0)},o(s){d(a.$$.fragment,s),l=!1},d(s){s&&c(e),s&&c(n),A(a,s)}}}function Ee(i){let e;return{c(){e=w("Hide lava")},l(t){e=E(t,"Hide lava")},m(t,n){m(t,e,n)},d(t){t&&c(e)}}}function he(i){let e,t,n,a,l;return{c(){e=w("Energy: "),t=w(i[1]),n=w(" / "),a=w(T),l=w(" MW")},l(s){e=E(s,"Energy: "),t=E(s,i[1]),n=E(s," / "),a=E(s,T),l=E(s," MW")},m(s,o){m(s,e,o),m(s,t,o),m(s,n,o),m(s,a,o),m(s,l,o)},p(s,o){o&2&&te(t,s[1])},d(s){s&&c(e),s&&c(t),s&&c(n),s&&c(a),s&&c(l)}}}function ye(i){let e,t,n,a,l,s,o,f,$;t=new L({props:{$$slots:{default:[$e]},$$scope:{ctx:i}}}),t.$on("click",i[4]),l=new L({props:{$$slots:{default:[pe]},$$scope:{ctx:i}}}),l.$on("click",i[3]);const g=[ge,be],v=[];function _(r,p){return r[2].length>0?0:1}return o=_(i),f=v[o]=g[o](i),{c(){e=S("div"),h(t.$$.fragment),n=N(),a=S("div"),h(l.$$.fragment),s=N(),f.c(),this.h()},l(r){e=P(r,"DIV",{class:!0});var p=M(e);y(t.$$.fragment,p),p.forEach(c),n=I(r),a=P(r,"DIV",{class:!0});var B=M(a);y(l.$$.fragment,B),s=I(B),f.l(B),B.forEach(c),this.h()},h(){R(e,"class","backButton"),R(a,"class","button rightButton svelte-x4wr97")},m(r,p){m(r,e,p),V(t,e,null),m(r,n,p),m(r,a,p),V(l,a,null),X(a,s),v[o].m(a,null),$=!0},p(r,[p]){const B={};p&512&&(B.$$scope={dirty:p,ctx:r}),t.$set(B);const z={};p&512&&(z.$$scope={dirty:p,ctx:r}),l.$set(z);let u=o;o=_(r),o===u?v[o].p(r,p):(Y(),d(v[u],1,1,()=>{v[u]=null}),Z(),f=v[o],f?f.p(r,p):(f=v[o]=g[o](r),f.c()),k(f,1),f.m(a,null))},i(r){$||(k(t.$$.fragment,r),k(l.$$.fragment,r),k(f),$=!0)},o(r){d(t.$$.fragment,r),d(l.$$.fragment,r),d(f),$=!1},d(r){r&&c(e),A(t),r&&c(n),r&&c(a),A(l),v[o].d()}}}const T=1e3;function Ve(i,e,t){let n;D(i,ie,_=>t(2,n=_));let{sceneEl:a}=e,{lavaVisible:l=!1}=e,{points:s=0}=e;async function o(){await a.exitVR()}async function f(){await o(),O("/targetplacement/ar")}async function $(){await o(),O("/scan/preview")}function g(){t(1,s=H.computePlayerPoints(T)),t(0,l=!0)}const v=()=>t(0,l=!1);return i.$$set=_=>{"sceneEl"in _&&t(6,a=_.sceneEl),"lavaVisible"in _&&t(0,l=_.lavaVisible),"points"in _&&t(1,s=_.points)},[l,s,n,f,$,g,a,v]}class Ae extends K{constructor(e){super(),Q(this,e,Ve,ye,U,{sceneEl:6,lavaVisible:0,points:1})}}function Be(i){let e;return{c(){e=w("Native AR Mode")},l(t){e=E(t,"Native AR Mode")},m(t,n){m(t,e,n)},d(t){t&&c(e)}}}function Re(i){let e,t,n,a,l,s,o,f,$,g,v,_,r,p;t=new ue({props:{scale:i[2],rotation:Se,lava_revealed:i[1]}});function B(u){i[4](u)}let z={sceneEl:i[0]};return i[1]!==void 0&&(z.lavaVisible=i[1]),o=new Ae({props:z}),x.push(()=>ne(o,"lavaVisible",B)),r=new L({props:{icon:oe,$$slots:{default:[Be]},$$scope:{ctx:i}}}),{c(){e=S("a-scene"),h(t.$$.fragment),n=N(),a=S("a-camera"),l=N(),s=S("div"),h(o.$$.fragment),$=N(),g=S("a"),v=N(),_=S("a"),h(r.$$.fragment),this.h()},l(u){e=P(u,"A-SCENE",{"vr-mode-ui":!0,webxr:!0});var b=M(e);y(t.$$.fragment,b),n=I(b),a=P(b,"A-CAMERA",{position:!0}),M(a).forEach(c),b.forEach(c),l=I(u),s=P(u,"DIV",{id:!0,class:!0});var C=M(s);y(o.$$.fragment,C),C.forEach(c),$=I(u),g=P(u,"A",{id:!0,style:!0}),M(g).forEach(c),v=I(u),_=P(u,"A",{id:!0,href:!0,style:!0,class:!0});var W=M(_);y(r.$$.fragment,W),W.forEach(c),this.h()},h(){q(a,"position","0 3 3"),q(e,"vr-mode-ui","enterVRButton: #myEnterVRButton; enterARButton: #myEnterARButton"),q(e,"webxr","optionalFeatures: dom-overlay; overlayElement: #overlay;"),R(s,"id","overlay"),R(s,"class","svelte-o8ubtv"),R(g,"id","myEnterVRButton"),j(g,"display","none"),R(_,"id","myEnterARButton"),R(_,"href",""),j(_,"z-index","200000"),R(_,"class","svelte-o8ubtv")},m(u,b){m(u,e,b),V(t,e,null),X(e,n),X(e,a),i[3](e),m(u,l,b),m(u,s,b),V(o,s,null),m(u,$,b),m(u,g,b),m(u,v,b),m(u,_,b),V(r,_,null),p=!0},p(u,[b]){const C={};b&4&&(C.scale=u[2]),b&2&&(C.lava_revealed=u[1]),t.$set(C);const W={};b&1&&(W.sceneEl=u[0]),!f&&b&2&&(f=!0,W.lavaVisible=u[1],se(()=>f=!1)),o.$set(W);const F={};b&1024&&(F.$$scope={dirty:b,ctx:u}),r.$set(F)},i(u){p||(k(t.$$.fragment,u),k(o.$$.fragment,u),k(r.$$.fragment,u),p=!0)},o(u){d(t.$$.fragment,u),d(o.$$.fragment,u),d(r.$$.fragment,u),p=!1},d(u){u&&c(e),A(t),i[3](null),u&&c(l),u&&c(s),A(o),u&&c($),u&&c(g),u&&c(v),u&&c(_),A(r)}}}let Se=0;function Pe(i,e,t){let n,a,l,s,o;D(i,J,r=>t(5,a=r)),D(i,me,r=>t(6,l=r)),D(i,_e,r=>t(7,s=r)),D(i,H,r=>t(8,o=r));let f,$=!1,g=[.05,.025,.05];le(async()=>{if(!o){if(!s&&!a){O("/scan/mapscanning");return}a||(console.warn("SCENE VIEWER: gltf is loaded from hardcoded data"),J.setup({curves:fe,hierarchy:ce,size:{width:800,height:960}})),await H.setup(a,l.lava_forking),H.build(a)}});function v(r){x[r?"unshift":"push"](()=>{f=r,t(0,f)})}function _(r){$=r,t(1,$)}return t(2,n=g.map(r=>r)),[f,$,n,v,_]}class He extends K{constructor(e){super(),Q(this,e,Pe,Re,U,{})}}export{He as default};
