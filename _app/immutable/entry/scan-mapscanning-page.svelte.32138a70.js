import{S as ie,i as ce,s as ue,k as g,q as $,a as k,l as p,m as b,r as I,h as v,c as D,n as _,b as C,H as c,I as x,C as at,D as lt,E as it,F as ct,g as E,d as V,o as dt,P as vt,e as et,v as qe,f as He,w as ee,Q as le,N as Oe,y as T,z as B,p as tt,A as P,O as Fe,B as N,u as mt}from"../chunks/index.814eb393.js";import{B as ut,a as _t,b as ht}from"../chunks/Button.a451a3d0.js";import{N as gt}from"../chunks/NavigationButton.3cbf88d0.js";import{D as pt}from"../chunks/Dropdown.18d9680d.js";import{P as bt}from"../chunks/Page.50b125a6.js";import{M as wt}from"../chunks/Modal.1d6ee958.js";import{g as $t}from"../chunks/navigation.c8ab2ecc.js";import{r as It}from"../chunks/imageStore.1d927c92.js";function kt(n){let e,s,t,r,a,o,u,f,m,l,d,i,h,S,q,y,H,fe,de,O,A,ve,me,G,_e,he,F,j,ge,pe,z,be,we,Q,$e,Ie,L,R,ke,De,W,Ee,Ve,M,J,ye,Ce,K,Se,Te,U,X,Be,Pe,Y,Ne;return{c(){e=g("div"),s=g("h2"),t=$("Good example of contour map"),r=k(),a=g("div"),o=k(),u=g("h2"),f=$("Instructions"),m=k(),l=g("div"),d=$("Drawing"),i=k(),h=g("div"),S=g("div"),q=$("Curves should have sufficient margin"),y=k(),H=g("div"),fe=$(`The curves should have sufficient margin between them, overlapping or close lines are hard to
			interpret`),de=k(),O=g("div"),A=g("div"),ve=$("Drawing with dark pen"),me=k(),G=g("div"),_e=$(`To recognise your level curves, we prefer a dark and thick marker. Using a lighter pen will
			likely not work`),he=k(),F=g("div"),j=g("div"),ge=$("Close your curves"),pe=k(),z=g("div"),be=$("To avoid false readings, close your curves, dont leave any open-ended lines"),we=k(),Q=g("div"),$e=$("Scanning"),Ie=k(),L=g("div"),R=g("div"),ke=$("Four corners visible"),De=k(),W=g("div"),Ee=$("To scan the level curves, we need to have the four corners visible"),Ve=k(),M=g("div"),J=g("div"),ye=$("Drawing should not be too far"),Ce=k(),K=g("div"),Se=$(`Scanning works best from a distance of 0.5 meters from the piece of paper. For best the best
			result try to scan the paper as close to parallel as possible. This is easiest if you put your
			drawing on a table instead of holding it.`),Te=k(),U=g("div"),X=g("div"),Be=$("Proper lighting"),Pe=k(),Y=g("div"),Ne=$(`Level curves are hard to distinguish from the background in a low light setting. Try to use
			natural daylight or a propper ceiling light for the best results. Be careful of sharp or dark
			shadows on the drawing, as they might get interpreted as part of your drawing.`),this.h()},l(Z){e=p(Z,"DIV",{class:!0});var w=b(e);s=p(w,"H2",{});var Le=b(s);t=I(Le,"Good example of contour map"),Le.forEach(v),r=D(w),a=p(w,"DIV",{class:!0}),b(a).forEach(v),o=D(w),u=p(w,"H2",{});var Me=b(u);f=I(Me,"Instructions"),Me.forEach(v),m=D(w),l=p(w,"DIV",{class:!0});var Ue=b(l);d=I(Ue,"Drawing"),Ue.forEach(v),i=D(w),h=p(w,"DIV",{class:!0});var te=b(h);S=p(te,"DIV",{class:!0});var Ae=b(S);q=I(Ae,"Curves should have sufficient margin"),Ae.forEach(v),y=D(te),H=p(te,"DIV",{class:!0});var Ge=b(H);fe=I(Ge,`The curves should have sufficient margin between them, overlapping or close lines are hard to
			interpret`),Ge.forEach(v),te.forEach(v),de=D(w),O=p(w,"DIV",{class:!0});var se=b(O);A=p(se,"DIV",{class:!0});var je=b(A);ve=I(je,"Drawing with dark pen"),je.forEach(v),me=D(se),G=p(se,"DIV",{class:!0});var ze=b(G);_e=I(ze,`To recognise your level curves, we prefer a dark and thick marker. Using a lighter pen will
			likely not work`),ze.forEach(v),se.forEach(v),he=D(w),F=p(w,"DIV",{class:!0});var re=b(F);j=p(re,"DIV",{class:!0});var Qe=b(j);ge=I(Qe,"Close your curves"),Qe.forEach(v),pe=D(re),z=p(re,"DIV",{class:!0});var Re=b(z);be=I(Re,"To avoid false readings, close your curves, dont leave any open-ended lines"),Re.forEach(v),re.forEach(v),we=D(w),Q=p(w,"DIV",{class:!0});var We=b(Q);$e=I(We,"Scanning"),We.forEach(v),Ie=D(w),L=p(w,"DIV",{class:!0});var oe=b(L);R=p(oe,"DIV",{class:!0});var Je=b(R);ke=I(Je,"Four corners visible"),Je.forEach(v),De=D(oe),W=p(oe,"DIV",{class:!0});var Ke=b(W);Ee=I(Ke,"To scan the level curves, we need to have the four corners visible"),Ke.forEach(v),oe.forEach(v),Ve=D(w),M=p(w,"DIV",{class:!0});var ne=b(M);J=p(ne,"DIV",{class:!0});var Xe=b(J);ye=I(Xe,"Drawing should not be too far"),Xe.forEach(v),Ce=D(ne),K=p(ne,"DIV",{class:!0});var Ye=b(K);Se=I(Ye,`Scanning works best from a distance of 0.5 meters from the piece of paper. For best the best
			result try to scan the paper as close to parallel as possible. This is easiest if you put your
			drawing on a table instead of holding it.`),Ye.forEach(v),ne.forEach(v),Te=D(w),U=p(w,"DIV",{class:!0});var ae=b(U);X=p(ae,"DIV",{class:!0});var Ze=b(X);Be=I(Ze,"Proper lighting"),Ze.forEach(v),Pe=D(ae),Y=p(ae,"DIV",{class:!0});var xe=b(Y);Ne=I(xe,`Level curves are hard to distinguish from the background in a low light setting. Try to use
			natural daylight or a propper ceiling light for the best results. Be careful of sharp or dark
			shadows on the drawing, as they might get interpreted as part of your drawing.`),xe.forEach(v),ae.forEach(v),w.forEach(v),this.h()},h(){_(a,"class","example svelte-xewtbd"),_(l,"class","section svelte-xewtbd"),_(S,"class","title svelte-xewtbd"),_(H,"class","description"),_(h,"class","instruction svelte-xewtbd"),_(A,"class","title svelte-xewtbd"),_(G,"class","description"),_(O,"class","instruction svelte-xewtbd"),_(j,"class","title svelte-xewtbd"),_(z,"class","description"),_(F,"class","instruction svelte-xewtbd"),_(Q,"class","section svelte-xewtbd"),_(R,"class","title svelte-xewtbd"),_(W,"class","description"),_(L,"class","instruction svelte-xewtbd"),_(J,"class","title svelte-xewtbd"),_(K,"class","description"),_(M,"class","instruction svelte-xewtbd"),_(X,"class","title svelte-xewtbd"),_(Y,"class","description"),_(U,"class","instruction svelte-xewtbd"),_(e,"class","instructions svelte-xewtbd")},m(Z,w){C(Z,e,w),c(e,s),c(s,t),c(e,r),c(e,a),c(e,o),c(e,u),c(u,f),c(e,m),c(e,l),c(l,d),c(e,i),c(e,h),c(h,S),c(S,q),c(h,y),c(h,H),c(H,fe),c(e,de),c(e,O),c(O,A),c(A,ve),c(O,me),c(O,G),c(G,_e),c(e,he),c(e,F),c(F,j),c(j,ge),c(F,pe),c(F,z),c(z,be),c(e,we),c(e,Q),c(Q,$e),c(e,Ie),c(e,L),c(L,R),c(R,ke),c(L,De),c(L,W),c(W,Ee),c(e,Ve),c(e,M),c(M,J),c(J,ye),c(M,Ce),c(M,K),c(K,Se),c(e,Te),c(e,U),c(U,X),c(X,Be),c(U,Pe),c(U,Y),c(Y,Ne)},p:x,i:x,o:x,d(Z){Z&&v(e)}}}class Dt extends ie{constructor(e){super(),ce(this,e,null,kt,ue,{})}}const Et=n=>({loading:n&2,stream:n&1,error:n&4,cameraOptions:n&8}),st=n=>({loading:n[1],stream:n[0],error:n[2],cameraOptions:n[3]});function Vt(n){let e;const s=n[6].default,t=at(s,n,n[5],st);return{c(){t&&t.c()},l(r){t&&t.l(r)},m(r,a){t&&t.m(r,a),e=!0},p(r,[a]){t&&t.p&&(!e||a&47)&&lt(t,s,r,r[5],e?ct(s,r[5],a,Et):it(r[5]),st)},i(r){e||(E(t,r),e=!0)},o(r){V(t,r),e=!1},d(r){t&&t.d(r)}}}function yt(n,e,s){let{$$slots:t={},$$scope:r}=e,{deviceId:a=""}=e,o,u=!0,f,m=[];const l=async()=>{s(1,u=!0),o&&o.getTracks().forEach(i=>i.stop());const d=a?{deviceId:{exact:a}}:{facingMode:"environment"};try{s(0,o=await navigator.mediaDevices.getUserMedia({video:d})),s(1,u=!1),s(2,f="")}catch(i){s(2,f=""+i)}};return dt(async()=>{await l();const d=await navigator.mediaDevices.enumerateDevices();s(3,m=d.filter(i=>i.kind=="videoinput"))}),vt(()=>{o&&o.getTracks().forEach(d=>d.stop())}),n.$$set=d=>{"deviceId"in d&&s(4,a=d.deviceId),"$$scope"in d&&s(5,r=d.$$scope)},n.$$.update=()=>{n.$$.dirty&16&&a&&l()},[o,u,f,m,a,r,t]}class Ct extends ie{constructor(e){super(),ce(this,e,yt,Vt,ue,{deviceId:4})}}function St(n){let e;return{c(){e=g("video"),this.h()},l(s){e=p(s,"VIDEO",{style:!0,preload:!0,type:!0,class:!0}),b(e).forEach(v),this.h()},h(){_(e,"style",n[1]),e.loop=!0,e.playsInline=!0,e.autoplay=!1,e.controls=!1,_(e,"preload","auto"),_(e,"type","video/mp4"),_(e,"class","svelte-1q7mol1"),le(e,"roundCorner",n[4])},m(s,t){C(s,e,t),n[8](e)},p(s,t){t&2&&_(e,"style",s[1]),t&16&&le(e,"roundCorner",s[4])},i:x,o:x,d(s){s&&v(e),n[8](null)}}}function Tt(n){let e,s,t,r,a,o=n[3]&&n[3].includes("Permission denied"),u,f,m=o&&rt();const l=n[7].default,d=at(l,n,n[6],null);return{c(){e=g("div"),s=g("div"),t=g("h2"),r=$("Loading video..."),a=k(),m&&m.c(),u=k(),d&&d.c(),this.h()},l(i){e=p(i,"DIV",{class:!0});var h=b(e);s=p(h,"DIV",{class:!0});var S=b(s);t=p(S,"H2",{class:!0});var q=b(t);r=I(q,"Loading video..."),q.forEach(v),a=D(S),m&&m.l(S),S.forEach(v),h.forEach(v),u=D(i),d&&d.l(i),this.h()},h(){_(t,"class","svelte-1q7mol1"),_(s,"class","svelte-1q7mol1"),_(e,"class","loadingVideo svelte-1q7mol1"),le(e,"roundCorner",n[4])},m(i,h){C(i,e,h),c(e,s),c(s,t),c(t,r),c(s,a),m&&m.m(s,null),C(i,u,h),d&&d.m(i,h),f=!0},p(i,h){h&8&&(o=i[3]&&i[3].includes("Permission denied")),o?m||(m=rt(),m.c(),m.m(s,null)):m&&(m.d(1),m=null),(!f||h&16)&&le(e,"roundCorner",i[4]),d&&d.p&&(!f||h&64)&&lt(d,l,i,i[6],f?ct(l,i[6],h,null):it(i[6]),null)},i(i){f||(E(d,i),f=!0)},o(i){V(d,i),f=!1},d(i){i&&v(e),m&&m.d(),i&&v(u),d&&d.d(i)}}}function rt(n){let e;return{c(){e=$("The browser is unable to access the camera, try re-enabling the camera and reload")},l(s){e=I(s,"The browser is unable to access the camera, try re-enabling the camera and reload")},m(s,t){C(s,e,t)},d(s){s&&v(e)}}}function Bt(n){let e,s,t,r;const a=[Tt,St],o=[];function u(f,m){return f[2]?0:1}return e=u(n),s=o[e]=a[e](n),{c(){s.c(),t=et()},l(f){s.l(f),t=et()},m(f,m){o[e].m(f,m),C(f,t,m),r=!0},p(f,[m]){let l=e;e=u(f),e===l?o[e].p(f,m):(qe(),V(o[l],1,1,()=>{o[l]=null}),He(),s=o[e],s?s.p(f,m):(s=o[e]=a[e](f),s.c()),E(s,1),s.m(t.parentNode,t))},i(f){r||(E(s),r=!0)},o(f){V(s),r=!1},d(f){o[e].d(f),f&&v(t)}}}function Pt(n,e,s){let{$$slots:t={},$$scope:r}=e,{stream:a}=e,{style:o=""}=e,{loading:u=!0}=e,{error:f=""}=e,{roundCorner:m=!1}=e,{videoSource:l=void 0}=e;function d(i){ee[i?"unshift":"push"](()=>{l=i,s(0,l),s(5,a),s(2,u)})}return n.$$set=i=>{"stream"in i&&s(5,a=i.stream),"style"in i&&s(1,o=i.style),"loading"in i&&s(2,u=i.loading),"error"in i&&s(3,f=i.error),"roundCorner"in i&&s(4,m=i.roundCorner),"videoSource"in i&&s(0,l=i.videoSource),"$$scope"in i&&s(6,r=i.$$scope)},n.$$.update=()=>{n.$$.dirty&37&&a&&!u&&l&&l.paused&&(s(0,l.srcObject=a,l),l.play())},[l,o,u,f,m,a,r,t,d]}class ft extends ie{constructor(e){super(),ce(this,e,Pt,Bt,ue,{stream:5,style:1,loading:2,error:3,roundCorner:4,videoSource:0})}}function Nt(n){let e,s;return e=new Dt({}),{c(){T(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){P(e,t,r),s=!0},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){V(e.$$.fragment,t),s=!1},d(t){N(e,t)}}}function qt(n){let e,s,t;function r(o){n[11](o)}let a={roundCorner:!0,error:n[15],loading:n[13],stream:n[14]};return n[1]!==void 0&&(a.videoSource=n[1]),e=new ft({props:a}),ee.push(()=>Oe(e,"videoSource",r)),{c(){T(e.$$.fragment)},l(o){B(e.$$.fragment,o)},m(o,u){P(e,o,u),t=!0},p(o,u){const f={};u&32768&&(f.error=o[15]),u&8192&&(f.loading=o[13]),u&16384&&(f.stream=o[14]),!s&&u&2&&(s=!0,f.videoSource=o[1],Fe(()=>s=!1)),e.$set(f)},i(o){t||(E(e.$$.fragment,o),t=!0)},o(o){V(e.$$.fragment,o),t=!1},d(o){N(e,o)}}}function Ht(n){let e;return{c(){e=$("Back home")},l(s){e=I(s,"Back home")},m(s,t){C(s,e,t)},d(s){s&&v(e)}}}function Ot(n){let e,s;return e=new gt({props:{slot:"headerButton",back:!0,to:"/",$$slots:{default:[Ht]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){P(e,t,r),s=!0},p(t,r){const a={};r&524288&&(a.$$scope={dirty:r,ctx:t}),e.$set(a)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){V(e.$$.fragment,t),s=!1},d(t){N(e,t)}}}function Ft(n){let e,s;return e=new ft({props:{loading:n[13],stream:n[14]}}),{c(){T(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){P(e,t,r),s=!0},p(t,r){const a={};r&8192&&(a.loading=t[13]),r&16384&&(a.stream=t[14]),e.$set(a)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){V(e.$$.fragment,t),s=!1},d(t){N(e,t)}}}function ot(n){let e,s,t;function r(o){n[10](o)}let a={options:n[16],$$slots:{default:[Lt,({option:o,index:u})=>({17:o,18:u}),({option:o,index:u})=>(o?131072:0)|(u?262144:0)]},$$scope:{ctx:n}};return n[2]!==void 0&&(a.value=n[2]),e=new pt({props:a}),ee.push(()=>Oe(e,"value",r)),e.$on("change",n[8]),{c(){T(e.$$.fragment)},l(o){B(e.$$.fragment,o)},m(o,u){P(e,o,u),t=!0},p(o,u){const f={};u&65536&&(f.options=o[16]),u&917504&&(f.$$scope={dirty:u,ctx:o}),!s&&u&4&&(s=!0,f.value=o[2],Fe(()=>s=!1)),e.$set(f)},i(o){t||(E(e.$$.fragment,o),t=!0)},o(o){V(e.$$.fragment,o),t=!1},d(o){N(e,o)}}}function Lt(n){let e=(n[17].label||"Camera "+(n[18]+1))+"",s;return{c(){s=$(e)},l(t){s=I(t,e)},m(t,r){C(t,s,r)},p(t,r){r&393216&&e!==(e=(t[17].label||"Camera "+(t[18]+1))+"")&&mt(s,e)},d(t){t&&v(s)}}}function Mt(n){let e,s,t=!n[0]&&n[16]?.length>1&&ot(n);return{c(){e=g("div"),t&&t.c(),this.h()},l(r){e=p(r,"DIV",{slot:!0});var a=b(e);t&&t.l(a),a.forEach(v),this.h()},h(){_(e,"slot","options")},m(r,a){C(r,e,a),t&&t.m(e,null),s=!0},p(r,a){!r[0]&&r[16]?.length>1?t?(t.p(r,a),a&65537&&E(t,1)):(t=ot(r),t.c(),E(t,1),t.m(e,null)):t&&(qe(),V(t,1,1,()=>{t=null}),He())},i(r){s||(E(t),s=!0)},o(r){V(t),s=!1},d(r){r&&v(e),t&&t.d()}}}function nt(n){let e,s;return e=new ut({props:{secondary:!0,icon:ht,$$slots:{default:[Ut]},$$scope:{ctx:n}}}),e.$on("click",n[6]),{c(){T(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){P(e,t,r),s=!0},p(t,r){const a={};r&524288&&(a.$$scope={dirty:r,ctx:t}),e.$set(a)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){V(e.$$.fragment,t),s=!1},d(t){N(e,t)}}}function Ut(n){let e;return{c(){e=$("Image capture | Instructions")},l(s){e=I(s,"Image capture | Instructions")},m(s,t){C(s,e,t)},d(s){s&&v(e)}}}function At(n){let e;return{c(){e=$("Capture photo of map")},l(s){e=I(s,"Capture photo of map")},m(s,t){C(s,e,t)},d(s){s&&v(e)}}}function Gt(n){let e,s,t,r=!n[0]&&nt(n);return s=new ut({props:{loading:n[4],icon:_t,$$slots:{default:[At]},$$scope:{ctx:n}}}),s.$on("click",n[7]),{c(){r&&r.c(),e=k(),T(s.$$.fragment)},l(a){r&&r.l(a),e=D(a),B(s.$$.fragment,a)},m(a,o){r&&r.m(a,o),C(a,e,o),P(s,a,o),t=!0},p(a,o){a[0]?r&&(qe(),V(r,1,1,()=>{r=null}),He()):r?(r.p(a,o),o&1&&E(r,1)):(r=nt(a),r.c(),E(r,1),r.m(e.parentNode,e));const u={};o&16&&(u.loading=a[4]),o&524288&&(u.$$scope={dirty:o,ctx:a}),s.$set(u)},i(a){t||(E(r),E(s.$$.fragment,a),t=!0)},o(a){V(r),V(s.$$.fragment,a),t=!1},d(a){r&&r.d(a),a&&v(e),N(s,a)}}}function jt(n){let e,s;return e=new bt({props:{fullscreen:!n[13],$$slots:{footer:[Gt],options:[Mt],background:[Ft],headerButton:[Ot],default:[qt]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){P(e,t,r),s=!0},p(t,r){const a={};r&8192&&(a.fullscreen=!t[13]),r&647191&&(a.$$scope={dirty:r,ctx:t}),e.$set(a)},i(t){s||(E(e.$$.fragment,t),s=!0)},o(t){V(e.$$.fragment,t),s=!1},d(t){N(e,t)}}}function zt(n){let e,s,t,r,a,o,u;function f(l){n[9](l)}let m={title:"scan instructions",$$slots:{default:[Nt]},$$scope:{ctx:n}};return n[0]!==void 0&&(m.visible=n[0]),e=new wt({props:m}),ee.push(()=>Oe(e,"visible",f)),r=new Ct({props:{deviceId:n[5],$$slots:{default:[jt,({loading:l,stream:d,error:i,cameraOptions:h})=>({13:l,14:d,15:i,16:h}),({loading:l,stream:d,error:i,cameraOptions:h})=>(l?8192:0)|(d?16384:0)|(i?32768:0)|(h?65536:0)]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment),t=k(),T(r.$$.fragment),a=k(),o=g("canvas"),this.h()},l(l){B(e.$$.fragment,l),t=D(l),B(r.$$.fragment,l),a=D(l),o=p(l,"CANVAS",{id:!0,style:!0}),b(o).forEach(v),this.h()},h(){_(o,"id","captureCanvas"),tt(o,"display","none"),tt(o,"position","absolute")},m(l,d){P(e,l,d),C(l,t,d),P(r,l,d),C(l,a,d),C(l,o,d),n[12](o),u=!0},p(l,[d]){const i={};d&524288&&(i.$$scope={dirty:d,ctx:l}),!s&&d&1&&(s=!0,i.visible=l[0],Fe(()=>s=!1)),e.$set(i);const h={};d&32&&(h.deviceId=l[5]),d&647191&&(h.$$scope={dirty:d,ctx:l}),r.$set(h)},i(l){u||(E(e.$$.fragment,l),E(r.$$.fragment,l),u=!0)},o(l){V(e.$$.fragment,l),V(r.$$.fragment,l),u=!1},d(l){N(e,l),l&&v(t),N(r,l),l&&v(a),l&&v(o),n[12](null)}}}function Qt(n,e,s){let t=!1,r,a,o,u=!1,f;const m=()=>s(0,t=!t);async function l(){s(4,u=!0);const y=o.getContext("2d");s(3,o.height=r.videoHeight,o),s(3,o.width=r.videoWidth,o),y&&y.drawImage(r,0,0,o.width,o.height);const H=o.toDataURL("image/png");It.set(H),$t("/scan/maptransform")}function d(){s(5,f=a.deviceId)}function i(y){t=y,s(0,t)}function h(y){a=y,s(2,a)}function S(y){r=y,s(1,r)}function q(y){ee[y?"unshift":"push"](()=>{o=y,s(3,o)})}return[t,r,a,o,u,f,m,l,d,i,h,S,q]}class es extends ie{constructor(e){super(),ce(this,e,Qt,zt,ue,{})}}export{es as default};
