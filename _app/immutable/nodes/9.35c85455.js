import{s as J}from"../chunks/sizeStore.9e8dcba2.js";import{J as U,S as X,i as F,s as q,y as b,a as R,z as v,c as M,A as w,b as g,d as $,f as E,g as m,B as k,h as p,I,o as K,k as B,q as h,l as O,m as V,r as S,n as G,G as H,H as _,e as T,v as L}from"../chunks/index.9fac37f0.js";import{r as Q}from"../chunks/index.3158323b.js";import{g as W}from"../chunks/getError.85d9fc82.js";import{g as y}from"../chunks/navigation.55d5ecee.js";import{A as D}from"../chunks/ActionButton.e9d49ffd.js";import{A as Y}from"../chunks/ActionMenu.841c3a82.js";import{E as Z}from"../chunks/ErrorMessage.2c2c7df7.js";import{M as x}from"../chunks/Menubar.0dea1f1b.js";import{P as ee}from"../chunks/P5PreviewCurves.b89f3958.js";import{c as te}from"../chunks/contourLineStore.bca35346.js";import{d as re}from"../chunks/difficultyStore.acc5b7e1.js";import{g as C}from"../chunks/gltfStore.8222d85d.js";const oe=({url:i})=>{const t=W();{const o=U(J);if(!o.width||!o.height){const e=encodeURIComponent("Preview is not available without a size");throw Q(307,`/capture?error=${e}`)}}return{...t}},ze=Object.freeze(Object.defineProperty({__proto__:null,load:oe},Symbol.toStringTag,{value:"Module"}));function ne(i){let t,o;return{c(){t=B("div"),o=h("Re-scan"),this.h()},l(e){t=O(e,"DIV",{slot:!0});var r=V(t);o=S(r,"Re-scan"),r.forEach(p),this.h()},h(){G(t,"slot","backTitle")},m(e,r){g(e,t,r),H(t,o)},p:_,d(e){e&&p(t)}}}function N(i){let t,o;return t=new ee({props:{curves:i[3]?.curves}}),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,r){w(t,e,r),o=!0},p(e,r){const s={};r&8&&(s.curves=e[3]?.curves),t.$set(s)},i(e){o||(m(t.$$.fragment,e),o=!0)},o(e){$(t.$$.fragment,e),o=!1},d(e){k(t,e)}}}function j(i){let t,o;return t=new Z({props:{error:i[0].error}}),t.$on("dismiss",i[4]),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,r){w(t,e,r),o=!0},p(e,r){const s={};r&1&&(s.error=e[0].error),t.$set(s)},i(e){o||(m(t.$$.fragment,e),o=!0)},o(e){$(t.$$.fragment,e),o=!1},d(e){k(t,e)}}}function se(i){let t;return{c(){t=h("Show in 3D model")},l(o){t=S(o,"Show in 3D model")},m(o,e){g(o,t,e)},d(o){o&&p(t)}}}function ae(i){let t,o;return{c(){t=B("div"),o=h("Loading contour lines"),this.h()},l(e){t=O(e,"DIV",{slot:!0});var r=V(t);o=S(r,"Loading contour lines"),r.forEach(p),this.h()},h(){G(t,"slot","loading")},m(e,r){g(e,t,r),H(t,o)},p:_,d(e){e&&p(t)}}}function ie(i){let t,o;return t=new D({props:{loading:!i[1],href:"/visual/ar",$$slots:{default:[ue]},$$scope:{ctx:i}}}),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,r){w(t,e,r),o=!0},p(e,r){const s={};r&2&&(s.loading=!e[1]),r&64&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){o||(m(t.$$.fragment,e),o=!0)},o(e){$(t.$$.fragment,e),o=!1},d(e){k(t,e)}}}function le(i){let t,o;return t=new D({props:{loading:!i[1],href:"/visual/ar",$$slots:{default:[ce]},$$scope:{ctx:i}}}),{c(){b(t.$$.fragment)},l(e){v(t.$$.fragment,e)},m(e,r){w(t,e,r),o=!0},p(e,r){const s={};r&2&&(s.loading=!e[1]),r&64&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){o||(m(t.$$.fragment,e),o=!0)},o(e){$(t.$$.fragment,e),o=!1},d(e){k(t,e)}}}function fe(i){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function ue(i){let t,o="(no official support)",e;return{c(){t=h("Show in AR "),e=h(o)},l(r){t=S(r,"Show in AR "),e=S(r,o)},m(r,s){g(r,t,s),g(r,e,s)},p:_,d(r){r&&p(t),r&&p(e)}}}function ce(i){let t,o="(Recommended)",e;return{c(){t=h("Show in AR "),e=h(o)},l(r){t=S(r,"Show in AR "),e=S(r,o)},m(r,s){g(r,t,s),g(r,e,s)},p:_,d(r){r&&p(t),r&&p(e)}}}function me(i){let t,o,e,r,s,c,f,n=i[0].error&&j(i);o=new D({props:{loading:!i[1],secondary:!0,href:"/visual/3d",$$slots:{loading:[ae],default:[se]},$$scope:{ctx:i}}});const l=[fe,le,ie],d=[];function A(a,u){return a[1]?a[2]?1:2:0}return r=A(i),s=d[r]=l[r](i),{c(){n&&n.c(),t=R(),b(o.$$.fragment),e=R(),s.c(),c=T()},l(a){n&&n.l(a),t=M(a),v(o.$$.fragment,a),e=M(a),s.l(a),c=T()},m(a,u){n&&n.m(a,u),g(a,t,u),w(o,a,u),g(a,e,u),d[r].m(a,u),g(a,c,u),f=!0},p(a,u){a[0].error?n?(n.p(a,u),u&1&&m(n,1)):(n=j(a),n.c(),m(n,1),n.m(t.parentNode,t)):n&&(L(),$(n,1,1,()=>{n=null}),E());const P={};u&2&&(P.loading=!a[1]),u&64&&(P.$$scope={dirty:u,ctx:a}),o.$set(P);let z=r;r=A(a),r===z?d[r].p(a,u):(L(),$(d[z],1,1,()=>{d[z]=null}),E(),s=d[r],s?s.p(a,u):(s=d[r]=l[r](a),s.c()),m(s,1),s.m(c.parentNode,c))},i(a){f||(m(n),m(o.$$.fragment,a),m(s),f=!0)},o(a){$(n),$(o.$$.fragment,a),$(s),f=!1},d(a){n&&n.d(a),a&&p(t),k(o,a),a&&p(e),d[r].d(a),a&&p(c)}}}function pe(i){let t,o,e=i[3],r,s,c;t=new x({props:{back:"/capture",title:"preview",$$slots:{backTitle:[ne]},$$scope:{ctx:i}}});let f=N(i);return s=new Y({props:{$$slots:{default:[me]},$$scope:{ctx:i}}}),{c(){b(t.$$.fragment),o=R(),f.c(),r=R(),b(s.$$.fragment)},l(n){v(t.$$.fragment,n),o=M(n),f.l(n),r=M(n),v(s.$$.fragment,n)},m(n,l){w(t,n,l),g(n,o,l),f.m(n,l),g(n,r,l),w(s,n,l),c=!0},p(n,[l]){const d={};l&64&&(d.$$scope={dirty:l,ctx:n}),t.$set(d),l&8&&q(e,e=n[3])?(L(),$(f,1,1,_),E(),f=N(n),f.c(),m(f,1),f.m(r.parentNode,r)):f.p(n,l);const A={};l&71&&(A.$$scope={dirty:l,ctx:n}),s.$set(A)},i(n){c||(m(t.$$.fragment,n),m(f),m(s.$$.fragment,n),c=!0)},o(n){$(t.$$.fragment,n),$(f),$(s.$$.fragment,n),c=!1},d(n){k(t,n),n&&p(o),f.d(n),n&&p(r),k(s,n)}}}function $e(i,t,o){let e,r;I(i,te,l=>o(3,e=l)),I(i,re,l=>o(5,r=l));let{data:s}=t,c=!1,f=!1;K(async()=>{if(!e.curves||!e.hierarchy)return y("/capture");console.log(e.curves),await C.setup(e,r.lava_forking),C.build(e),o(2,f=await navigator?.xr?.isSessionSupported("immersive-ar")??!1),o(1,c=!0)});const n=()=>y("/preview");return i.$$set=l=>{"data"in l&&o(0,s=l.data)},[s,c,f,e,n]}class Ee extends X{constructor(t){super(),F(this,t,$e,pe,q,{data:0})}}export{Ee as component,ze as universal};
