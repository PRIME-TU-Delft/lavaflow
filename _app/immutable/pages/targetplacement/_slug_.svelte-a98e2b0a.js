import{S as O,i as j,s as J,w,x as S,y as T,E as z,q as g,o as h,B as C,J as B,e as N,t as D,k as K,c as W,a as Y,h as A,d as _,m as Q,b as x,g as p,K as V,P as se,Q as oe,L as ae,l as q,n as U,p as X,f as fe,F as me,G as _e,H as de,I as ge,a4 as he,j as pe}from"../../chunks/index-e50d45aa.js";import{B as Z,a as $e,N as le,e as be,f as ve}from"../../chunks/NavigationButton-d591ec72.js";import{P as ke}from"../../chunks/P5-bd5cfe29.js";import{t as G,c as ie,a as ye,D as te}from"../../chunks/contourLineStore-67ef1863.js";import{d as ue}from"../../chunks/difficultyStore-0791473c.js";import"../../chunks/@vite-plugin-wasm-pack@wasm-9c455baf.js";import{P as we}from"../../chunks/Page-c4546c49.js";import{M as Se}from"../../chunks/Modal-15ebe271.js";import"../../chunks/preload-helper-60cab3ee.js";import"../../chunks/index-ca69d11e.js";function Te(o){let t,n;return t=new ke({props:{sketch:o[0]}}),{c(){w(t.$$.fragment)},l(e){S(t.$$.fragment,e)},m(e,r){T(t,e,r),n=!0},p:z,i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){C(t,e)}}}function Ce(o,t,n){let e,r,s;B(o,G,l=>n(5,e=l)),B(o,ue,l=>n(6,r=l)),B(o,ie,l=>n(7,s=l));let{foregroundWidth:f}=t,{foregroundHeight:u}=t,{targetSelected:a}=t,{curves:i}=t;function c(l){l.setup=()=>{l.createCanvas(f,u)},l.draw=()=>{l.background(230),l.stroke(30),i.forEach(b=>{l.strokeWeight(4),l.noFill(),l.beginShape();for(let[E,M]of b)l.vertex(E,M);l.endShape(l.CLOSE)});const y=s!=null?s:[];for(let b of s){l.strokeWeight(1),l.stroke("#e15f55f0");const[E,M]=b;l.fill("#e15f55f0"),l.ellipse(E,M,50,50),l.noFill(),l.strokeWeight(.5),l.ellipse(E,M,r.min_crater_distance*2,r.min_crater_distance*2)}let $=20;for(let b=0;b<e.length;b++){let E=e[b];E.update(l,y,r.min_crater_distance,e,r.min_steam_turbine_separation,b),E.drawCircle(l,$,b+1)}let v="";if(e.length!=r.min_steam_turbines&&r.min_steam_turbines==r.max_steam_turbines?v="You must place exactly "+r.min_steam_turbines+" steam turbines":e.length<r.min_steam_turbines?v="You must place at least "+r.min_steam_turbines+" steam turbines":e.length==r.max_steam_turbines&&(v="You have reached the maximal amount of "+r.max_steam_turbines+" steam turbines"),e.length<r.min_steam_turbines||e.length>=r.max_steam_turbines){l.noStroke(),l.fill(51),l.textSize(15),l.textAlign(l.CENTER);let b=l.textWidth(v);l.rectMode(l.CENTER),l.rect(l.width/2,60,b+10,30),l.strokeWeight(1),l.fill(255),l.text(v,l.width/2,65)}},l.mousePressed=()=>{if(!(e!=null&&e.length))return;let y=!1;for(let $=0;$<e.length;$++){let v=!1;e[$].deselect(),y||(v=e[$].pressed(l,!0),y=v),v&&n(1,a=$)}},l.mouseReleased=()=>{if(!!(e!=null&&e.length)){for(let y of e)y.released();G.set(e)}}}return o.$$set=l=>{"foregroundWidth"in l&&n(2,f=l.foregroundWidth),"foregroundHeight"in l&&n(3,u=l.foregroundHeight),"targetSelected"in l&&n(1,a=l.targetSelected),"curves"in l&&n(4,i=l.curves)},[c,a,f,u,i]}class Ee extends O{constructor(t){super(),j(this,t,Ce,Te,J,{foregroundWidth:2,foregroundHeight:3,targetSelected:1,curves:4})}}function Pe(o){let t,n,e,r,s,f;return{c(){t=N("div"),n=N("h2"),e=D("Instructions"),r=K(),s=N("div"),f=D(`Add targets where you think the lava will flow. You can't place targets too close to 
		the craters or too close to other targets. How close you can place targets to craters
		and other targets depends on the difficulty mode you selected. There is also a minimum
		amount of targets you need to place, which also depends on your difficulty mode. You
		can never place more than 10 targets.`),this.h()},l(u){t=W(u,"DIV",{class:!0});var a=Y(t);n=W(a,"H2",{});var i=Y(n);e=A(i,"Instructions"),i.forEach(_),r=Q(a),s=W(a,"DIV",{class:!0});var c=Y(s);f=A(c,`Add targets where you think the lava will flow. You can't place targets too close to 
		the craters or too close to other targets. How close you can place targets to craters
		and other targets depends on the difficulty mode you selected. There is also a minimum
		amount of targets you need to place, which also depends on your difficulty mode. You
		can never place more than 10 targets.`),c.forEach(_),a.forEach(_),this.h()},h(){x(s,"class","instruction"),x(t,"class","instructions svelte-tryer5")},m(u,a){p(u,t,a),V(t,n),V(n,e),V(t,r),V(t,s),V(s,f)},p:z,i:z,o:z,d(u){u&&_(t)}}}class Ie extends O{constructor(t){super(),j(this,t,null,Pe,J,{})}}function Be(o){let t,n;return t=new Ie({}),{c(){w(t.$$.fragment)},l(e){S(t.$$.fragment,e)},m(e,r){T(t,e,r),n=!0},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){C(t,e)}}}function ne(o){let t,n,e,r;function s(u){o[11](u)}let f={foregroundHeight:o[16],foregroundWidth:o[17],curves:o[4].curves};return o[0]!==void 0&&(f.targetSelected=o[0]),n=new Ee({props:f}),se.push(()=>oe(n,"targetSelected",s)),{c(){t=N("div"),w(n.$$.fragment),this.h()},l(u){t=W(u,"DIV",{class:!0});var a=Y(t);S(n.$$.fragment,a),a.forEach(_),this.h()},h(){x(t,"class","sketch svelte-1invhxf")},m(u,a){p(u,t,a),T(n,t,null),r=!0},p(u,a){const i={};a&65536&&(i.foregroundHeight=u[16]),a&131072&&(i.foregroundWidth=u[17]),a&16&&(i.curves=u[4].curves),!e&&a&1&&(e=!0,i.targetSelected=u[0],ae(()=>e=!1)),n.$set(i)},i(u){r||(g(n.$$.fragment,u),r=!0)},o(u){h(n.$$.fragment,u),r=!1},d(u){u&&_(t),C(n)}}}function De(o){var r;let t,n,e=((r=o[4])==null?void 0:r.curves)&&o[2]&&o[3]&&ne(o);return{c(){e&&e.c(),t=q()},l(s){e&&e.l(s),t=q()},m(s,f){e&&e.m(s,f),p(s,t,f),n=!0},p(s,f){var u;((u=s[4])==null?void 0:u.curves)&&s[2]&&s[3]?e?(e.p(s,f),f&28&&g(e,1)):(e=ne(s),e.c(),g(e,1),e.m(t.parentNode,t)):e&&(U(),h(e,1,1,()=>{e=null}),X())},i(s){n||(g(e),n=!0)},o(s){h(e),n=!1},d(s){e&&e.d(s),s&&_(t)}}}function Ae(o){let t;return{c(){t=N("div"),this.h()},l(n){t=W(n,"DIV",{slot:!0,style:!0}),Y(t).forEach(_),this.h()},h(){x(t,"slot","background"),fe(t,"background","#aaa")},m(n,e){p(n,t,e)},p:z,d(n){n&&_(t)}}}function He(o){let t,n;const e=o[7].default,r=me(e,o,o[12],null);return{c(){t=N("div"),r&&r.c(),this.h()},l(s){t=W(s,"DIV",{slot:!0});var f=Y(t);r&&r.l(f),f.forEach(_),this.h()},h(){x(t,"slot","headerButton")},m(s,f){p(s,t,f),r&&r.m(t,null),n=!0},p(s,f){r&&r.p&&(!n||f&4096)&&_e(r,e,s,s[12],n?ge(e,s[12],f,null):de(s[12]),null)},i(s){n||(g(r,s),n=!0)},o(s){h(r,s),n=!1},d(s){s&&_(t),r&&r.d(s)}}}function Ne(o){let t;return{c(){t=D("Place turbine | Instructions")},l(n){t=A(n,"Place turbine | Instructions")},m(n,e){p(n,t,e)},d(n){n&&_(t)}}}function We(o){let t,n;return t=new le({props:{back:!0,to:"/scan/mapscanning",$$slots:{default:[Me]},$$scope:{ctx:o}}}),{c(){w(t.$$.fragment)},l(e){S(t.$$.fragment,e)},m(e,r){T(t,e,r),n=!0},p(e,r){const s={};r&4096&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){C(t,e)}}}function Ye(o){let t,n,e,r,s=o[3].length>0&&re(o);function f(){return o[10](o[17],o[16])}return e=new Z({props:{icon:be,$$slots:{default:[xe]},$$scope:{ctx:o}}}),e.$on("click",f),{c(){t=N("div"),s&&s.c(),n=K(),w(e.$$.fragment),this.h()},l(u){t=W(u,"DIV",{class:!0});var a=Y(t);s&&s.l(a),n=Q(a),S(e.$$.fragment,a),a.forEach(_),this.h()},h(){x(t,"class","editTurbines svelte-1invhxf")},m(u,a){p(u,t,a),s&&s.m(t,null),V(t,n),T(e,t,null),r=!0},p(u,a){o=u,o[3].length>0?s?(s.p(o,a),a&8&&g(s,1)):(s=re(o),s.c(),g(s,1),s.m(t,n)):s&&(U(),h(s,1,1,()=>{s=null}),X());const i={};a&4096&&(i.$$scope={dirty:a,ctx:o}),e.$set(i)},i(u){r||(g(s),g(e.$$.fragment,u),r=!0)},o(u){h(s),h(e.$$.fragment,u),r=!1},d(u){u&&_(t),s&&s.d(),C(e)}}}function Me(o){let t;return{c(){t=D("No image found. Go to map scanning")},l(n){t=A(n,"No image found. Go to map scanning")},m(n,e){p(n,t,e)},d(n){n&&_(t)}}}function re(o){let t,n;return t=new Z({props:{secondary:!0,icon:ve,$$slots:{default:[Ve]},$$scope:{ctx:o}}}),t.$on("click",o[5]),{c(){w(t.$$.fragment)},l(e){S(t.$$.fragment,e)},m(e,r){T(t,e,r),n=!0},p(e,r){const s={};r&4096&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){C(t,e)}}}function Ve(o){let t;return{c(){t=D("Clear all")},l(n){t=A(n,"Clear all")},m(n,e){p(n,t,e)},d(n){n&&_(t)}}}function xe(o){let t;return{c(){t=D("Add steam turbine")},l(n){t=A(n,"Add steam turbine")},m(n,e){p(n,t,e)},d(n){n&&_(t)}}}function Fe(o){let t,n,e,r,s,f;t=new Z({props:{secondary:!0,icon:$e,$$slots:{default:[Ne]},$$scope:{ctx:o}}}),t.$on("click",o[9]);const u=[Ye,We],a=[];function i(c,l){return c[4]?0:1}return e=i(o),r=a[e]=u[e](o),{c(){w(t.$$.fragment),n=K(),r.c(),s=q()},l(c){S(t.$$.fragment,c),n=Q(c),r.l(c),s=q()},m(c,l){T(t,c,l),p(c,n,l),a[e].m(c,l),p(c,s,l),f=!0},p(c,l){const y={};l&4096&&(y.$$scope={dirty:l,ctx:c}),t.$set(y);let $=e;e=i(c),e===$?a[e].p(c,l):(U(),h(a[$],1,1,()=>{a[$]=null}),X(),r=a[e],r?r.p(c,l):(r=a[e]=u[e](c),r.c()),g(r,1),r.m(s.parentNode,s))},i(c){f||(g(t.$$.fragment,c),g(r),f=!0)},o(c){h(t.$$.fragment,c),h(r),f=!1},d(c){C(t,c),c&&_(n),a[e].d(c),c&&_(s)}}}function Le(o){let t,n,e,r,s;function f(a){o[8](a)}let u={title:"transformation instructions",closeButtons:"top",$$slots:{default:[Be]},$$scope:{ctx:o}};return o[1]!==void 0&&(u.visible=o[1]),t=new Se({props:u}),se.push(()=>oe(t,"visible",f)),r=new we({props:{$$slots:{footer:[Fe,({foregroundHeight:a,foregroundWidth:i})=>({16:a,17:i}),({foregroundHeight:a,foregroundWidth:i})=>(a?65536:0)|(i?131072:0)],headerButton:[He,({foregroundHeight:a,foregroundWidth:i})=>({16:a,17:i}),({foregroundHeight:a,foregroundWidth:i})=>(a?65536:0)|(i?131072:0)],background:[Ae,({foregroundHeight:a,foregroundWidth:i})=>({16:a,17:i}),({foregroundHeight:a,foregroundWidth:i})=>(a?65536:0)|(i?131072:0)],default:[De,({foregroundHeight:a,foregroundWidth:i})=>({16:a,17:i}),({foregroundHeight:a,foregroundWidth:i})=>(a?65536:0)|(i?131072:0)]},$$scope:{ctx:o}}}),{c(){w(t.$$.fragment),e=K(),w(r.$$.fragment)},l(a){S(t.$$.fragment,a),e=Q(a),S(r.$$.fragment,a)},m(a,i){T(t,a,i),p(a,e,i),T(r,a,i),s=!0},p(a,[i]){const c={};i&4096&&(c.$$scope={dirty:i,ctx:a}),!n&&i&2&&(n=!0,c.visible=a[1],ae(()=>n=!1)),t.$set(c);const l={};i&200735&&(l.$$scope={dirty:i,ctx:a}),r.$set(l)},i(a){s||(g(t.$$.fragment,a),g(r.$$.fragment,a),s=!0)},o(a){h(t.$$.fragment,a),h(r.$$.fragment,a),s=!1},d(a){C(t,a),a&&_(e),C(r,a)}}}function ze(o,t,n){let e,r,s,f;B(o,ue,m=>n(2,e=m)),B(o,G,m=>n(3,r=m)),B(o,ie,m=>n(13,s=m)),B(o,ye,m=>n(4,f=m));let{$$slots:u={},$$scope:a}=t,i=-1,c=!1;function l(m,P,F,ee){if(r.length>=e.max_steam_turbines)return;const d=new te(m,P,20);d.enableSelection();for(let I of r)for(;d.isTooCloseTo(I.x,I.y,e.min_steam_turbine_separation);){let H=d.x-I.x,k=d.y-I.y;H==0&&(H=.001),k==0&&(k=.001),d.x+=H,d.y+=k}let L=!1,R=d;for(;;){L=!1,(d.x<=0||d.x>=F||d.y<=0||d.y>=ee)&&(d.x=20+Math.random()*(F-40),d.y=20+Math.random()*(ee-40));for(let k of r)d.isTooCloseTo(k.x,k.y,e.min_steam_turbine_separation)&&(L=!0,R=k);for(let k of s)d.isTooCloseTo(k[0],k[1],e.min_crater_distance)&&(L==!1&&(R=new te(k[0],k[1],20)),L=!0);if(!L)break;let I=d.x-R.x,H=d.y-R.y;I==0&&(I=.001),H==0&&(H=.001),d.x+=I,d.y+=H}G.add(d)}function y(){i!=-1&&(G.remove(i),n(0,i=-1))}function $(){for(let m=r.length-1;m>=0;m--)n(0,i=m),y()}function v(m,P){let F=!1;for(;r.length<e.min_steam_turbines;)l(m/8,P/8,m,P),F=!0;F||l(m/8,P/8,m,P-100)}function b(m){c=m,n(1,c)}const E=()=>n(1,c=!c),M=(m,P)=>v(m,P-100);function ce(m){i=m,n(0,i)}return o.$$set=m=>{"$$scope"in m&&n(12,a=m.$$scope)},[i,c,e,r,f,$,v,u,b,E,M,ce,a]}class Ge extends O{constructor(t){super(),j(this,t,ze,Le,J,{})}}const Re=()=>{const o=he("__svelte__");return{page:{subscribe:o.page.subscribe},navigating:{subscribe:o.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:o.navigating.subscribe}},session:o.session,updated:o.updated}},qe={subscribe(o){return Re().page.subscribe(o)}};function Oe(o){let t,n=o[0].params.slug+"",e;return{c(){t=D("Apply and go to "),e=D(n)},l(r){t=A(r,"Apply and go to "),e=A(r,n)},m(r,s){p(r,t,s),p(r,e,s)},p(r,s){s&1&&n!==(n=r[0].params.slug+"")&&pe(e,n)},d(r){r&&_(t),r&&_(e)}}}function je(o){let t,n;return t=new le({props:{back:!0,to:"/visualise/"+o[0].params.slug,$$slots:{default:[Oe]},$$scope:{ctx:o}}}),{c(){w(t.$$.fragment)},l(e){S(t.$$.fragment,e)},m(e,r){T(t,e,r),n=!0},p(e,r){const s={};r&1&&(s.to="/visualise/"+e[0].params.slug),r&3&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){C(t,e)}}}function Je(o){let t,n;return t=new Ge({props:{$$slots:{default:[je]},$$scope:{ctx:o}}}),{c(){w(t.$$.fragment)},l(e){S(t.$$.fragment,e)},m(e,r){T(t,e,r),n=!0},p(e,[r]){const s={};r&3&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){C(t,e)}}}const at=!0;function Ke(o,t,n){let e;return B(o,qe,r=>n(0,e=r)),[e]}class lt extends O{constructor(t){super(),j(this,t,Ke,Je,J,{})}}export{lt as default,at as prerender};
