import{S as N,i as j,s as H,e as $,k as E,c as y,a as I,m as S,d as _,g as p,K as k,G as q,H as A,I as F,q as v,o as g,b as w,U as fe,V as K,Q,n as L,p as U,M as ie,W as de,F as W,t as D,h as C,j as ae,T as _e,X as me,E as P,v as ce,Y as he,l as z,Z as J,w as T,x as M,f as G,y as B,B as O,_ as ve,$ as pe}from"../../chunks/index-9cd2e54e.js";import{B as X,b as ge,c as be}from"../../chunks/Button-5d6b26fc.js";import{P as ke,r as we}from"../../chunks/imageStore-7d4b7149.js";import{g as $e}from"../../chunks/navigation-0e6511d1.js";import"../../chunks/index-6c269418.js";import"../../chunks/singletons-d1fb5791.js";function Y(s,e,l){const t=s.slice();return t[6]=e[l],t[8]=l,t}const ye=s=>({option:s&2}),Z=s=>({option:s[6],index:s[8]});function Ie(s){let e=s[6]+"",l;return{c(){l=D(e)},l(t){l=C(t,e)},m(t,n){p(t,l,n)},p(t,n){n&2&&e!==(e=t[6]+"")&&ae(l,e)},d(t){t&&_(l)}}}function x(s){let e,l,t,n;const o=s[3].default,i=W(o,s,s[2],Z),c=i||Ie(s);return{c(){e=$("option"),c&&c.c(),l=E(),this.h()},l(r){e=y(r,"OPTION",{});var a=I(e);c&&c.l(a),l=S(a),a.forEach(_),this.h()},h(){e.__value=t=s[6],e.value=e.__value},m(r,a){p(r,e,a),c&&c.m(e,null),k(e,l),n=!0},p(r,a){i?i.p&&(!n||a&6)&&q(i,o,r,r[2],n?F(o,r[2],a,ye):A(r[2]),Z):c&&c.p&&(!n||a&2)&&c.p(r,n?a:-1),(!n||a&2&&t!==(t=r[6]))&&(e.__value=t,e.value=e.__value)},i(r){n||(v(c,r),n=!0)},o(r){g(c,r),n=!1},d(r){r&&_(e),c&&c.d(r)}}}function Ve(s){let e,l,t,n,o=s[1],i=[];for(let r=0;r<o.length;r+=1)i[r]=x(Y(s,o,r));const c=r=>g(i[r],1,1,()=>{i[r]=null});return{c(){e=$("select");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){e=y(r,"SELECT",{class:!0});var a=I(e);for(let f=0;f<i.length;f+=1)i[f].l(a);a.forEach(_),this.h()},h(){w(e,"class","svelte-mtu0p6"),s[0]===void 0&&fe(()=>s[5].call(e))},m(r,a){p(r,e,a);for(let f=0;f<i.length;f+=1)i[f].m(e,null);K(e,s[0]),l=!0,t||(n=[Q(e,"change",s[5]),Q(e,"change",s[4])],t=!0)},p(r,[a]){if(a&6){o=r[1];let f;for(f=0;f<o.length;f+=1){const u=Y(r,o,f);i[f]?(i[f].p(u,a),v(i[f],1)):(i[f]=x(u),i[f].c(),v(i[f],1),i[f].m(e,null))}for(L(),f=o.length;f<i.length;f+=1)c(f);U()}a&3&&K(e,r[0])},i(r){if(!l){for(let a=0;a<o.length;a+=1)v(i[a]);l=!0}},o(r){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)g(i[a]);l=!1},d(r){r&&_(e),ie(i,r),t=!1,de(n)}}}function Ee(s,e,l){let{$$slots:t={},$$scope:n}=e,{value:o}=e,{options:i}=e;function c(a){_e.call(this,s,a)}function r(){o=me(this),l(0,o),l(1,i)}return s.$$set=a=>{"value"in a&&l(0,o=a.value),"options"in a&&l(1,i=a.options),"$$scope"in a&&l(2,n=a.$$scope)},[o,i,n,t,c,r]}class Se extends N{constructor(e){super(),j(this,e,Ee,Ve,H,{value:0,options:1})}}const ee=[{title:"3 marker visible",description:"To recognize the level curves, we need to have the 3 markers fully visible"},{title:"Curves should have sufficient margin",description:"The curves should have sufficient margin between them, overlapping or close lines are hard to interpret"},{title:"Markers shoud not be too far or close",description:"Scanning works best from a distance of 0.5 meters from the piece of paper. For best the best result try to scan the paper as close to parallel as possible"},{title:"Drawing with dark pen",description:"To recognise your level curves, we prefer a dark and thic pen. Using a lighter pen will result in inaccurate results"},{title:"Propper lighting",description:"Level curves are hard to distinguish from background in a low light setting. Try to use natual daylight or a propper ceiling light for best results."},{title:"Close your curves",description:"To avoid false readings, close your curves as much as possible"},{title:"Only one paper should be visible",description:"To avoid false readings, only one paper should be visible at a time"}];function te(s,e,l){const t=s.slice();return t[0]=e[l],t}function le(s){let e,l,t=s[0].title+"",n,o,i,c=s[0].description+"",r,a;return{c(){e=$("div"),l=$("div"),n=D(t),o=E(),i=$("div"),r=D(c),a=E(),this.h()},l(f){e=y(f,"DIV",{class:!0});var u=I(e);l=y(u,"DIV",{class:!0});var d=I(l);n=C(d,t),d.forEach(_),o=S(u),i=y(u,"DIV",{class:!0});var m=I(i);r=C(m,c),m.forEach(_),a=S(u),u.forEach(_),this.h()},h(){w(l,"class","title svelte-1fkle3y"),w(i,"class","description"),w(e,"class","instruction svelte-1fkle3y")},m(f,u){p(f,e,u),k(e,l),k(l,n),k(e,o),k(e,i),k(i,r),k(e,a)},p:P,d(f){f&&_(e)}}}function De(s){let e,l,t,n,o,i,c,r,a,f=ee,u=[];for(let d=0;d<f.length;d+=1)u[d]=le(te(s,f,d));return{c(){e=$("div"),l=$("h2"),t=D("Good example of contour map"),n=E(),o=$("div"),i=E(),c=$("h2"),r=D("Instructions"),a=E();for(let d=0;d<u.length;d+=1)u[d].c();this.h()},l(d){e=y(d,"DIV",{class:!0});var m=I(e);l=y(m,"H2",{});var h=I(l);t=C(h,"Good example of contour map"),h.forEach(_),n=S(m),o=y(m,"DIV",{class:!0}),I(o).forEach(_),i=S(m),c=y(m,"H2",{});var b=I(c);r=C(b,"Instructions"),b.forEach(_),a=S(m);for(let V=0;V<u.length;V+=1)u[V].l(m);m.forEach(_),this.h()},h(){w(o,"class","example svelte-1fkle3y"),w(e,"class","instructions svelte-1fkle3y")},m(d,m){p(d,e,m),k(e,l),k(l,t),k(e,n),k(e,o),k(e,i),k(e,c),k(c,r),k(e,a);for(let h=0;h<u.length;h+=1)u[h].m(e,null)},p(d,[m]){if(m&0){f=ee;let h;for(h=0;h<f.length;h+=1){const b=te(d,f,h);u[h]?u[h].p(b,m):(u[h]=le(b),u[h].c(),u[h].m(e,null))}for(;h<u.length;h+=1)u[h].d(1);u.length=f.length}},i:P,o:P,d(d){d&&_(e),ie(u,d)}}}class Ce extends N{constructor(e){super(),j(this,e,null,De,H,{})}}const Te=s=>({loading:s&2,stream:s&1,error:s&4}),oe=s=>({loading:s[1],stream:s[0],error:s[2]});function Me(s){let e;const l=s[4].default,t=W(l,s,s[3],oe);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,[o]){t&&t.p&&(!e||o&15)&&q(t,l,n,n[3],e?F(l,n[3],o,Te):A(n[3]),oe)},i(n){e||(v(t,n),e=!0)},o(n){g(t,n),e=!1},d(n){t&&t.d(n)}}}function Be(s,e,l){let{$$slots:t={},$$scope:n}=e,o,i=!0,c;const r=async()=>{try{l(1,i=!0),l(0,o=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}})),l(1,i=!1),l(2,c="")}catch(a){l(2,c=""+a)}};return ce(async()=>{await r()}),he(()=>{!o||o.getTracks().forEach(a=>a.stop())}),s.$$set=a=>{"$$scope"in a&&l(3,n=a.$$scope)},[o,i,c,n,t]}class Oe extends N{constructor(e){super(),j(this,e,Be,Me,H,{})}}function Pe(s){let e;return{c(){e=$("video"),this.h()},l(l){e=y(l,"VIDEO",{style:!0,preload:!0,type:!0,class:!0}),I(e).forEach(_),this.h()},h(){w(e,"style",s[1]),e.loop=!0,e.playsInline=!0,e.autoplay=!1,e.controls=!1,w(e,"preload","auto"),w(e,"type","video/mp4"),w(e,"class","svelte-wvnab8")},m(l,t){p(l,e,t),s[7](e)},p(l,t){t&2&&w(e,"style",l[1])},i:P,o:P,d(l){l&&_(e),s[7](null)}}}function Ne(s){let e,l,t,n,o,i=s[3]&&s[3].includes("Permission denied"),c,r,a=i&&ne();const f=s[6].default,u=W(f,s,s[5],null);return{c(){e=$("div"),l=$("div"),t=$("h1"),n=D("Loading video..."),o=E(),a&&a.c(),c=E(),u&&u.c(),this.h()},l(d){e=y(d,"DIV",{class:!0});var m=I(e);l=y(m,"DIV",{class:!0});var h=I(l);t=y(h,"H1",{class:!0});var b=I(t);n=C(b,"Loading video..."),b.forEach(_),o=S(h),a&&a.l(h),h.forEach(_),m.forEach(_),c=S(d),u&&u.l(d),this.h()},h(){w(t,"class","svelte-wvnab8"),w(l,"class","svelte-wvnab8"),w(e,"class","loadingVideo svelte-wvnab8")},m(d,m){p(d,e,m),k(e,l),k(l,t),k(t,n),k(l,o),a&&a.m(l,null),p(d,c,m),u&&u.m(d,m),r=!0},p(d,m){m&8&&(i=d[3]&&d[3].includes("Permission denied")),i?a||(a=ne(),a.c(),a.m(l,null)):a&&(a.d(1),a=null),u&&u.p&&(!r||m&32)&&q(u,f,d,d[5],r?F(f,d[5],m,null):A(d[5]),null)},i(d){r||(v(u,d),r=!0)},o(d){g(u,d),r=!1},d(d){d&&_(e),a&&a.d(),d&&_(c),u&&u.d(d)}}}function ne(s){let e;return{c(){e=D("The browser is unable to access the camera, try re-enabling the camera and reload")},l(l){e=C(l,"The browser is unable to access the camera, try re-enabling the camera and reload")},m(l,t){p(l,e,t)},d(l){l&&_(e)}}}function je(s){let e,l,t,n;const o=[Ne,Pe],i=[];function c(r,a){return r[2]?0:1}return e=c(s),l=i[e]=o[e](s),{c(){l.c(),t=z()},l(r){l.l(r),t=z()},m(r,a){i[e].m(r,a),p(r,t,a),n=!0},p(r,[a]){let f=e;e=c(r),e===f?i[e].p(r,a):(L(),g(i[f],1,1,()=>{i[f]=null}),U(),l=i[e],l?l.p(r,a):(l=i[e]=o[e](r),l.c()),v(l,1),l.m(t.parentNode,t))},i(r){n||(v(l),n=!0)},o(r){g(l),n=!1},d(r){i[e].d(r),r&&_(t)}}}function He(s,e,l){let{$$slots:t={},$$scope:n}=e,{stream:o}=e,{style:i=""}=e,{loading:c=!0}=e,{error:r=""}=e,{videoSource:a=void 0}=e;function f(u){J[u?"unshift":"push"](()=>{a=u,l(0,a),l(4,o),l(2,c)})}return s.$$set=u=>{"stream"in u&&l(4,o=u.stream),"style"in u&&l(1,i=u.style),"loading"in u&&l(2,c=u.loading),"error"in u&&l(3,r=u.error),"videoSource"in u&&l(0,a=u.videoSource),"$$scope"in u&&l(5,n=u.$$scope)},s.$$.update=()=>{s.$$.dirty&21&&o&&!c&&a&&a.paused&&(l(0,a.srcObject=o,a),a.play())},[a,i,c,r,o,n,t,f]}class ue extends N{constructor(e){super(),j(this,e,He,je,H,{stream:4,style:1,loading:2,error:3,videoSource:0})}}function Le(s){let e,l,t,n;function o(c){s[10](c)}let i={error:s[14],loading:s[12],stream:s[13]};return s[1]!==void 0&&(i.videoSource=s[1]),e=new ue({props:i}),J.push(()=>ve(e,"videoSource",o)),{c(){l=$("div"),T(e.$$.fragment),this.h()},l(c){l=y(c,"DIV",{style:!0});var r=I(l);M(e.$$.fragment,r),this.h()},h(){G(l,"display","contents"),G(l,"--corner-radius","1rem")},m(c,r){p(c,l,r),B(e,l,null),n=!0},p(c,r){const a={};r&16384&&(a.error=c[14]),r&4096&&(a.loading=c[12]),r&8192&&(a.stream=c[13]),!t&&r&2&&(t=!0,a.videoSource=c[1],pe(()=>t=!1)),e.$set(a)},i(c){n||(v(e.$$.fragment,c),n=!0)},o(c){g(e.$$.fragment,c),n=!1},d(c){c&&_(l),O(e,c)}}}function Ue(s){let e,l;return e=new Ce({}),{c(){T(e.$$.fragment)},l(t){M(e.$$.fragment,t)},m(t,n){B(e,t,n),l=!0},p:P,i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){g(e.$$.fragment,t),l=!1},d(t){O(e,t)}}}function ze(s){let e,l,t,n;const o=[Ue,Le],i=[];function c(r,a){return r[0]?0:1}return e=c(s),l=i[e]=o[e](s),{c(){l.c(),t=z()},l(r){l.l(r),t=z()},m(r,a){i[e].m(r,a),p(r,t,a),n=!0},p(r,a){let f=e;e=c(r),e===f?i[e].p(r,a):(L(),g(i[f],1,1,()=>{i[f]=null}),U(),l=i[e],l?l.p(r,a):(l=i[e]=o[e](r),l.c()),v(l,1),l.m(t.parentNode,t))},i(r){n||(v(l),n=!0)},o(r){g(l),n=!1},d(r){i[e].d(r),r&&_(t)}}}function Ge(s){let e,l,t;return l=new ue({props:{loading:s[12],stream:s[13]}}),{c(){e=$("div"),T(l.$$.fragment),this.h()},l(n){e=y(n,"DIV",{slot:!0});var o=I(e);M(l.$$.fragment,o),o.forEach(_),this.h()},h(){w(e,"slot","background")},m(n,o){p(n,e,o),B(l,e,null),t=!0},p(n,o){const i={};o&4096&&(i.loading=n[12]),o&8192&&(i.stream=n[13]),l.$set(i)},i(n){t||(v(l.$$.fragment,n),t=!0)},o(n){g(l.$$.fragment,n),t=!1},d(n){n&&_(e),O(l)}}}function re(s){let e,l;return e=new Se({props:{value:s[2],options:s[3],$$slots:{default:[Re,({option:t,index:n})=>({15:t,16:n}),({option:t,index:n})=>(t?32768:0)|(n?65536:0)]},$$scope:{ctx:s}}}),{c(){T(e.$$.fragment)},l(t){M(e.$$.fragment,t)},m(t,n){B(e,t,n),l=!0},p(t,n){const o={};n&4&&(o.value=t[2]),n&8&&(o.options=t[3]),n&229376&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){g(e.$$.fragment,t),l=!1},d(t){O(e,t)}}}function Re(s){let e=(s[15].label||"Camera "+(s[16]+1))+"",l;return{c(){l=D(e)},l(t){l=C(t,e)},m(t,n){p(t,l,n)},p(t,n){n&98304&&e!==(e=(t[15].label||"Camera "+(t[16]+1))+"")&&ae(l,e)},d(t){t&&_(l)}}}function qe(s){var n;let e,l,t=!s[0]&&((n=s[3])==null?void 0:n.length)>1&&re(s);return{c(){e=$("div"),t&&t.c(),this.h()},l(o){e=y(o,"DIV",{slot:!0});var i=I(e);t&&t.l(i),i.forEach(_),this.h()},h(){w(e,"slot","options")},m(o,i){p(o,e,i),t&&t.m(e,null),l=!0},p(o,i){var c;!o[0]&&((c=o[3])==null?void 0:c.length)>1?t?(t.p(o,i),i&9&&v(t,1)):(t=re(o),t.c(),v(t,1),t.m(e,null)):t&&(L(),g(t,1,1,()=>{t=null}),U())},i(o){l||(v(t),l=!0)},o(o){g(t),l=!1},d(o){o&&_(e),t&&t.d()}}}function se(s){let e,l,t,n;return e=new X({props:{secondary:!0,icon:ge,$$slots:{default:[Ae]},$$scope:{ctx:s}}}),e.$on("click",s[7]),t=new X({props:{loading:s[5],icon:be,$$slots:{default:[Fe]},$$scope:{ctx:s}}}),t.$on("click",s[8]),{c(){T(e.$$.fragment),l=E(),T(t.$$.fragment)},l(o){M(e.$$.fragment,o),l=S(o),M(t.$$.fragment,o)},m(o,i){B(e,o,i),p(o,l,i),B(t,o,i),n=!0},p(o,i){const c={};i&131072&&(c.$$scope={dirty:i,ctx:o}),e.$set(c);const r={};i&32&&(r.loading=o[5]),i&131072&&(r.$$scope={dirty:i,ctx:o}),t.$set(r)},i(o){n||(v(e.$$.fragment,o),v(t.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),g(t.$$.fragment,o),n=!1},d(o){O(e,o),o&&_(l),O(t,o)}}}function Ae(s){let e;return{c(){e=D("Read scan instructions")},l(l){e=C(l,"Read scan instructions")},m(l,t){p(l,e,t)},d(l){l&&_(e)}}}function Fe(s){let e;return{c(){e=D("Capture photo of map")},l(l){e=C(l,"Capture photo of map")},m(l,t){p(l,e,t)},d(l){l&&_(e)}}}function We(s){let e,l,t=!s[0]&&se(s);return{c(){e=$("div"),t&&t.c(),this.h()},l(n){e=y(n,"DIV",{slot:!0});var o=I(e);t&&t.l(o),o.forEach(_),this.h()},h(){w(e,"slot","footer")},m(n,o){p(n,e,o),t&&t.m(e,null),l=!0},p(n,o){n[0]?t&&(L(),g(t,1,1,()=>{t=null}),U()):t?(t.p(n,o),o&1&&v(t,1)):(t=se(n),t.c(),v(t,1),t.m(e,null))},i(n){l||(v(t),l=!0)},o(n){g(t),l=!1},d(n){n&&_(e),t&&t.d()}}}function Je(s){let e,l;return e=new ke({props:{fullscreen:!s[12],title:s[6],closeButton:s[0],$$slots:{footer:[We],options:[qe],background:[Ge],default:[ze]},$$scope:{ctx:s}}}),e.$on("close",s[7]),{c(){T(e.$$.fragment)},l(t){M(e.$$.fragment,t)},m(t,n){B(e,t,n),l=!0},p(t,n){const o={};n&4096&&(o.fullscreen=!t[12]),n&64&&(o.title=t[6]),n&1&&(o.closeButton=t[0]),n&159791&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){l||(v(e.$$.fragment,t),l=!0)},o(t){g(e.$$.fragment,t),l=!1},d(t){O(e,t)}}}function Ke(s){let e,l,t,n;return e=new Oe({props:{$$slots:{default:[Je,({loading:o,stream:i,error:c})=>({12:o,13:i,14:c}),({loading:o,stream:i,error:c})=>(o?4096:0)|(i?8192:0)|(c?16384:0)]},$$scope:{ctx:s}}}),{c(){T(e.$$.fragment),l=E(),t=$("canvas"),this.h()},l(o){M(e.$$.fragment,o),l=S(o),t=y(o,"CANVAS",{id:!0,style:!0}),I(t).forEach(_),this.h()},h(){w(t,"id","captureCanvas"),G(t,"display","none"),G(t,"position","absolute")},m(o,i){B(e,o,i),p(o,l,i),p(o,t,i),s[11](t),n=!0},p(o,[i]){const c={};i&159855&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){n||(v(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){O(e,o),o&&_(l),o&&_(t),s[11](null)}}}const lt=!0;function Qe(s,e,l){let t,n=!1,o,i,c=[],r,a=!1;const f=()=>l(0,n=!n);async function u(){l(5,a=!0);const b=r.getContext("2d");l(4,r.height=o.videoHeight,r),l(4,r.width=o.videoWidth,r),b&&b.drawImage(o,0,0,r.width,r.height);const V=r.toDataURL("image/png");we.set(V),$e("/scan/maptransform")}async function d(){const V={video:i?{deviceId:i.deviceId}:{facingMode:"environment"}};console.log(JSON.stringify(V));try{const R=await navigator.mediaDevices.getUserMedia(V);l(1,o.srcObject=R,o),o.play()}catch(R){console.error("Error:",R)}}ce(async()=>{await d();const b=await navigator.mediaDevices.enumerateDevices();l(3,c=b.filter(V=>V.kind=="videoinput")),c!=null&&c.length&&l(2,i=c[0])});function m(b){o=b,l(1,o)}function h(b){J[b?"unshift":"push"](()=>{r=b,l(4,r)})}return s.$$.update=()=>{s.$$.dirty&1&&l(6,t=n?"Instructions":"Map Scanning")},[n,o,i,c,r,a,t,f,u,d,m,h]}class ot extends N{constructor(e){super(),j(this,e,Qe,Ke,H,{getStream:9})}get getStream(){return this.$$.ctx[9]}}export{ot as default,lt as prerender};
