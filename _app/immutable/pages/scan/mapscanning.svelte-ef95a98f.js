import{S as L,i as N,s as H,e as w,k as S,c as y,a as I,m as D,d as _,g,J as k,G as A,H as F,I as J,q as p,o as v,b as $,V as fe,W as X,L as Y,n as U,p as j,X as ie,Y as de,F as W,t as V,h as C,j as ae,U as _e,Z as he,E as P,v as ce,_ as me,l as G,$ as z,w as T,x as O,f as R,y as M,B,a0 as pe,a1 as ge}from"../../chunks/index-7093ffdc.js";import{B as Z,b as ve,c as be}from"../../chunks/Button-087e80c9.js";import{P as ke,r as $e}from"../../chunks/imageStore-a6fc67d0.js";import{g as we}from"../../chunks/navigation-0e6511d1.js";import"../../chunks/index-a5f040c1.js";import"../../chunks/singletons-d1fb5791.js";function K(r,e,l){const t=r.slice();return t[6]=e[l],t[8]=l,t}const ye=r=>({option:r&2}),Q=r=>({option:r[6],index:r[8]});function Ie(r){let e=r[6]+"",l;return{c(){l=V(e)},l(t){l=C(t,e)},m(t,s){g(t,l,s)},p(t,s){s&2&&e!==(e=t[6]+"")&&ae(l,e)},d(t){t&&_(l)}}}function x(r){let e,l,t,s;const o=r[3].default,i=W(o,r,r[2],Q),c=i||Ie(r);return{c(){e=w("option"),c&&c.c(),l=S(),this.h()},l(n){e=y(n,"OPTION",{});var a=I(e);c&&c.l(a),l=D(a),a.forEach(_),this.h()},h(){e.__value=t=r[6],e.value=e.__value},m(n,a){g(n,e,a),c&&c.m(e,null),k(e,l),s=!0},p(n,a){i?i.p&&(!s||a&6)&&A(i,o,n,n[2],s?J(o,n[2],a,ye):F(n[2]),Q):c&&c.p&&(!s||a&2)&&c.p(n,s?a:-1),(!s||a&2&&t!==(t=n[6]))&&(e.__value=t,e.value=e.__value)},i(n){s||(p(c,n),s=!0)},o(n){v(c,n),s=!1},d(n){n&&_(e),c&&c.d(n)}}}function Ee(r){let e,l,t,s,o=r[1],i=[];for(let n=0;n<o.length;n+=1)i[n]=x(K(r,o,n));const c=n=>v(i[n],1,1,()=>{i[n]=null});return{c(){e=w("select");for(let n=0;n<i.length;n+=1)i[n].c();this.h()},l(n){e=y(n,"SELECT",{class:!0});var a=I(e);for(let f=0;f<i.length;f+=1)i[f].l(a);a.forEach(_),this.h()},h(){$(e,"class","svelte-mtu0p6"),r[0]===void 0&&fe(()=>r[5].call(e))},m(n,a){g(n,e,a);for(let f=0;f<i.length;f+=1)i[f].m(e,null);X(e,r[0]),l=!0,t||(s=[Y(e,"change",r[5]),Y(e,"change",r[4])],t=!0)},p(n,[a]){if(a&6){o=n[1];let f;for(f=0;f<o.length;f+=1){const u=K(n,o,f);i[f]?(i[f].p(u,a),p(i[f],1)):(i[f]=x(u),i[f].c(),p(i[f],1),i[f].m(e,null))}for(U(),f=o.length;f<i.length;f+=1)c(f);j()}a&3&&X(e,n[0])},i(n){if(!l){for(let a=0;a<o.length;a+=1)p(i[a]);l=!0}},o(n){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)v(i[a]);l=!1},d(n){n&&_(e),ie(i,n),t=!1,de(s)}}}function Se(r,e,l){let{$$slots:t={},$$scope:s}=e,{value:o}=e,{options:i}=e;function c(a){_e.call(this,r,a)}function n(){o=he(this),l(0,o),l(1,i)}return r.$$set=a=>{"value"in a&&l(0,o=a.value),"options"in a&&l(1,i=a.options),"$$scope"in a&&l(2,s=a.$$scope)},[o,i,s,t,c,n]}class De extends L{constructor(e){super(),N(this,e,Se,Ee,H,{value:0,options:1})}}const ee=[{title:"3 marker visible",description:"To recognize the level curves, we need to have the 3 markers fully visible"},{title:"Curves should have sufficient margin",description:"The curves should have sufficient margin between them, overlapping or close lines are hard to interpret"},{title:"Markers shoud not be too far or close",description:"Scanning works best from a distance of 0.5 meters from the piece of paper. For best the best result try to scan the paper as close to parallel as possible"},{title:"Drawing with dark pen",description:"To recognise your level curves, we prefer a dark and thic pen. Using a lighter pen will result in inaccurate results"},{title:"Propper lighting",description:"Level curves are hard to distinguish from background in a low light setting. Try to use natual daylight or a propper ceiling light for best results."},{title:"Close your curves",description:"To avoid false readings, close your curves as much as possible"},{title:"Only one paper should be visible",description:"To avoid false readings, only one paper should be visible at a time"}];function te(r,e,l){const t=r.slice();return t[0]=e[l],t}function le(r){let e,l,t=r[0].title+"",s,o,i,c=r[0].description+"",n,a;return{c(){e=w("div"),l=w("div"),s=V(t),o=S(),i=w("div"),n=V(c),a=S(),this.h()},l(f){e=y(f,"DIV",{class:!0});var u=I(e);l=y(u,"DIV",{class:!0});var d=I(l);s=C(d,t),d.forEach(_),o=D(u),i=y(u,"DIV",{class:!0});var h=I(i);n=C(h,c),h.forEach(_),a=D(u),u.forEach(_),this.h()},h(){$(l,"class","title svelte-1fkle3y"),$(i,"class","description"),$(e,"class","instruction svelte-1fkle3y")},m(f,u){g(f,e,u),k(e,l),k(l,s),k(e,o),k(e,i),k(i,n),k(e,a)},p:P,d(f){f&&_(e)}}}function Ve(r){let e,l,t,s,o,i,c,n,a,f=ee,u=[];for(let d=0;d<f.length;d+=1)u[d]=le(te(r,f,d));return{c(){e=w("div"),l=w("h2"),t=V("Good example of contour map"),s=S(),o=w("div"),i=S(),c=w("h2"),n=V("Instructions"),a=S();for(let d=0;d<u.length;d+=1)u[d].c();this.h()},l(d){e=y(d,"DIV",{class:!0});var h=I(e);l=y(h,"H2",{});var m=I(l);t=C(m,"Good example of contour map"),m.forEach(_),s=D(h),o=y(h,"DIV",{class:!0}),I(o).forEach(_),i=D(h),c=y(h,"H2",{});var b=I(c);n=C(b,"Instructions"),b.forEach(_),a=D(h);for(let E=0;E<u.length;E+=1)u[E].l(h);h.forEach(_),this.h()},h(){$(o,"class","example svelte-1fkle3y"),$(e,"class","instructions svelte-1fkle3y")},m(d,h){g(d,e,h),k(e,l),k(l,t),k(e,s),k(e,o),k(e,i),k(e,c),k(c,n),k(e,a);for(let m=0;m<u.length;m+=1)u[m].m(e,null)},p(d,[h]){if(h&0){f=ee;let m;for(m=0;m<f.length;m+=1){const b=te(d,f,m);u[m]?u[m].p(b,h):(u[m]=le(b),u[m].c(),u[m].m(e,null))}for(;m<u.length;m+=1)u[m].d(1);u.length=f.length}},i:P,o:P,d(d){d&&_(e),ie(u,d)}}}class Ce extends L{constructor(e){super(),N(this,e,null,Ve,H,{})}}const Te=r=>({loading:r&2,stream:r&1,error:r&4}),oe=r=>({loading:r[1],stream:r[0],error:r[2]});function Oe(r){let e;const l=r[4].default,t=W(l,r,r[3],oe);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,o){t&&t.m(s,o),e=!0},p(s,[o]){t&&t.p&&(!e||o&15)&&A(t,l,s,s[3],e?J(l,s[3],o,Te):F(s[3]),oe)},i(s){e||(p(t,s),e=!0)},o(s){v(t,s),e=!1},d(s){t&&t.d(s)}}}function Me(r,e,l){let{$$slots:t={},$$scope:s}=e,o,i=!0,c;const n=async()=>{try{l(1,i=!0),l(0,o=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}})),l(1,i=!1),l(2,c="")}catch(a){l(2,c=""+a)}};return ce(async()=>{await n()}),me(()=>{!o||o.getTracks().forEach(a=>a.stop())}),r.$$set=a=>{"$$scope"in a&&l(3,s=a.$$scope)},[o,i,c,s,t]}class Be extends L{constructor(e){super(),N(this,e,Me,Oe,H,{})}}function Pe(r){let e;return{c(){e=w("video"),this.h()},l(l){e=y(l,"VIDEO",{style:!0,preload:!0,type:!0,class:!0}),I(e).forEach(_),this.h()},h(){$(e,"style",r[1]),e.loop=!0,e.playsInline=!0,e.autoplay=!1,e.controls=!1,$(e,"preload","auto"),$(e,"type","video/mp4"),$(e,"class","svelte-wvnab8")},m(l,t){g(l,e,t),r[7](e)},p(l,t){t&2&&$(e,"style",l[1])},i:P,o:P,d(l){l&&_(e),r[7](null)}}}function Le(r){let e,l,t,s,o,i=r[3]&&r[3].includes("Permission denied"),c,n,a=i&&se();const f=r[6].default,u=W(f,r,r[5],null);return{c(){e=w("div"),l=w("div"),t=w("h1"),s=V("Loading video..."),o=S(),a&&a.c(),c=S(),u&&u.c(),this.h()},l(d){e=y(d,"DIV",{class:!0});var h=I(e);l=y(h,"DIV",{class:!0});var m=I(l);t=y(m,"H1",{class:!0});var b=I(t);s=C(b,"Loading video..."),b.forEach(_),o=D(m),a&&a.l(m),m.forEach(_),h.forEach(_),c=D(d),u&&u.l(d),this.h()},h(){$(t,"class","svelte-wvnab8"),$(l,"class","svelte-wvnab8"),$(e,"class","loadingVideo svelte-wvnab8")},m(d,h){g(d,e,h),k(e,l),k(l,t),k(t,s),k(l,o),a&&a.m(l,null),g(d,c,h),u&&u.m(d,h),n=!0},p(d,h){h&8&&(i=d[3]&&d[3].includes("Permission denied")),i?a||(a=se(),a.c(),a.m(l,null)):a&&(a.d(1),a=null),u&&u.p&&(!n||h&32)&&A(u,f,d,d[5],n?J(f,d[5],h,null):F(d[5]),null)},i(d){n||(p(u,d),n=!0)},o(d){v(u,d),n=!1},d(d){d&&_(e),a&&a.d(),d&&_(c),u&&u.d(d)}}}function se(r){let e;return{c(){e=V("The browser is unable to access the camera, try re-enabling the camera and reload")},l(l){e=C(l,"The browser is unable to access the camera, try re-enabling the camera and reload")},m(l,t){g(l,e,t)},d(l){l&&_(e)}}}function Ne(r){let e,l,t,s;const o=[Le,Pe],i=[];function c(n,a){return n[2]?0:1}return e=c(r),l=i[e]=o[e](r),{c(){l.c(),t=G()},l(n){l.l(n),t=G()},m(n,a){i[e].m(n,a),g(n,t,a),s=!0},p(n,[a]){let f=e;e=c(n),e===f?i[e].p(n,a):(U(),v(i[f],1,1,()=>{i[f]=null}),j(),l=i[e],l?l.p(n,a):(l=i[e]=o[e](n),l.c()),p(l,1),l.m(t.parentNode,t))},i(n){s||(p(l),s=!0)},o(n){v(l),s=!1},d(n){i[e].d(n),n&&_(t)}}}function He(r,e,l){let{$$slots:t={},$$scope:s}=e,{stream:o}=e,{style:i=""}=e,{loading:c=!0}=e,{error:n=""}=e,{videoSource:a=void 0}=e;function f(u){z[u?"unshift":"push"](()=>{a=u,l(0,a),l(4,o),l(2,c)})}return r.$$set=u=>{"stream"in u&&l(4,o=u.stream),"style"in u&&l(1,i=u.style),"loading"in u&&l(2,c=u.loading),"error"in u&&l(3,n=u.error),"videoSource"in u&&l(0,a=u.videoSource),"$$scope"in u&&l(5,s=u.$$scope)},r.$$.update=()=>{r.$$.dirty&21&&o&&!c&&a&&a.paused&&(l(0,a.srcObject=o,a),a.play())},[a,i,c,n,o,s,t,f]}class ue extends L{constructor(e){super(),N(this,e,He,Ne,H,{stream:4,style:1,loading:2,error:3,videoSource:0})}}function Ue(r){let e,l,t,s;function o(c){r[10](c)}let i={error:r[14],loading:r[12],stream:r[13]};return r[1]!==void 0&&(i.videoSource=r[1]),e=new ue({props:i}),z.push(()=>pe(e,"videoSource",o)),{c(){l=w("div"),T(e.$$.fragment),this.h()},l(c){l=y(c,"DIV",{style:!0});var n=I(l);O(e.$$.fragment,n),this.h()},h(){R(l,"display","contents"),R(l,"--corner-radius","1rem")},m(c,n){g(c,l,n),M(e,l,null),s=!0},p(c,n){const a={};n&16384&&(a.error=c[14]),n&4096&&(a.loading=c[12]),n&8192&&(a.stream=c[13]),!t&&n&2&&(t=!0,a.videoSource=c[1],ge(()=>t=!1)),e.$set(a)},i(c){s||(p(e.$$.fragment,c),s=!0)},o(c){v(e.$$.fragment,c),s=!1},d(c){c&&_(l),B(e,c)}}}function je(r){let e,l;return e=new Ce({}),{c(){T(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){M(e,t,s),l=!0},p:P,i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){v(e.$$.fragment,t),l=!1},d(t){B(e,t)}}}function Ge(r){let e,l,t,s;const o=[je,Ue],i=[];function c(n,a){return n[0]?0:1}return e=c(r),l=i[e]=o[e](r),{c(){l.c(),t=G()},l(n){l.l(n),t=G()},m(n,a){i[e].m(n,a),g(n,t,a),s=!0},p(n,a){let f=e;e=c(n),e===f?i[e].p(n,a):(U(),v(i[f],1,1,()=>{i[f]=null}),j(),l=i[e],l?l.p(n,a):(l=i[e]=o[e](n),l.c()),p(l,1),l.m(t.parentNode,t))},i(n){s||(p(l),s=!0)},o(n){v(l),s=!1},d(n){i[e].d(n),n&&_(t)}}}function Re(r){let e,l,t;return l=new ue({props:{loading:r[12],stream:r[13]}}),{c(){e=w("div"),T(l.$$.fragment),this.h()},l(s){e=y(s,"DIV",{slot:!0});var o=I(e);O(l.$$.fragment,o),o.forEach(_),this.h()},h(){$(e,"slot","background")},m(s,o){g(s,e,o),M(l,e,null),t=!0},p(s,o){const i={};o&4096&&(i.loading=s[12]),o&8192&&(i.stream=s[13]),l.$set(i)},i(s){t||(p(l.$$.fragment,s),t=!0)},o(s){v(l.$$.fragment,s),t=!1},d(s){s&&_(e),B(l)}}}function ne(r){let e,l;return e=new De({props:{value:r[6],options:r[2],$$slots:{default:[qe,({option:t,index:s})=>({15:t,16:s}),({option:t,index:s})=>(t?32768:0)|(s?65536:0)]},$$scope:{ctx:r}}}),{c(){T(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){M(e,t,s),l=!0},p(t,s){const o={};s&4&&(o.options=t[2]),s&229376&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){v(e.$$.fragment,t),l=!1},d(t){B(e,t)}}}function qe(r){let e=(r[15].label||"Camera "+(r[16]+1))+"",l;return{c(){l=V(e)},l(t){l=C(t,e)},m(t,s){g(t,l,s)},p(t,s){s&98304&&e!==(e=(t[15].label||"Camera "+(t[16]+1))+"")&&ae(l,e)},d(t){t&&_(l)}}}function Ae(r){var s;let e,l,t=!r[0]&&((s=r[2])==null?void 0:s.length)>1&&ne(r);return{c(){e=w("div"),t&&t.c(),this.h()},l(o){e=y(o,"DIV",{slot:!0});var i=I(e);t&&t.l(i),i.forEach(_),this.h()},h(){$(e,"slot","options")},m(o,i){g(o,e,i),t&&t.m(e,null),l=!0},p(o,i){var c;!o[0]&&((c=o[2])==null?void 0:c.length)>1?t?(t.p(o,i),i&5&&p(t,1)):(t=ne(o),t.c(),p(t,1),t.m(e,null)):t&&(U(),v(t,1,1,()=>{t=null}),j())},i(o){l||(p(t),l=!0)},o(o){v(t),l=!1},d(o){o&&_(e),t&&t.d()}}}function re(r){let e,l,t,s;return e=new Z({props:{secondary:!0,icon:ve,$$slots:{default:[Fe]},$$scope:{ctx:r}}}),e.$on("click",r[7]),t=new Z({props:{loading:r[4],icon:be,$$slots:{default:[Je]},$$scope:{ctx:r}}}),t.$on("click",r[8]),{c(){T(e.$$.fragment),l=S(),T(t.$$.fragment)},l(o){O(e.$$.fragment,o),l=D(o),O(t.$$.fragment,o)},m(o,i){M(e,o,i),g(o,l,i),M(t,o,i),s=!0},p(o,i){const c={};i&131072&&(c.$$scope={dirty:i,ctx:o}),e.$set(c);const n={};i&16&&(n.loading=o[4]),i&131072&&(n.$$scope={dirty:i,ctx:o}),t.$set(n)},i(o){s||(p(e.$$.fragment,o),p(t.$$.fragment,o),s=!0)},o(o){v(e.$$.fragment,o),v(t.$$.fragment,o),s=!1},d(o){B(e,o),o&&_(l),B(t,o)}}}function Fe(r){let e;return{c(){e=V("Read scan instructions")},l(l){e=C(l,"Read scan instructions")},m(l,t){g(l,e,t)},d(l){l&&_(e)}}}function Je(r){let e;return{c(){e=V("Capture photo of map")},l(l){e=C(l,"Capture photo of map")},m(l,t){g(l,e,t)},d(l){l&&_(e)}}}function We(r){let e,l,t=!r[0]&&re(r);return{c(){e=w("div"),t&&t.c(),this.h()},l(s){e=y(s,"DIV",{slot:!0});var o=I(e);t&&t.l(o),o.forEach(_),this.h()},h(){$(e,"slot","footer")},m(s,o){g(s,e,o),t&&t.m(e,null),l=!0},p(s,o){s[0]?t&&(U(),v(t,1,1,()=>{t=null}),j()):t?(t.p(s,o),o&1&&p(t,1)):(t=re(s),t.c(),p(t,1),t.m(e,null))},i(s){l||(p(t),l=!0)},o(s){v(t),l=!1},d(s){s&&_(e),t&&t.d()}}}function ze(r){let e,l;return e=new ke({props:{title:r[5],closeButton:r[0],$$slots:{footer:[We],options:[Ae],background:[Re],default:[Ge]},$$scope:{ctx:r}}}),e.$on("close",r[7]),{c(){T(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){M(e,t,s),l=!0},p(t,s){const o={};s&32&&(o.title=t[5]),s&1&&(o.closeButton=t[0]),s&159767&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){v(e.$$.fragment,t),l=!1},d(t){B(e,t)}}}function Xe(r){let e,l,t,s;return e=new Be({props:{$$slots:{default:[ze,({loading:o,stream:i,error:c})=>({12:o,13:i,14:c}),({loading:o,stream:i,error:c})=>(o?4096:0)|(i?8192:0)|(c?16384:0)]},$$scope:{ctx:r}}}),{c(){T(e.$$.fragment),l=S(),t=w("canvas"),this.h()},l(o){O(e.$$.fragment,o),l=D(o),t=y(o,"CANVAS",{id:!0,style:!0}),I(t).forEach(_),this.h()},h(){$(t,"id","captureCanvas"),R(t,"display","none"),R(t,"position","absolute")},m(o,i){M(e,o,i),g(o,l,i),g(o,t,i),r[11](t),s=!0},p(o,[i]){const c={};i&159799&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){s||(p(e.$$.fragment,o),s=!0)},o(o){v(e.$$.fragment,o),s=!1},d(o){B(e,o),o&&_(l),o&&_(t),r[11](null)}}}const lt=!0;function Ye(r,e,l){let t,s=!1,o,i,c=[],n,a=!1;const f=()=>l(0,s=!s);async function u(){l(4,a=!0);const b=n.getContext("2d");l(3,n.height=o.videoHeight,n),l(3,n.width=o.videoWidth,n),b&&b.drawImage(o,0,0,n.width,n.height);const E=n.toDataURL("image/png");$e.set(E),we("/scan/maptransform")}async function d(){const E={video:{facingMode:"environment"}};console.log(JSON.stringify(E));try{const q=await navigator.mediaDevices.getUserMedia(E);l(1,o.srcObject=q,o),o.play()}catch(q){console.error("Error:",q)}}ce(async()=>{await d();const b=await navigator.mediaDevices.enumerateDevices();l(2,c=b.filter(E=>E.kind=="videoinput"))});function h(b){o=b,l(1,o)}function m(b){z[b?"unshift":"push"](()=>{n=b,l(3,n)})}return r.$$.update=()=>{r.$$.dirty&1&&l(5,t=s?"Instructions":"Map Scanning")},[s,o,c,n,a,t,i,f,u,d,h,m]}class ot extends L{constructor(e){super(),N(this,e,Ye,Xe,H,{getStream:9})}get getStream(){return this.$$.ctx[9]}}export{ot as default,lt as prerender};
