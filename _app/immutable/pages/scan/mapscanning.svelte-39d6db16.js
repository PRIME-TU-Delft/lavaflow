import{S as H,i as L,s as M,e as w,k as E,c as $,a as y,m as D,d as _,g as v,K as b,G as q,H as A,I as F,q as p,o as g,b as k,V as de,W as K,R as X,n as j,p as z,N as se,X as _e,F as W,t as S,h as C,j as ie,U as me,Y as he,E as N,v as pe,Z as ve,l as R,_ as G,w as T,x as O,f as U,y as B,B as P,$ as ae,a0 as ce}from"../../chunks/index-dda06473.js";import{B as Y,b as ge,c as be}from"../../chunks/Button-cb6e53d7.js";import{P as ke}from"../../chunks/Page-96bf0c79.js";import{g as we}from"../../chunks/navigation-0e6511d1.js";import{r as $e}from"../../chunks/imageStore-c03d040b.js";import"../../chunks/singletons-d1fb5791.js";import"../../chunks/index-f56ba691.js";function Z(r,e,l){const t=r.slice();return t[6]=e[l],t[8]=l,t}const ye=r=>({option:r&2}),J=r=>({option:r[6],index:r[8]});function Ie(r){let e=r[6]+"",l;return{c(){l=S(e)},l(t){l=C(t,e)},m(t,s){v(t,l,s)},p(t,s){s&2&&e!==(e=t[6]+"")&&ie(l,e)},d(t){t&&_(l)}}}function Q(r){let e,l,t,s;const o=r[3].default,n=W(o,r,r[2],J),a=n||Ie(r);return{c(){e=w("option"),a&&a.c(),l=E(),this.h()},l(i){e=$(i,"OPTION",{});var c=y(e);a&&a.l(c),l=D(c),c.forEach(_),this.h()},h(){e.__value=t=r[6],e.value=e.__value},m(i,c){v(i,e,c),a&&a.m(e,null),b(e,l),s=!0},p(i,c){n?n.p&&(!s||c&6)&&q(n,o,i,i[2],s?F(o,i[2],c,ye):A(i[2]),J):a&&a.p&&(!s||c&2)&&a.p(i,s?c:-1),(!s||c&2&&t!==(t=i[6]))&&(e.__value=t,e.value=e.__value)},i(i){s||(p(a,i),s=!0)},o(i){g(a,i),s=!1},d(i){i&&_(e),a&&a.d(i)}}}function Ve(r){let e,l,t,s,o=r[1],n=[];for(let i=0;i<o.length;i+=1)n[i]=Q(Z(r,o,i));const a=i=>g(n[i],1,1,()=>{n[i]=null});return{c(){e=w("select");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=$(i,"SELECT",{class:!0});var c=y(e);for(let f=0;f<n.length;f+=1)n[f].l(c);c.forEach(_),this.h()},h(){k(e,"class","svelte-mtu0p6"),r[0]===void 0&&de(()=>r[5].call(e))},m(i,c){v(i,e,c);for(let f=0;f<n.length;f+=1)n[f].m(e,null);K(e,r[0]),l=!0,t||(s=[X(e,"change",r[5]),X(e,"change",r[4])],t=!0)},p(i,[c]){if(c&6){o=i[1];let f;for(f=0;f<o.length;f+=1){const u=Z(i,o,f);n[f]?(n[f].p(u,c),p(n[f],1)):(n[f]=Q(u),n[f].c(),p(n[f],1),n[f].m(e,null))}for(j(),f=o.length;f<n.length;f+=1)a(f);z()}c&3&&K(e,i[0])},i(i){if(!l){for(let c=0;c<o.length;c+=1)p(n[c]);l=!0}},o(i){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)g(n[c]);l=!1},d(i){i&&_(e),se(n,i),t=!1,_e(s)}}}function Ee(r,e,l){let{$$slots:t={},$$scope:s}=e,{value:o}=e,{options:n}=e;function a(c){me.call(this,r,c)}function i(){o=he(this),l(0,o),l(1,n)}return r.$$set=c=>{"value"in c&&l(0,o=c.value),"options"in c&&l(1,n=c.options),"$$scope"in c&&l(2,s=c.$$scope)},[o,n,s,t,a,i]}class De extends H{constructor(e){super(),L(this,e,Ee,Ve,M,{value:0,options:1})}}const x=[{title:"3 marker visible",description:"To recognize the level curves, we need to have the 3 markers fully visible"},{title:"Curves should have sufficient margin",description:"The curves should have sufficient margin between them, overlapping or close lines are hard to interpret"},{title:"Markers shoud not be too far or close",description:"Scanning works best from a distance of 0.5 meters from the piece of paper. For best the best result try to scan the paper as close to parallel as possible"},{title:"Drawing with dark pen",description:"To recognise your level curves, we prefer a dark and thic pen. Using a lighter pen will result in inaccurate results"},{title:"Propper lighting",description:"Level curves are hard to distinguish from background in a low light setting. Try to use natual daylight or a propper ceiling light for best results."},{title:"Close your curves",description:"To avoid false readings, close your curves as much as possible"},{title:"Only one paper should be visible",description:"To avoid false readings, only one paper should be visible at a time"}];function ee(r,e,l){const t=r.slice();return t[0]=e[l],t}function te(r){let e,l,t=r[0].title+"",s,o,n,a=r[0].description+"",i,c;return{c(){e=w("div"),l=w("div"),s=S(t),o=E(),n=w("div"),i=S(a),c=E(),this.h()},l(f){e=$(f,"DIV",{class:!0});var u=y(e);l=$(u,"DIV",{class:!0});var d=y(l);s=C(d,t),d.forEach(_),o=D(u),n=$(u,"DIV",{class:!0});var m=y(n);i=C(m,a),m.forEach(_),c=D(u),u.forEach(_),this.h()},h(){k(l,"class","title svelte-1fkle3y"),k(n,"class","description"),k(e,"class","instruction svelte-1fkle3y")},m(f,u){v(f,e,u),b(e,l),b(l,s),b(e,o),b(e,n),b(n,i),b(e,c)},p:N,d(f){f&&_(e)}}}function Se(r){let e,l,t,s,o,n,a,i,c,f=x,u=[];for(let d=0;d<f.length;d+=1)u[d]=te(ee(r,f,d));return{c(){e=w("div"),l=w("h2"),t=S("Good example of contour map"),s=E(),o=w("div"),n=E(),a=w("h2"),i=S("Instructions"),c=E();for(let d=0;d<u.length;d+=1)u[d].c();this.h()},l(d){e=$(d,"DIV",{class:!0});var m=y(e);l=$(m,"H2",{});var h=y(l);t=C(h,"Good example of contour map"),h.forEach(_),s=D(m),o=$(m,"DIV",{class:!0}),y(o).forEach(_),n=D(m),a=$(m,"H2",{});var V=y(a);i=C(V,"Instructions"),V.forEach(_),c=D(m);for(let I=0;I<u.length;I+=1)u[I].l(m);m.forEach(_),this.h()},h(){k(o,"class","example svelte-1fkle3y"),k(e,"class","instructions svelte-1fkle3y")},m(d,m){v(d,e,m),b(e,l),b(l,t),b(e,s),b(e,o),b(e,n),b(e,a),b(a,i),b(e,c);for(let h=0;h<u.length;h+=1)u[h].m(e,null)},p(d,[m]){if(m&0){f=x;let h;for(h=0;h<f.length;h+=1){const V=ee(d,f,h);u[h]?u[h].p(V,m):(u[h]=te(V),u[h].c(),u[h].m(e,null))}for(;h<u.length;h+=1)u[h].d(1);u.length=f.length}},i:N,o:N,d(d){d&&_(e),se(u,d)}}}class Ce extends H{constructor(e){super(),L(this,e,null,Se,M,{})}}const Te=r=>({loading:r&2,stream:r&1,error:r&4,cameraOptions:r&8}),le=r=>({loading:r[1],stream:r[0],error:r[2],cameraOptions:r[3]});function Oe(r){let e;const l=r[6].default,t=W(l,r,r[5],le);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,o){t&&t.m(s,o),e=!0},p(s,[o]){t&&t.p&&(!e||o&47)&&q(t,l,s,s[5],e?F(l,s[5],o,Te):A(s[5]),le)},i(s){e||(p(t,s),e=!0)},o(s){g(t,s),e=!1},d(s){t&&t.d(s)}}}function Be(r,e,l){let{$$slots:t={},$$scope:s}=e,{deviceId:o=""}=e,n,a=!0,i,c=[];const f=async()=>{l(1,a=!0),n&&n.getTracks().forEach(d=>d.stop());const u=o?{deviceId:{exact:o}}:{facingMode:"environment"};try{l(0,n=await navigator.mediaDevices.getUserMedia({video:u})),l(1,a=!1),l(2,i="")}catch(d){l(2,i=""+d)}};return pe(async()=>{await f();const u=await navigator.mediaDevices.enumerateDevices();l(3,c=u.filter(d=>d.kind=="videoinput"))}),ve(()=>{!n||n.getTracks().forEach(u=>u.stop())}),r.$$set=u=>{"deviceId"in u&&l(4,o=u.deviceId),"$$scope"in u&&l(5,s=u.$$scope)},r.$$.update=()=>{r.$$.dirty&16&&o&&f()},[n,a,i,c,o,s,t]}class Pe extends H{constructor(e){super(),L(this,e,Be,Oe,M,{deviceId:4})}}function Ne(r){let e;return{c(){e=w("video"),this.h()},l(l){e=$(l,"VIDEO",{style:!0,preload:!0,type:!0,class:!0}),y(e).forEach(_),this.h()},h(){k(e,"style",r[1]),e.loop=!0,e.playsInline=!0,e.autoplay=!1,e.controls=!1,k(e,"preload","auto"),k(e,"type","video/mp4"),k(e,"class","svelte-wvnab8")},m(l,t){v(l,e,t),r[7](e)},p(l,t){t&2&&k(e,"style",l[1])},i:N,o:N,d(l){l&&_(e),r[7](null)}}}function He(r){let e,l,t,s,o,n=r[3]&&r[3].includes("Permission denied"),a,i,c=n&&oe();const f=r[6].default,u=W(f,r,r[5],null);return{c(){e=w("div"),l=w("div"),t=w("h1"),s=S("Loading video..."),o=E(),c&&c.c(),a=E(),u&&u.c(),this.h()},l(d){e=$(d,"DIV",{class:!0});var m=y(e);l=$(m,"DIV",{class:!0});var h=y(l);t=$(h,"H1",{class:!0});var V=y(t);s=C(V,"Loading video..."),V.forEach(_),o=D(h),c&&c.l(h),h.forEach(_),m.forEach(_),a=D(d),u&&u.l(d),this.h()},h(){k(t,"class","svelte-wvnab8"),k(l,"class","svelte-wvnab8"),k(e,"class","loadingVideo svelte-wvnab8")},m(d,m){v(d,e,m),b(e,l),b(l,t),b(t,s),b(l,o),c&&c.m(l,null),v(d,a,m),u&&u.m(d,m),i=!0},p(d,m){m&8&&(n=d[3]&&d[3].includes("Permission denied")),n?c||(c=oe(),c.c(),c.m(l,null)):c&&(c.d(1),c=null),u&&u.p&&(!i||m&32)&&q(u,f,d,d[5],i?F(f,d[5],m,null):A(d[5]),null)},i(d){i||(p(u,d),i=!0)},o(d){g(u,d),i=!1},d(d){d&&_(e),c&&c.d(),d&&_(a),u&&u.d(d)}}}function oe(r){let e;return{c(){e=S("The browser is unable to access the camera, try re-enabling the camera and reload")},l(l){e=C(l,"The browser is unable to access the camera, try re-enabling the camera and reload")},m(l,t){v(l,e,t)},d(l){l&&_(e)}}}function Le(r){let e,l,t,s;const o=[He,Ne],n=[];function a(i,c){return i[2]?0:1}return e=a(r),l=n[e]=o[e](r),{c(){l.c(),t=R()},l(i){l.l(i),t=R()},m(i,c){n[e].m(i,c),v(i,t,c),s=!0},p(i,[c]){let f=e;e=a(i),e===f?n[e].p(i,c):(j(),g(n[f],1,1,()=>{n[f]=null}),z(),l=n[e],l?l.p(i,c):(l=n[e]=o[e](i),l.c()),p(l,1),l.m(t.parentNode,t))},i(i){s||(p(l),s=!0)},o(i){g(l),s=!1},d(i){n[e].d(i),i&&_(t)}}}function Me(r,e,l){let{$$slots:t={},$$scope:s}=e,{stream:o}=e,{style:n=""}=e,{loading:a=!0}=e,{error:i=""}=e,{videoSource:c=void 0}=e;function f(u){G[u?"unshift":"push"](()=>{c=u,l(0,c),l(4,o),l(2,a)})}return r.$$set=u=>{"stream"in u&&l(4,o=u.stream),"style"in u&&l(1,n=u.style),"loading"in u&&l(2,a=u.loading),"error"in u&&l(3,i=u.error),"videoSource"in u&&l(0,c=u.videoSource),"$$scope"in u&&l(5,s=u.$$scope)},r.$$.update=()=>{r.$$.dirty&21&&o&&!a&&c&&c.paused&&(l(0,c.srcObject=o,c),c.play())},[c,n,a,i,o,s,t,f]}class ue extends H{constructor(e){super(),L(this,e,Me,Le,M,{stream:4,style:1,loading:2,error:3,videoSource:0})}}function je(r){let e,l,t,s;function o(a){r[11](a)}let n={error:r[15],loading:r[13],stream:r[14]};return r[1]!==void 0&&(n.videoSource=r[1]),e=new ue({props:n}),G.push(()=>ce(e,"videoSource",o)),{c(){l=w("div"),T(e.$$.fragment),this.h()},l(a){l=$(a,"DIV",{style:!0});var i=y(l);O(e.$$.fragment,i),this.h()},h(){U(l,"display","contents"),U(l,"--corner-radius","1rem")},m(a,i){v(a,l,i),B(e,l,null),s=!0},p(a,i){const c={};i&32768&&(c.error=a[15]),i&8192&&(c.loading=a[13]),i&16384&&(c.stream=a[14]),!t&&i&2&&(t=!0,c.videoSource=a[1],ae(()=>t=!1)),e.$set(c)},i(a){s||(p(e.$$.fragment,a),s=!0)},o(a){g(e.$$.fragment,a),s=!1},d(a){a&&_(l),P(e,a)}}}function ze(r){let e,l;return e=new Ce({}),{c(){T(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){B(e,t,s),l=!0},p:N,i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){g(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Re(r){let e,l,t,s;const o=[ze,je],n=[];function a(i,c){return i[0]?0:1}return e=a(r),l=n[e]=o[e](r),{c(){l.c(),t=R()},l(i){l.l(i),t=R()},m(i,c){n[e].m(i,c),v(i,t,c),s=!0},p(i,c){let f=e;e=a(i),e===f?n[e].p(i,c):(j(),g(n[f],1,1,()=>{n[f]=null}),z(),l=n[e],l?l.p(i,c):(l=n[e]=o[e](i),l.c()),p(l,1),l.m(t.parentNode,t))},i(i){s||(p(l),s=!0)},o(i){g(l),s=!1},d(i){n[e].d(i),i&&_(t)}}}function Ue(r){let e,l,t;return l=new ue({props:{loading:r[13],stream:r[14]}}),{c(){e=w("div"),T(l.$$.fragment),this.h()},l(s){e=$(s,"DIV",{slot:!0});var o=y(e);O(l.$$.fragment,o),o.forEach(_),this.h()},h(){k(e,"slot","background")},m(s,o){v(s,e,o),B(l,e,null),t=!0},p(s,o){const n={};o&8192&&(n.loading=s[13]),o&16384&&(n.stream=s[14]),l.$set(n)},i(s){t||(p(l.$$.fragment,s),t=!0)},o(s){g(l.$$.fragment,s),t=!1},d(s){s&&_(e),P(l)}}}function ne(r){let e,l,t;function s(n){r[10](n)}let o={options:r[16],$$slots:{default:[Ge,({option:n,index:a})=>({17:n,18:a}),({option:n,index:a})=>(n?131072:0)|(a?262144:0)]},$$scope:{ctx:r}};return r[2]!==void 0&&(o.value=r[2]),e=new De({props:o}),G.push(()=>ce(e,"value",s)),e.$on("change",r[9]),{c(){T(e.$$.fragment)},l(n){O(e.$$.fragment,n)},m(n,a){B(e,n,a),t=!0},p(n,a){const i={};a&65536&&(i.options=n[16]),a&917504&&(i.$$scope={dirty:a,ctx:n}),!l&&a&4&&(l=!0,i.value=n[2],ae(()=>l=!1)),e.$set(i)},i(n){t||(p(e.$$.fragment,n),t=!0)},o(n){g(e.$$.fragment,n),t=!1},d(n){P(e,n)}}}function Ge(r){let e=(r[17].label||"Camera "+(r[18]+1))+"",l;return{c(){l=S(e)},l(t){l=C(t,e)},m(t,s){v(t,l,s)},p(t,s){s&393216&&e!==(e=(t[17].label||"Camera "+(t[18]+1))+"")&&ie(l,e)},d(t){t&&_(l)}}}function qe(r){var s;let e,l,t=!r[0]&&((s=r[16])==null?void 0:s.length)>1&&ne(r);return{c(){e=w("div"),t&&t.c(),this.h()},l(o){e=$(o,"DIV",{slot:!0});var n=y(e);t&&t.l(n),n.forEach(_),this.h()},h(){k(e,"slot","options")},m(o,n){v(o,e,n),t&&t.m(e,null),l=!0},p(o,n){var a;!o[0]&&((a=o[16])==null?void 0:a.length)>1?t?(t.p(o,n),n&65537&&p(t,1)):(t=ne(o),t.c(),p(t,1),t.m(e,null)):t&&(j(),g(t,1,1,()=>{t=null}),z())},i(o){l||(p(t),l=!0)},o(o){g(t),l=!1},d(o){o&&_(e),t&&t.d()}}}function re(r){let e,l,t,s;return e=new Y({props:{secondary:!0,icon:ge,$$slots:{default:[Ae]},$$scope:{ctx:r}}}),e.$on("click",r[7]),t=new Y({props:{loading:r[4],icon:be,$$slots:{default:[Fe]},$$scope:{ctx:r}}}),t.$on("click",r[8]),{c(){T(e.$$.fragment),l=E(),T(t.$$.fragment)},l(o){O(e.$$.fragment,o),l=D(o),O(t.$$.fragment,o)},m(o,n){B(e,o,n),v(o,l,n),B(t,o,n),s=!0},p(o,n){const a={};n&524288&&(a.$$scope={dirty:n,ctx:o}),e.$set(a);const i={};n&16&&(i.loading=o[4]),n&524288&&(i.$$scope={dirty:n,ctx:o}),t.$set(i)},i(o){s||(p(e.$$.fragment,o),p(t.$$.fragment,o),s=!0)},o(o){g(e.$$.fragment,o),g(t.$$.fragment,o),s=!1},d(o){P(e,o),o&&_(l),P(t,o)}}}function Ae(r){let e;return{c(){e=S("Read scan instructions")},l(l){e=C(l,"Read scan instructions")},m(l,t){v(l,e,t)},d(l){l&&_(e)}}}function Fe(r){let e;return{c(){e=S("Capture photo of map")},l(l){e=C(l,"Capture photo of map")},m(l,t){v(l,e,t)},d(l){l&&_(e)}}}function We(r){let e,l,t=!r[0]&&re(r);return{c(){e=w("div"),t&&t.c(),this.h()},l(s){e=$(s,"DIV",{slot:!0});var o=y(e);t&&t.l(o),o.forEach(_),this.h()},h(){k(e,"slot","footer")},m(s,o){v(s,e,o),t&&t.m(e,null),l=!0},p(s,o){s[0]?t&&(j(),g(t,1,1,()=>{t=null}),z()):t?(t.p(s,o),o&1&&p(t,1)):(t=re(s),t.c(),p(t,1),t.m(e,null))},i(s){l||(p(t),l=!0)},o(s){g(t),l=!1},d(s){s&&_(e),t&&t.d()}}}function Ke(r){let e,l;return e=new ke({props:{fullscreen:!r[13],title:r[6],closeButton:r[0],$$slots:{footer:[We],options:[qe],background:[Ue],default:[Re]},$$scope:{ctx:r}}}),e.$on("close",r[7]),{c(){T(e.$$.fragment)},l(t){O(e.$$.fragment,t)},m(t,s){B(e,t,s),l=!0},p(t,s){const o={};s&8192&&(o.fullscreen=!t[13]),s&64&&(o.title=t[6]),s&1&&(o.closeButton=t[0]),s&647191&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){g(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Xe(r){let e,l,t,s;return e=new Pe({props:{deviceId:r[5],$$slots:{default:[Ke,({loading:o,stream:n,error:a,cameraOptions:i})=>({13:o,14:n,15:a,16:i}),({loading:o,stream:n,error:a,cameraOptions:i})=>(o?8192:0)|(n?16384:0)|(a?32768:0)|(i?65536:0)]},$$scope:{ctx:r}}}),{c(){T(e.$$.fragment),l=E(),t=w("canvas"),this.h()},l(o){O(e.$$.fragment,o),l=D(o),t=$(o,"CANVAS",{id:!0,style:!0}),y(t).forEach(_),this.h()},h(){k(t,"id","captureCanvas"),U(t,"display","none"),U(t,"position","absolute")},m(o,n){B(e,o,n),v(o,l,n),v(o,t,n),r[12](t),s=!0},p(o,[n]){const a={};n&32&&(a.deviceId=o[5]),n&647255&&(a.$$scope={dirty:n,ctx:o}),e.$set(a)},i(o){s||(p(e.$$.fragment,o),s=!0)},o(o){g(e.$$.fragment,o),s=!1},d(o){P(e,o),o&&_(l),o&&_(t),r[12](null)}}}const ot=!0;function Ye(r,e,l){let t,s=!1,o,n,a,i=!1,c;const f=()=>l(0,s=!s);async function u(){l(4,i=!0);const I=a.getContext("2d");l(3,a.height=o.videoHeight,a),l(3,a.width=o.videoWidth,a),I&&I.drawImage(o,0,0,a.width,a.height);const fe=a.toDataURL("image/png");$e.set(fe),we("/scan/maptransform")}function d(){l(5,c=n.deviceId)}function m(I){n=I,l(2,n)}function h(I){o=I,l(1,o)}function V(I){G[I?"unshift":"push"](()=>{a=I,l(3,a)})}return r.$$.update=()=>{r.$$.dirty&1&&l(6,t=s?"Instructions":"Capture the image")},[s,o,n,a,i,c,t,f,u,d,m,h,V]}class nt extends H{constructor(e){super(),L(this,e,Ye,Xe,M,{})}}export{nt as default,ot as prerender};
