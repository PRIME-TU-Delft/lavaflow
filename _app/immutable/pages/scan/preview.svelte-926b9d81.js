import{S as E,i as C,s as L,w as h,x as d,y as p,E as j,q as u,o as m,B as $,O as P,v as R,e as w,c as k,a as y,d as f,b as H,_ as S,g as _,$ as z,k as M,l as V,m as q,n as A,p as U,t as D,h as N,J}from"../../chunks/index-6ef4ca18.js";import{B as T}from"../../chunks/Button-4b8f6361.js";import{I as O}from"../../chunks/Image-cb38b7e4.js";import{N as F}from"../../chunks/NavigationButton-bb539df9.js";import{P as G,p as K}from"../../chunks/imageStore-794ecfdf.js";import{P as Q}from"../../chunks/P5-da498645.js";import{c as X}from"../../chunks/contourLineStore-51078f00.js";import{i as Y,O as Z,M as x,g as ee}from"../../chunks/gltfStore-df10cddd.js";import{g as W}from"../../chunks/navigation-0e6511d1.js";import"../../chunks/index-381b1206.js";import"../../chunks/preload-helper-60cab3ee.js";import"../../chunks/draggable-84c82f59.js";import"../../chunks/singletons-d1fb5791.js";function te(a){let e,r;return e=new Q({props:{sketch:a[0]}}),{c(){h(e.$$.fragment)},l(t){d(e.$$.fragment,t)},m(t,o){p(e,t,o),r=!0},p:j,i(t){r||(u(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){$(e,t)}}}function re(a,e,r){let{foregroundWidth:t}=e,{foregroundHeight:o}=e,{curves:n}=e,{hierarchy:s}=e;const c=i=>{i.setup=()=>{i.createCanvas(t,o),i.fill(i.color(255,255,255)),i.stroke(i.color(255,255,255)),n.forEach((v,g)=>{i.text(`${g} (${s[g]})`,v[0][0],v[0][1]);for(let l of v){let b=l[0],B=l[1];i.point(b,B)}})}};return a.$$set=i=>{"foregroundWidth"in i&&r(1,t=i.foregroundWidth),"foregroundHeight"in i&&r(2,o=i.foregroundHeight),"curves"in i&&r(3,n=i.curves),"hierarchy"in i&&r(4,s=i.hierarchy)},[c,t,o,n,s]}class ne extends E{constructor(e){super(),C(this,e,re,te,L,{foregroundWidth:1,foregroundHeight:2,curves:3,hierarchy:4})}}function I(a){let e,r,t,o;return r=new ne({props:{curves:a[3].curves,hierarchy:a[3].hierarchy,foregroundHeight:a[1],foregroundWidth:a[0]}}),{c(){e=w("div"),h(r.$$.fragment),this.h()},l(n){e=k(n,"DIV",{class:!0});var s=y(e);d(r.$$.fragment,s),s.forEach(f),this.h()},h(){H(e,"class","sketch svelte-dbjsc6"),S(()=>a[6].call(e))},m(n,s){_(n,e,s),p(r,e,null),t=z(e,a[6].bind(e)),o=!0},p(n,s){const c={};s&8&&(c.curves=n[3].curves),s&8&&(c.hierarchy=n[3].hierarchy),s&2&&(c.foregroundHeight=n[1]),s&1&&(c.foregroundWidth=n[0]),r.$set(c)},i(n){o||(u(r.$$.fragment,n),o=!0)},o(n){m(r.$$.fragment,n),o=!1},d(n){n&&f(e),$(r),t()}}}function oe(a){let e,r,t,o;e=new O({props:{src:a[4],alt:"foreground"}});let n=a[3].curves&&a[3].hierarchy&&I(a);return{c(){h(e.$$.fragment),r=M(),n&&n.c(),t=V()},l(s){d(e.$$.fragment,s),r=q(s),n&&n.l(s),t=V()},m(s,c){p(e,s,c),_(s,r,c),n&&n.m(s,c),_(s,t,c),o=!0},p(s,c){const i={};c&16&&(i.src=s[4]),e.$set(i),s[3].curves&&s[3].hierarchy?n?(n.p(s,c),c&8&&u(n,1)):(n=I(s),n.c(),u(n,1),n.m(t.parentNode,t)):n&&(A(),m(n,1,1,()=>{n=null}),U())},i(s){o||(u(e.$$.fragment,s),u(n),o=!0)},o(s){m(e.$$.fragment,s),m(n),o=!1},d(s){$(e,s),s&&f(r),n&&n.d(s),s&&f(t)}}}function se(a){let e;return{c(){e=D("Redraw borders")},l(r){e=N(r,"Redraw borders")},m(r,t){_(r,e,t)},d(r){r&&f(e)}}}function ae(a){let e,r;return e=new F({props:{slot:"headerButton",to:"/scan/maptransform",back:!0,$$slots:{default:[se]},$$scope:{ctx:a}}}),{c(){h(e.$$.fragment)},l(t){d(e.$$.fragment,t)},m(t,o){p(e,t,o),r=!0},p(t,o){const n={};o&128&&(n.$$scope={dirty:o,ctx:t}),e.$set(n)},i(t){r||(u(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){$(e,t)}}}function ie(a){let e,r,t;return r=new O({props:{src:a[4],alt:"background"}}),{c(){e=w("div"),h(r.$$.fragment),this.h()},l(o){e=k(o,"DIV",{slot:!0});var n=y(e);d(r.$$.fragment,n),n.forEach(f),this.h()},h(){H(e,"slot","background")},m(o,n){_(o,e,n),p(r,e,null),t=!0},p(o,n){const s={};n&16&&(s.src=o[4]),r.$set(s)},i(o){t||(u(r.$$.fragment,o),t=!0)},o(o){m(r.$$.fragment,o),t=!1},d(o){o&&f(e),$(r)}}}function ce(a){let e,r;return{c(){e=w("span"),r=D("Visualise")},l(t){e=k(t,"SPAN",{});var o=y(e);r=N(o,"Visualise"),o.forEach(f)},m(t,o){_(t,e,o),J(e,r)},p:j,d(t){t&&f(e)}}}function le(a){let e,r,t;return r=new T({props:{loading:!a[2],$$slots:{default:[ce]},$$scope:{ctx:a}}}),r.$on("click",a[5]),{c(){e=w("div"),h(r.$$.fragment),this.h()},l(o){e=k(o,"DIV",{slot:!0});var n=y(e);d(r.$$.fragment,n),n.forEach(f),this.h()},h(){H(e,"slot","footer")},m(o,n){_(o,e,n),p(r,e,null),t=!0},p(o,n){const s={};n&4&&(s.loading=!o[2]),n&128&&(s.$$scope={dirty:n,ctx:o}),r.$set(s)},i(o){t||(u(r.$$.fragment,o),t=!0)},o(o){m(r.$$.fragment,o),t=!1},d(o){o&&f(e),$(r)}}}function fe(a){let e,r;return e=new G({props:{title:"image transformation",$$slots:{footer:[le],background:[ie],headerButton:[ae],default:[oe]},$$scope:{ctx:a}}}),{c(){h(e.$$.fragment)},l(t){d(e.$$.fragment,t)},m(t,o){p(e,t,o),r=!0},p(t,[o]){const n={};o&159&&(n.$$scope={dirty:o,ctx:t}),e.$set(n)},i(t){r||(u(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){$(e,t)}}}function ue(a,e,r){let t,o;P(a,X,g=>r(3,t=g)),P(a,K,g=>r(4,o=g));let n,s,c=!1;function i(){W("/demo")}R(async()=>{if(!o||!t.curves||!t.hierarchy)return W("/scan/mapscanning");await Y();const g=new Z({pixels_per_curve:t.curves,parent_relations:t.hierarchy}),l=new x;l.base(g),l.set_basic_parameters(30,30,.2),l.set_svc_parameters(15),l.set_catmull_clark_parameters(1),l.set_lava_path_parameters(30,.1),l.apply_smooth_to_layer(0,.7,4,10,!1),l.increase_altitude_for_mountain_tops(.3,!1),l.apply_smooth_to_all(.3,6,10,!1);const b=l.build().to_js(),B=new Blob([b.gltf],{type:"application/json"});ee.set(URL.createObjectURL(B)),console.log(b),r(2,c=!0)});function v(){n=this.clientWidth,s=this.clientHeight,r(0,n),r(1,s)}return[n,s,c,t,o,i,v]}class He extends E{constructor(e){super(),C(this,e,ue,fe,L,{})}}export{He as default};
