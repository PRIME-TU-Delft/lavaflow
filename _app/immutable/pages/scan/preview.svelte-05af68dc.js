import{S as E,i as D,s as N,w as d,x as _,y as p,E as S,q as l,o as g,B as $,P as H,v as R,e as k,c as w,a as y,d as c,b as P,_ as j,g as h,$ as A,k as J,l as W,m as M,n as F,p as G,t as z,h as C,J as K}from"../../chunks/index-611a0696.js";import{B as O}from"../../chunks/Button-03c16f56.js";import{P as Q,p as T}from"../../chunks/imageStore-cc86c690.js";import{I as L}from"../../chunks/Image-fbaa1ca9.js";import{N as U}from"../../chunks/NavigationButton-ac014897.js";import{c as X}from"../../chunks/contourLineStore-a78aef70.js";import{g as B}from"../../chunks/navigation-0e6511d1.js";import{g as I}from"../../chunks/gltfStore-a6ba4269.js";import{P as Y}from"../../chunks/P5-a506d8d1.js";import"../../chunks/hardCoded-e059130f.js";import"../../chunks/index-630b1f58.js";import"../../chunks/singletons-d1fb5791.js";import"../../chunks/draggable-84c82f59.js";import"../../chunks/preload-helper-60cab3ee.js";function Z(a){let e,r;return e=new Y({props:{sketch:a[0]}}),{c(){d(e.$$.fragment)},l(t){_(e.$$.fragment,t)},m(t,o){p(e,t,o),r=!0},p:S,i(t){r||(l(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){$(e,t)}}}function x(a,e,r){let{foregroundWidth:t}=e,{foregroundHeight:o}=e,{curves:n}=e,{hierarchy:i}=e;const u=s=>{s.setup=()=>{s.createCanvas(t,o),s.fill(s.color(255,255,255)),s.stroke(s.color(255,255,255)),n.forEach((f,m)=>{s.text(`${m} (${i[m]})`,f[0][0],f[0][1]);for(let v of f){let b=v[0],q=v[1];s.point(b,q)}})}};return a.$$set=s=>{"foregroundWidth"in s&&r(1,t=s.foregroundWidth),"foregroundHeight"in s&&r(2,o=s.foregroundHeight),"curves"in s&&r(3,n=s.curves),"hierarchy"in s&&r(4,i=s.hierarchy)},[u,t,o,n,i]}class ee extends E{constructor(e){super(),D(this,e,x,Z,N,{foregroundWidth:1,foregroundHeight:2,curves:3,hierarchy:4})}}function V(a){let e,r,t,o;return r=new ee({props:{curves:a[3].curves,hierarchy:a[3].hierarchy,foregroundHeight:a[1],foregroundWidth:a[0]}}),{c(){e=k("div"),d(r.$$.fragment),this.h()},l(n){e=w(n,"DIV",{class:!0});var i=y(e);_(r.$$.fragment,i),i.forEach(c),this.h()},h(){P(e,"class","sketch svelte-dbjsc6"),j(()=>a[6].call(e))},m(n,i){h(n,e,i),p(r,e,null),t=A(e,a[6].bind(e)),o=!0},p(n,i){const u={};i&8&&(u.curves=n[3].curves),i&8&&(u.hierarchy=n[3].hierarchy),i&2&&(u.foregroundHeight=n[1]),i&1&&(u.foregroundWidth=n[0]),r.$set(u)},i(n){o||(l(r.$$.fragment,n),o=!0)},o(n){g(r.$$.fragment,n),o=!1},d(n){n&&c(e),$(r),t()}}}function te(a){var i,u;let e,r,t,o;e=new L({props:{src:a[4],alt:"foreground"}});let n=((i=a[3])==null?void 0:i.curves)&&((u=a[3])==null?void 0:u.hierarchy)&&V(a);return{c(){d(e.$$.fragment),r=J(),n&&n.c(),t=W()},l(s){_(e.$$.fragment,s),r=M(s),n&&n.l(s),t=W()},m(s,f){p(e,s,f),h(s,r,f),n&&n.m(s,f),h(s,t,f),o=!0},p(s,f){var v,b;const m={};f&16&&(m.src=s[4]),e.$set(m),((v=s[3])==null?void 0:v.curves)&&((b=s[3])==null?void 0:b.hierarchy)?n?(n.p(s,f),f&8&&l(n,1)):(n=V(s),n.c(),l(n,1),n.m(t.parentNode,t)):n&&(F(),g(n,1,1,()=>{n=null}),G())},i(s){o||(l(e.$$.fragment,s),l(n),o=!0)},o(s){g(e.$$.fragment,s),g(n),o=!1},d(s){$(e,s),s&&c(r),n&&n.d(s),s&&c(t)}}}function re(a){let e;return{c(){e=z("Redraw borders")},l(r){e=C(r,"Redraw borders")},m(r,t){h(r,e,t)},d(r){r&&c(e)}}}function ne(a){let e,r;return e=new U({props:{slot:"headerButton",to:"/scan/maptransform",back:!0,$$slots:{default:[re]},$$scope:{ctx:a}}}),{c(){d(e.$$.fragment)},l(t){_(e.$$.fragment,t)},m(t,o){p(e,t,o),r=!0},p(t,o){const n={};o&128&&(n.$$scope={dirty:o,ctx:t}),e.$set(n)},i(t){r||(l(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){$(e,t)}}}function oe(a){let e,r,t;return r=new L({props:{src:a[4],alt:"background"}}),{c(){e=k("div"),d(r.$$.fragment),this.h()},l(o){e=w(o,"DIV",{slot:!0});var n=y(e);_(r.$$.fragment,n),n.forEach(c),this.h()},h(){P(e,"slot","background")},m(o,n){h(o,e,n),p(r,e,null),t=!0},p(o,n){const i={};n&16&&(i.src=o[4]),r.$set(i)},i(o){t||(l(r.$$.fragment,o),t=!0)},o(o){g(r.$$.fragment,o),t=!1},d(o){o&&c(e),$(r)}}}function se(a){let e,r;return{c(){e=k("span"),r=z("Visualise")},l(t){e=w(t,"SPAN",{});var o=y(e);r=C(o,"Visualise"),o.forEach(c)},m(t,o){h(t,e,o),K(e,r)},p:S,d(t){t&&c(e)}}}function ae(a){let e,r,t;return r=new O({props:{loading:!a[2],$$slots:{default:[se]},$$scope:{ctx:a}}}),r.$on("click",a[5]),{c(){e=k("div"),d(r.$$.fragment),this.h()},l(o){e=w(o,"DIV",{slot:!0});var n=y(e);_(r.$$.fragment,n),n.forEach(c),this.h()},h(){P(e,"slot","footer")},m(o,n){h(o,e,n),p(r,e,null),t=!0},p(o,n){const i={};n&4&&(i.loading=!o[2]),n&128&&(i.$$scope={dirty:n,ctx:o}),r.$set(i)},i(o){t||(l(r.$$.fragment,o),t=!0)},o(o){g(r.$$.fragment,o),t=!1},d(o){o&&c(e),$(r)}}}function ie(a){let e,r;return e=new Q({props:{title:"image transformation",$$slots:{footer:[ae],background:[oe],headerButton:[ne],default:[te]},$$scope:{ctx:a}}}),{c(){d(e.$$.fragment)},l(t){_(e.$$.fragment,t)},m(t,o){p(e,t,o),r=!0},p(t,[o]){const n={};o&159&&(n.$$scope={dirty:o,ctx:t}),e.$set(n)},i(t){r||(l(e.$$.fragment,t),r=!0)},o(t){g(e.$$.fragment,t),r=!1},d(t){$(e,t)}}}function fe(a,e,r){let t,o;H(a,X,m=>r(3,t=m)),H(a,T,m=>r(4,o=m));let n,i,u=!1;function s(){B("/demo")}R(async()=>{if(!o||!t.curves||!t.hierarchy)return B("/scan/mapscanning");await I.setup(t),I.build(),r(2,u=!0)});function f(){n=this.clientWidth,i=this.clientHeight,r(0,n),r(1,i)}return[n,i,u,t,o,s,f]}class ye extends E{constructor(e){super(),D(this,e,fe,ie,N,{})}}export{ye as default};
