import{S as le,i as ce,s as ue,e as h,t as w,k as I,c as g,a as p,h as k,d as v,m as D,b as _,g as E,K as c,E as x,F as ot,G as it,H as at,I as lt,q as V,o as y,v as dt,L as ft,l as et,n as Le,p as Me,X as ee,Y as Oe,w as T,x as C,f as ae,y as B,W as Fe,B as P,j as vt}from"../../chunks/index-ca5d62ed.js";import{N as mt,B as ct,m as ht,a as gt}from"../../chunks/NavigationButton-4b0ccaf5.js";import{D as pt}from"../../chunks/Dropdown-8e372fbe.js";import{P as _t}from"../../chunks/Page-ada7c1be.js";import{M as bt}from"../../chunks/Modal-1308c881.js";import{g as $t}from"../../chunks/navigation-0e6511d1.js";import{r as wt}from"../../chunks/imageStore-6fc6631c.js";import"../../chunks/singletons-d1fb5791.js";import"../../chunks/index-bcf3c295.js";function kt(i){let e,r,t,s,o,n,a,u,f,d,l,m,b,S,L,z,M,de,fe,O,U,ve,me,G,he,ge,F,R,pe,_e,q,be,$e,A,we,ke,H,W,Ie,De,K,Ve,ye,N,X,Ee,ze,Y,Se,Te,j,J,Ce,Be,Q,Pe;return{c(){e=h("div"),r=h("h2"),t=w("Good example of contour map"),s=I(),o=h("div"),n=I(),a=h("h2"),u=w("Instructions"),f=I(),d=h("div"),l=w("Drawing"),m=I(),b=h("div"),S=h("div"),L=w("Curves should have sufficient margin"),z=I(),M=h("div"),de=w(`The curves should have sufficient margin between them, overlapping or close lines are hard to
			interpret`),fe=I(),O=h("div"),U=h("div"),ve=w("Drawing with dark pen"),me=I(),G=h("div"),he=w(`To recognise your level curves, we prefer a dark and thick marker. Using a lighter pen will
			likely not work`),ge=I(),F=h("div"),R=h("div"),pe=w("Close your curves"),_e=I(),q=h("div"),be=w("To avoid false readings, close your curves, dont leave any open-ended lines"),$e=I(),A=h("div"),we=w("Scanning"),ke=I(),H=h("div"),W=h("div"),Ie=w("Four corners visible"),De=I(),K=h("div"),Ve=w("To scan the level curves, we need to have the four corners visible"),ye=I(),N=h("div"),X=h("div"),Ee=w("Drawing should not be too far"),ze=I(),Y=h("div"),Se=w(`Scanning works best from a distance of 0.5 meters from the piece of paper. For best the best
			result try to scan the paper as close to parallel as possible. This is easiest if you put your
			drawing on a table instead of holding it.`),Te=I(),j=h("div"),J=h("div"),Ce=w("Proper lighting"),Be=I(),Q=h("div"),Pe=w(`Level curves are hard to distinguish from background in a low light setting. Try to use natual
			daylight or a propper ceiling light for best results. Be careful of sharp or dark shadows on
			the drawing, as they might get interpreted as part of your drawing.`),this.h()},l(Z){e=g(Z,"DIV",{class:!0});var $=p(e);r=g($,"H2",{});var He=p(r);t=k(He,"Good example of contour map"),He.forEach(v),s=D($),o=g($,"DIV",{class:!0}),p(o).forEach(v),n=D($),a=g($,"H2",{});var Ne=p(a);u=k(Ne,"Instructions"),Ne.forEach(v),f=D($),d=g($,"DIV",{class:!0});var je=p(d);l=k(je,"Drawing"),je.forEach(v),m=D($),b=g($,"DIV",{class:!0});var te=p(b);S=g(te,"DIV",{class:!0});var Ue=p(S);L=k(Ue,"Curves should have sufficient margin"),Ue.forEach(v),z=D(te),M=g(te,"DIV",{class:!0});var Ge=p(M);de=k(Ge,`The curves should have sufficient margin between them, overlapping or close lines are hard to
			interpret`),Ge.forEach(v),te.forEach(v),fe=D($),O=g($,"DIV",{class:!0});var re=p(O);U=g(re,"DIV",{class:!0});var Re=p(U);ve=k(Re,"Drawing with dark pen"),Re.forEach(v),me=D(re),G=g(re,"DIV",{class:!0});var qe=p(G);he=k(qe,`To recognise your level curves, we prefer a dark and thick marker. Using a lighter pen will
			likely not work`),qe.forEach(v),re.forEach(v),ge=D($),F=g($,"DIV",{class:!0});var se=p(F);R=g(se,"DIV",{class:!0});var Ae=p(R);pe=k(Ae,"Close your curves"),Ae.forEach(v),_e=D(se),q=g(se,"DIV",{class:!0});var We=p(q);be=k(We,"To avoid false readings, close your curves, dont leave any open-ended lines"),We.forEach(v),se.forEach(v),$e=D($),A=g($,"DIV",{class:!0});var Ke=p(A);we=k(Ke,"Scanning"),Ke.forEach(v),ke=D($),H=g($,"DIV",{class:!0});var ne=p(H);W=g(ne,"DIV",{class:!0});var Xe=p(W);Ie=k(Xe,"Four corners visible"),Xe.forEach(v),De=D(ne),K=g(ne,"DIV",{class:!0});var Ye=p(K);Ve=k(Ye,"To scan the level curves, we need to have the four corners visible"),Ye.forEach(v),ne.forEach(v),ye=D($),N=g($,"DIV",{class:!0});var oe=p(N);X=g(oe,"DIV",{class:!0});var Je=p(X);Ee=k(Je,"Drawing should not be too far"),Je.forEach(v),ze=D(oe),Y=g(oe,"DIV",{class:!0});var Qe=p(Y);Se=k(Qe,`Scanning works best from a distance of 0.5 meters from the piece of paper. For best the best
			result try to scan the paper as close to parallel as possible. This is easiest if you put your
			drawing on a table instead of holding it.`),Qe.forEach(v),oe.forEach(v),Te=D($),j=g($,"DIV",{class:!0});var ie=p(j);J=g(ie,"DIV",{class:!0});var Ze=p(J);Ce=k(Ze,"Proper lighting"),Ze.forEach(v),Be=D(ie),Q=g(ie,"DIV",{class:!0});var xe=p(Q);Pe=k(xe,`Level curves are hard to distinguish from background in a low light setting. Try to use natual
			daylight or a propper ceiling light for best results. Be careful of sharp or dark shadows on
			the drawing, as they might get interpreted as part of your drawing.`),xe.forEach(v),ie.forEach(v),$.forEach(v),this.h()},h(){_(o,"class","example svelte-nxz67r"),_(d,"class","section svelte-nxz67r"),_(S,"class","title svelte-nxz67r"),_(M,"class","description"),_(b,"class","instruction svelte-nxz67r"),_(U,"class","title svelte-nxz67r"),_(G,"class","description"),_(O,"class","instruction svelte-nxz67r"),_(R,"class","title svelte-nxz67r"),_(q,"class","description"),_(F,"class","instruction svelte-nxz67r"),_(A,"class","section svelte-nxz67r"),_(W,"class","title svelte-nxz67r"),_(K,"class","description"),_(H,"class","instruction svelte-nxz67r"),_(X,"class","title svelte-nxz67r"),_(Y,"class","description"),_(N,"class","instruction svelte-nxz67r"),_(J,"class","title svelte-nxz67r"),_(Q,"class","description"),_(j,"class","instruction svelte-nxz67r"),_(e,"class","instructions svelte-nxz67r")},m(Z,$){E(Z,e,$),c(e,r),c(r,t),c(e,s),c(e,o),c(e,n),c(e,a),c(a,u),c(e,f),c(e,d),c(d,l),c(e,m),c(e,b),c(b,S),c(S,L),c(b,z),c(b,M),c(M,de),c(e,fe),c(e,O),c(O,U),c(U,ve),c(O,me),c(O,G),c(G,he),c(e,ge),c(e,F),c(F,R),c(R,pe),c(F,_e),c(F,q),c(q,be),c(e,$e),c(e,A),c(A,we),c(e,ke),c(e,H),c(H,W),c(W,Ie),c(H,De),c(H,K),c(K,Ve),c(e,ye),c(e,N),c(N,X),c(X,Ee),c(N,ze),c(N,Y),c(Y,Se),c(e,Te),c(e,j),c(j,J),c(J,Ce),c(j,Be),c(j,Q),c(Q,Pe)},p:x,i:x,o:x,d(Z){Z&&v(e)}}}class It extends le{constructor(e){super(),ce(this,e,null,kt,ue,{})}}const Dt=i=>({loading:i&2,stream:i&1,error:i&4,cameraOptions:i&8}),tt=i=>({loading:i[1],stream:i[0],error:i[2],cameraOptions:i[3]});function Vt(i){let e;const r=i[6].default,t=ot(r,i,i[5],tt);return{c(){t&&t.c()},l(s){t&&t.l(s)},m(s,o){t&&t.m(s,o),e=!0},p(s,[o]){t&&t.p&&(!e||o&47)&&it(t,r,s,s[5],e?lt(r,s[5],o,Dt):at(s[5]),tt)},i(s){e||(V(t,s),e=!0)},o(s){y(t,s),e=!1},d(s){t&&t.d(s)}}}function yt(i,e,r){let{$$slots:t={},$$scope:s}=e,{deviceId:o=""}=e,n,a=!0,u,f=[];const d=async()=>{r(1,a=!0),n&&n.getTracks().forEach(m=>m.stop());const l=o?{deviceId:{exact:o}}:{facingMode:"environment"};try{r(0,n=await navigator.mediaDevices.getUserMedia({video:l})),r(1,a=!1),r(2,u="")}catch(m){r(2,u=""+m)}};return dt(async()=>{await d();const l=await navigator.mediaDevices.enumerateDevices();r(3,f=l.filter(m=>m.kind=="videoinput"))}),ft(()=>{!n||n.getTracks().forEach(l=>l.stop())}),i.$$set=l=>{"deviceId"in l&&r(4,o=l.deviceId),"$$scope"in l&&r(5,s=l.$$scope)},i.$$.update=()=>{i.$$.dirty&16&&o&&d()},[n,a,u,f,o,s,t]}class Et extends le{constructor(e){super(),ce(this,e,yt,Vt,ue,{deviceId:4})}}function zt(i){let e;return{c(){e=h("video"),this.h()},l(r){e=g(r,"VIDEO",{style:!0,preload:!0,type:!0,class:!0}),p(e).forEach(v),this.h()},h(){_(e,"style",i[1]),e.loop=!0,e.playsInline=!0,e.autoplay=!1,e.controls=!1,_(e,"preload","auto"),_(e,"type","video/mp4"),_(e,"class","svelte-wvnab8")},m(r,t){E(r,e,t),i[7](e)},p(r,t){t&2&&_(e,"style",r[1])},i:x,o:x,d(r){r&&v(e),i[7](null)}}}function St(i){let e,r,t,s,o,n=i[3]&&i[3].includes("Permission denied"),a,u,f=n&&rt();const d=i[6].default,l=ot(d,i,i[5],null);return{c(){e=h("div"),r=h("div"),t=h("h2"),s=w("Loading video..."),o=I(),f&&f.c(),a=I(),l&&l.c(),this.h()},l(m){e=g(m,"DIV",{class:!0});var b=p(e);r=g(b,"DIV",{class:!0});var S=p(r);t=g(S,"H2",{});var L=p(t);s=k(L,"Loading video..."),L.forEach(v),o=D(S),f&&f.l(S),S.forEach(v),b.forEach(v),a=D(m),l&&l.l(m),this.h()},h(){_(r,"class","svelte-wvnab8"),_(e,"class","loadingVideo svelte-wvnab8")},m(m,b){E(m,e,b),c(e,r),c(r,t),c(t,s),c(r,o),f&&f.m(r,null),E(m,a,b),l&&l.m(m,b),u=!0},p(m,b){b&8&&(n=m[3]&&m[3].includes("Permission denied")),n?f||(f=rt(),f.c(),f.m(r,null)):f&&(f.d(1),f=null),l&&l.p&&(!u||b&32)&&it(l,d,m,m[5],u?lt(d,m[5],b,null):at(m[5]),null)},i(m){u||(V(l,m),u=!0)},o(m){y(l,m),u=!1},d(m){m&&v(e),f&&f.d(),m&&v(a),l&&l.d(m)}}}function rt(i){let e;return{c(){e=w("The browser is unable to access the camera, try re-enabling the camera and reload")},l(r){e=k(r,"The browser is unable to access the camera, try re-enabling the camera and reload")},m(r,t){E(r,e,t)},d(r){r&&v(e)}}}function Tt(i){let e,r,t,s;const o=[St,zt],n=[];function a(u,f){return u[2]?0:1}return e=a(i),r=n[e]=o[e](i),{c(){r.c(),t=et()},l(u){r.l(u),t=et()},m(u,f){n[e].m(u,f),E(u,t,f),s=!0},p(u,[f]){let d=e;e=a(u),e===d?n[e].p(u,f):(Le(),y(n[d],1,1,()=>{n[d]=null}),Me(),r=n[e],r?r.p(u,f):(r=n[e]=o[e](u),r.c()),V(r,1),r.m(t.parentNode,t))},i(u){s||(V(r),s=!0)},o(u){y(r),s=!1},d(u){n[e].d(u),u&&v(t)}}}function Ct(i,e,r){let{$$slots:t={},$$scope:s}=e,{stream:o}=e,{style:n=""}=e,{loading:a=!0}=e,{error:u=""}=e,{videoSource:f=void 0}=e;function d(l){ee[l?"unshift":"push"](()=>{f=l,r(0,f),r(4,o),r(2,a)})}return i.$$set=l=>{"stream"in l&&r(4,o=l.stream),"style"in l&&r(1,n=l.style),"loading"in l&&r(2,a=l.loading),"error"in l&&r(3,u=l.error),"videoSource"in l&&r(0,f=l.videoSource),"$$scope"in l&&r(5,s=l.$$scope)},i.$$.update=()=>{i.$$.dirty&21&&o&&!a&&f&&f.paused&&(r(0,f.srcObject=o,f),f.play())},[f,n,a,u,o,s,t,d]}class ut extends le{constructor(e){super(),ce(this,e,Ct,Tt,ue,{stream:4,style:1,loading:2,error:3,videoSource:0})}}function Bt(i){let e,r;return e=new It({}),{c(){T(e.$$.fragment)},l(t){C(e.$$.fragment,t)},m(t,s){B(e,t,s),r=!0},i(t){r||(V(e.$$.fragment,t),r=!0)},o(t){y(e.$$.fragment,t),r=!1},d(t){P(e,t)}}}function Pt(i){let e,r,t,s;function o(a){i[11](a)}let n={error:i[15],loading:i[13],stream:i[14]};return i[1]!==void 0&&(n.videoSource=i[1]),e=new ut({props:n}),ee.push(()=>Oe(e,"videoSource",o)),{c(){r=h("div"),T(e.$$.fragment),this.h()},l(a){r=g(a,"DIV",{style:!0});var u=p(r);C(e.$$.fragment,u),this.h()},h(){ae(r,"display","contents"),ae(r,"--corner-radius","1rem")},m(a,u){E(a,r,u),B(e,r,null),s=!0},p(a,u){const f={};u&32768&&(f.error=a[15]),u&8192&&(f.loading=a[13]),u&16384&&(f.stream=a[14]),!t&&u&2&&(t=!0,f.videoSource=a[1],Fe(()=>t=!1)),e.$set(f)},i(a){s||(V(e.$$.fragment,a),s=!0)},o(a){y(e.$$.fragment,a),s=!1},d(a){a&&v(r),P(e,a)}}}function Lt(i){let e;return{c(){e=w("Back home")},l(r){e=k(r,"Back home")},m(r,t){E(r,e,t)},d(r){r&&v(e)}}}function Mt(i){let e,r;return e=new mt({props:{slot:"headerButton",back:!0,to:"/",$$slots:{default:[Lt]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment)},l(t){C(e.$$.fragment,t)},m(t,s){B(e,t,s),r=!0},p(t,s){const o={};s&524288&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){r||(V(e.$$.fragment,t),r=!0)},o(t){y(e.$$.fragment,t),r=!1},d(t){P(e,t)}}}function Ot(i){let e,r,t;return r=new ut({props:{loading:i[13],stream:i[14]}}),{c(){e=h("div"),T(r.$$.fragment),this.h()},l(s){e=g(s,"DIV",{slot:!0});var o=p(e);C(r.$$.fragment,o),o.forEach(v),this.h()},h(){_(e,"slot","background")},m(s,o){E(s,e,o),B(r,e,null),t=!0},p(s,o){const n={};o&8192&&(n.loading=s[13]),o&16384&&(n.stream=s[14]),r.$set(n)},i(s){t||(V(r.$$.fragment,s),t=!0)},o(s){y(r.$$.fragment,s),t=!1},d(s){s&&v(e),P(r)}}}function st(i){let e,r,t;function s(n){i[10](n)}let o={options:i[16],$$slots:{default:[Ft,({option:n,index:a})=>({17:n,18:a}),({option:n,index:a})=>(n?131072:0)|(a?262144:0)]},$$scope:{ctx:i}};return i[2]!==void 0&&(o.value=i[2]),e=new pt({props:o}),ee.push(()=>Oe(e,"value",s)),e.$on("change",i[8]),{c(){T(e.$$.fragment)},l(n){C(e.$$.fragment,n)},m(n,a){B(e,n,a),t=!0},p(n,a){const u={};a&65536&&(u.options=n[16]),a&917504&&(u.$$scope={dirty:a,ctx:n}),!r&&a&4&&(r=!0,u.value=n[2],Fe(()=>r=!1)),e.$set(u)},i(n){t||(V(e.$$.fragment,n),t=!0)},o(n){y(e.$$.fragment,n),t=!1},d(n){P(e,n)}}}function Ft(i){let e=(i[17].label||"Camera "+(i[18]+1))+"",r;return{c(){r=w(e)},l(t){r=k(t,e)},m(t,s){E(t,r,s)},p(t,s){s&393216&&e!==(e=(t[17].label||"Camera "+(t[18]+1))+"")&&vt(r,e)},d(t){t&&v(r)}}}function Ht(i){var s;let e,r,t=!i[0]&&((s=i[16])==null?void 0:s.length)>1&&st(i);return{c(){e=h("div"),t&&t.c(),this.h()},l(o){e=g(o,"DIV",{slot:!0});var n=p(e);t&&t.l(n),n.forEach(v),this.h()},h(){_(e,"slot","options")},m(o,n){E(o,e,n),t&&t.m(e,null),r=!0},p(o,n){var a;!o[0]&&((a=o[16])==null?void 0:a.length)>1?t?(t.p(o,n),n&65537&&V(t,1)):(t=st(o),t.c(),V(t,1),t.m(e,null)):t&&(Le(),y(t,1,1,()=>{t=null}),Me())},i(o){r||(V(t),r=!0)},o(o){y(t),r=!1},d(o){o&&v(e),t&&t.d()}}}function nt(i){let e,r;return e=new ct({props:{secondary:!0,icon:gt,$$slots:{default:[Nt]},$$scope:{ctx:i}}}),e.$on("click",i[6]),{c(){T(e.$$.fragment)},l(t){C(e.$$.fragment,t)},m(t,s){B(e,t,s),r=!0},p(t,s){const o={};s&524288&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){r||(V(e.$$.fragment,t),r=!0)},o(t){y(e.$$.fragment,t),r=!1},d(t){P(e,t)}}}function Nt(i){let e;return{c(){e=w("Read scan instructions")},l(r){e=k(r,"Read scan instructions")},m(r,t){E(r,e,t)},d(r){r&&v(e)}}}function jt(i){let e;return{c(){e=w("Capture photo of map")},l(r){e=k(r,"Capture photo of map")},m(r,t){E(r,e,t)},d(r){r&&v(e)}}}function Ut(i){let e,r,t,s,o=!i[0]&&nt(i);return t=new ct({props:{loading:i[4],icon:ht,$$slots:{default:[jt]},$$scope:{ctx:i}}}),t.$on("click",i[7]),{c(){e=h("div"),o&&o.c(),r=I(),T(t.$$.fragment),this.h()},l(n){e=g(n,"DIV",{slot:!0});var a=p(e);o&&o.l(a),r=D(a),C(t.$$.fragment,a),a.forEach(v),this.h()},h(){_(e,"slot","footer")},m(n,a){E(n,e,a),o&&o.m(e,null),c(e,r),B(t,e,null),s=!0},p(n,a){n[0]?o&&(Le(),y(o,1,1,()=>{o=null}),Me()):o?(o.p(n,a),a&1&&V(o,1)):(o=nt(n),o.c(),V(o,1),o.m(e,r));const u={};a&16&&(u.loading=n[4]),a&524288&&(u.$$scope={dirty:a,ctx:n}),t.$set(u)},i(n){s||(V(o),V(t.$$.fragment,n),s=!0)},o(n){y(o),y(t.$$.fragment,n),s=!1},d(n){n&&v(e),o&&o.d(),P(t)}}}function Gt(i){let e,r;return e=new _t({props:{fullscreen:!i[13],title:"Capture the image",$$slots:{footer:[Ut],options:[Ht],background:[Ot],headerButton:[Mt],default:[Pt]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment)},l(t){C(e.$$.fragment,t)},m(t,s){B(e,t,s),r=!0},p(t,s){const o={};s&8192&&(o.fullscreen=!t[13]),s&647191&&(o.$$scope={dirty:s,ctx:t}),e.$set(o)},i(t){r||(V(e.$$.fragment,t),r=!0)},o(t){y(e.$$.fragment,t),r=!1},d(t){P(e,t)}}}function Rt(i){let e,r,t,s,o,n,a;function u(d){i[9](d)}let f={title:"scan instructions",$$slots:{default:[Bt]},$$scope:{ctx:i}};return i[0]!==void 0&&(f.visible=i[0]),e=new bt({props:f}),ee.push(()=>Oe(e,"visible",u)),s=new Et({props:{deviceId:i[5],$$slots:{default:[Gt,({loading:d,stream:l,error:m,cameraOptions:b})=>({13:d,14:l,15:m,16:b}),({loading:d,stream:l,error:m,cameraOptions:b})=>(d?8192:0)|(l?16384:0)|(m?32768:0)|(b?65536:0)]},$$scope:{ctx:i}}}),{c(){T(e.$$.fragment),t=I(),T(s.$$.fragment),o=I(),n=h("canvas"),this.h()},l(d){C(e.$$.fragment,d),t=D(d),C(s.$$.fragment,d),o=D(d),n=g(d,"CANVAS",{id:!0,style:!0}),p(n).forEach(v),this.h()},h(){_(n,"id","captureCanvas"),ae(n,"display","none"),ae(n,"position","absolute")},m(d,l){B(e,d,l),E(d,t,l),B(s,d,l),E(d,o,l),E(d,n,l),i[12](n),a=!0},p(d,[l]){const m={};l&524288&&(m.$$scope={dirty:l,ctx:d}),!r&&l&1&&(r=!0,m.visible=d[0],Fe(()=>r=!1)),e.$set(m);const b={};l&32&&(b.deviceId=d[5]),l&647191&&(b.$$scope={dirty:l,ctx:d}),s.$set(b)},i(d){a||(V(e.$$.fragment,d),V(s.$$.fragment,d),a=!0)},o(d){y(e.$$.fragment,d),y(s.$$.fragment,d),a=!1},d(d){P(e,d),d&&v(t),P(s,d),d&&v(o),d&&v(n),i[12](null)}}}const er=!0;function qt(i,e,r){let t,s,o,n,a=!1,u;const f=()=>r(0,t=!t);async function d(){r(4,a=!0);const z=n.getContext("2d");r(3,n.height=s.videoHeight,n),r(3,n.width=s.videoWidth,n),z&&z.drawImage(s,0,0,n.width,n.height);const M=n.toDataURL("image/png");wt.set(M),$t("/scan/maptransform")}function l(){r(5,u=o.deviceId)}function m(z){t=z,r(0,t)}function b(z){o=z,r(2,o)}function S(z){s=z,r(1,s)}function L(z){ee[z?"unshift":"push"](()=>{n=z,r(3,n)})}return[t,s,o,n,a,u,f,d,l,m,b,S,L]}class tr extends le{constructor(e){super(),ce(this,e,qt,Rt,ue,{})}}export{tr as default,er as prerender};
