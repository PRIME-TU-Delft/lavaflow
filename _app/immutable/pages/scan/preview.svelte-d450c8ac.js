import{S as L,i as z,s as P,w as h,x as _,y as p,E as v,q as f,o as c,B as $,l as w,g,n as R,p as q,d as l,J as W,v as Q,e as y,c as M,a as S,b as F,M as T,N as U,f as X,k as H,m as E,t as N,h as V,K as J}from"../../chunks/index-e50d45aa.js";import{P as Y}from"../../chunks/P5-bd5cfe29.js";import{N as Z,B as C,I as K,d as O}from"../../chunks/NavigationButton-d591ec72.js";import{P as x}from"../../chunks/Page-c4546c49.js";import{g as B}from"../../chunks/navigation-0e6511d1.js";import{a as ee}from"../../chunks/contourLineStore-67ef1863.js";import{g as D}from"../../chunks/gltfStore-d6d1bd39.js";import{d as te}from"../../chunks/difficultyStore-0791473c.js";import{d as re}from"../../chunks/debugStore-b63444ef.js";import"../../chunks/preload-helper-60cab3ee.js";import"../../chunks/singletons-d1fb5791.js";import"../../chunks/index-ca69d11e.js";import"../../chunks/@vite-plugin-wasm-pack@wasm-9c455baf.js";function A(a){let t,o;return t=new Y({props:{sketch:a[1]}}),{c(){h(t.$$.fragment)},l(e){_(t.$$.fragment,e)},m(e,s){p(t,e,s),o=!0},p:v,i(e){o||(f(t.$$.fragment,e),o=!0)},o(e){c(t.$$.fragment,e),o=!1},d(e){$(t,e)}}}function ne(a){let t=a[0],o,e,s=A(a);return{c(){s.c(),o=w()},l(n){s.l(n),o=w()},m(n,r){s.m(n,r),g(n,o,r),e=!0},p(n,[r]){r&1&&P(t,t=n[0])?(R(),c(s,1,1,v),q(),s=A(n),s.c(),f(s,1),s.m(o.parentNode,o)):s.p(n,r)},i(n){e||(f(s),e=!0)},o(n){c(s),e=!1},d(n){n&&l(o),s.d(n)}}}function oe(a,t,o){let{debugMode:e=!1}=t,{foregroundWidth:s}=t,{foregroundHeight:n}=t,{curves:r}=t,{hierarchy:i}=t;const m=u=>{u.setup=()=>{u.createCanvas(s,n),u.background(230),r.forEach((b,k)=>{u.strokeWeight(1),u.stroke(30),u.fill(30),e&&u.text(`${k} (${i[k]})`,b[0][0]-10,b[0][1]-10),u.strokeWeight(4),u.noFill(),u.beginShape();for(let d of b){let j=d[0],G=d[1];u.vertex(j,G)}u.endShape(u.CLOSE)})}};return a.$$set=u=>{"debugMode"in u&&o(0,e=u.debugMode),"foregroundWidth"in u&&o(2,s=u.foregroundWidth),"foregroundHeight"in u&&o(3,n=u.foregroundHeight),"curves"in u&&o(4,r=u.curves),"hierarchy"in u&&o(5,i=u.hierarchy)},[e,m,s,n,r,i]}class se extends L{constructor(t){super(),z(this,t,oe,ne,P,{debugMode:0,foregroundWidth:2,foregroundHeight:3,curves:4,hierarchy:5})}}function I(a){let t,o,e,s;return o=new se({props:{debugMode:a[4],curves:a[3].curves,hierarchy:a[3].hierarchy,foregroundHeight:a[1],foregroundWidth:a[0]}}),{c(){t=y("div"),h(o.$$.fragment),this.h()},l(n){t=M(n,"DIV",{class:!0});var r=S(t);_(o.$$.fragment,r),r.forEach(l),this.h()},h(){F(t,"class","sketch svelte-1upoge"),T(()=>a[7].call(t))},m(n,r){g(n,t,r),p(o,t,null),e=U(t,a[7].bind(t)),s=!0},p(n,r){const i={};r&16&&(i.debugMode=n[4]),r&8&&(i.curves=n[3].curves),r&8&&(i.hierarchy=n[3].hierarchy),r&2&&(i.foregroundHeight=n[1]),r&1&&(i.foregroundWidth=n[0]),o.$set(i)},i(n){s||(f(o.$$.fragment,n),s=!0)},o(n){c(o.$$.fragment,n),s=!1},d(n){n&&l(t),$(o),e()}}}function ae(a){var s,n;let t,o,e=((s=a[3])==null?void 0:s.curves)&&((n=a[3])==null?void 0:n.hierarchy)&&I(a);return{c(){e&&e.c(),t=w()},l(r){e&&e.l(r),t=w()},m(r,i){e&&e.m(r,i),g(r,t,i),o=!0},p(r,i){var m,u;((m=r[3])==null?void 0:m.curves)&&((u=r[3])==null?void 0:u.hierarchy)?e?(e.p(r,i),i&8&&f(e,1)):(e=I(r),e.c(),f(e,1),e.m(t.parentNode,t)):e&&(R(),c(e,1,1,()=>{e=null}),q())},i(r){o||(f(e),o=!0)},o(r){c(e),o=!1},d(r){e&&e.d(r),r&&l(t)}}}function ie(a){let t;return{c(){t=N("Back to selection")},l(o){t=V(o,"Back to selection")},m(o,e){g(o,t,e)},d(o){o&&l(t)}}}function ue(a){let t,o;return t=new Z({props:{slot:"headerButton",to:"/scan/maptransform",back:!0,$$slots:{default:[ie]},$$scope:{ctx:a}}}),{c(){h(t.$$.fragment)},l(e){_(t.$$.fragment,e)},m(e,s){p(t,e,s),o=!0},p(e,s){const n={};s&512&&(n.$$scope={dirty:s,ctx:e}),t.$set(n)},i(e){o||(f(t.$$.fragment,e),o=!0)},o(e){c(t.$$.fragment,e),o=!1},d(e){$(t,e)}}}function le(a){let t;return{c(){t=y("div"),this.h()},l(o){t=M(o,"DIV",{slot:!0,style:!0}),S(t).forEach(l),this.h()},h(){F(t,"slot","background"),X(t,"background","#aaa")},m(o,e){g(o,t,e)},p:v,d(o){o&&l(t)}}}function fe(a){let t,o,e,s,n;return s=new K({props:{path:O}}),{c(){t=y("span"),o=N("Visualise as 3D model"),e=H(),h(s.$$.fragment)},l(r){t=M(r,"SPAN",{});var i=S(t);o=V(i,"Visualise as 3D model"),i.forEach(l),e=E(r),_(s.$$.fragment,r)},m(r,i){g(r,t,i),J(t,o),g(r,e,i),p(s,r,i),n=!0},p:v,i(r){n||(f(s.$$.fragment,r),n=!0)},o(r){c(s.$$.fragment,r),n=!1},d(r){r&&l(t),r&&l(e),$(s,r)}}}function ce(a){let t,o,e,s,n;return s=new K({props:{path:O}}),{c(){t=y("span"),o=N("Visualise in AR"),e=H(),h(s.$$.fragment)},l(r){t=M(r,"SPAN",{});var i=S(t);o=V(i,"Visualise in AR"),i.forEach(l),e=E(r),_(s.$$.fragment,r)},m(r,i){g(r,t,i),J(t,o),g(r,e,i),p(s,r,i),n=!0},p:v,i(r){n||(f(s.$$.fragment,r),n=!0)},o(r){c(s.$$.fragment,r),n=!1},d(r){r&&l(t),r&&l(e),$(s,r)}}}function me(a){let t,o,e,s;return t=new C({props:{secondary:!0,loading:!a[2],$$slots:{default:[fe]},$$scope:{ctx:a}}}),t.$on("click",a[5]),e=new C({props:{loading:!a[2],$$slots:{default:[ce]},$$scope:{ctx:a}}}),e.$on("click",a[6]),{c(){h(t.$$.fragment),o=H(),h(e.$$.fragment)},l(n){_(t.$$.fragment,n),o=E(n),_(e.$$.fragment,n)},m(n,r){p(t,n,r),g(n,o,r),p(e,n,r),s=!0},p(n,r){const i={};r&4&&(i.loading=!n[2]),r&512&&(i.$$scope={dirty:r,ctx:n}),t.$set(i);const m={};r&4&&(m.loading=!n[2]),r&512&&(m.$$scope={dirty:r,ctx:n}),e.$set(m)},i(n){s||(f(t.$$.fragment,n),f(e.$$.fragment,n),s=!0)},o(n){c(t.$$.fragment,n),c(e.$$.fragment,n),s=!1},d(n){$(t,n),n&&l(o),$(e,n)}}}function ge(a){let t,o;return t=new x({props:{$$slots:{footer:[me],background:[le],headerButton:[ue],default:[ae]},$$scope:{ctx:a}}}),{c(){h(t.$$.fragment)},l(e){_(t.$$.fragment,e)},m(e,s){p(t,e,s),o=!0},p(e,[s]){const n={};s&543&&(n.$$scope={dirty:s,ctx:e}),t.$set(n)},i(e){o||(f(t.$$.fragment,e),o=!0)},o(e){c(t.$$.fragment,e),o=!1},d(e){$(t,e)}}}const Pe=!0;function de(a,t,o){let e,s,n;W(a,ee,d=>o(3,e=d)),W(a,te,d=>o(8,s=d)),W(a,re,d=>o(4,n=d));let r,i,m=!1;Q(async()=>{if(!e.curves||!e.hierarchy)return B("/scan/mapscanning");await D.setup(e,s.lava_forking),D.build(e),o(2,m=!0)});const u=()=>B("/visualise/model"),b=()=>B("/visualise/ar");function k(){r=this.clientWidth,i=this.clientHeight,o(0,r),o(1,i)}return[r,i,m,e,n,u,b,k]}class He extends L{constructor(t){super(),z(this,t,de,ge,P,{})}}export{He as default,Pe as prerender};
