import{S as C,i as D,s as W,w as m,x as _,y as b,E as $,q as c,o as f,B as p,l as v,g as h,n as L,p as z,d as l,J as B,v as A,e as k,c as w,a as y,b as M,U as F,a0 as J,f as K,t as I,h as j,K as O}from"../../chunks/index-9cd2e54e.js";import{B as U}from"../../chunks/Button-5d6b26fc.js";import{P as G}from"../../chunks/Page-646f45ef.js";import{N as Q}from"../../chunks/NavigationButton-b6d3fe29.js";import{c as T}from"../../chunks/contourLineStore-d37fb8d9.js";import{g as E}from"../../chunks/navigation-0e6511d1.js";import{g as S}from"../../chunks/gltfStore-4583681c.js";import{d as X}from"../../chunks/debugStore-c65327f7.js";import{P as Y}from"../../chunks/P5-ccea3d7d.js";import"../../chunks/index-6c269418.js";import"../../chunks/singletons-d1fb5791.js";import"../../chunks/preload-helper-60cab3ee.js";function V(a){let t,r;return t=new Y({props:{sketch:a[1]}}),{c(){m(t.$$.fragment)},l(e){_(t.$$.fragment,e)},m(e,o){b(t,e,o),r=!0},p:$,i(e){r||(c(t.$$.fragment,e),r=!0)},o(e){f(t.$$.fragment,e),r=!1},d(e){p(t,e)}}}function Z(a){let t=a[0],r,e,o=V(a);return{c(){o.c(),r=v()},l(n){o.l(n),r=v()},m(n,s){o.m(n,s),h(n,r,s),e=!0},p(n,[s]){s&1&&W(t,t=n[0])?(L(),f(o,1,1,$),z(),o=V(n),o.c(),c(o,1),o.m(r.parentNode,r)):o.p(n,s)},i(n){e||(c(o),e=!0)},o(n){f(o),e=!1},d(n){n&&l(r),o.d(n)}}}function x(a,t,r){let{debugMode:e=!1}=t,{foregroundWidth:o}=t,{foregroundHeight:n}=t,{curves:s}=t,{hierarchy:u}=t;const g=i=>{i.setup=()=>{i.createCanvas(o,n),i.background(230),s.forEach((d,H)=>{i.strokeWeight(1),i.stroke(30),i.fill(30),e&&i.text(`${H} (${u[H]})`,d[0][0]-10,d[0][1]-10),i.strokeWeight(4),i.noFill(),i.beginShape();for(let P of d){let q=P[0],R=P[1];i.vertex(q,R)}i.endShape(i.CLOSE)})}};return a.$$set=i=>{"debugMode"in i&&r(0,e=i.debugMode),"foregroundWidth"in i&&r(2,o=i.foregroundWidth),"foregroundHeight"in i&&r(3,n=i.foregroundHeight),"curves"in i&&r(4,s=i.curves),"hierarchy"in i&&r(5,u=i.hierarchy)},[e,g,o,n,s,u]}class ee extends C{constructor(t){super(),D(this,t,x,Z,W,{debugMode:0,foregroundWidth:2,foregroundHeight:3,curves:4,hierarchy:5})}}function N(a){let t,r,e,o;return r=new ee({props:{debugMode:a[4],curves:a[3].curves,hierarchy:a[3].hierarchy,foregroundHeight:a[1],foregroundWidth:a[0]}}),{c(){t=k("div"),m(r.$$.fragment),this.h()},l(n){t=w(n,"DIV",{class:!0});var s=y(t);_(r.$$.fragment,s),s.forEach(l),this.h()},h(){M(t,"class","sketch svelte-dbjsc6"),F(()=>a[6].call(t))},m(n,s){h(n,t,s),b(r,t,null),e=J(t,a[6].bind(t)),o=!0},p(n,s){const u={};s&16&&(u.debugMode=n[4]),s&8&&(u.curves=n[3].curves),s&8&&(u.hierarchy=n[3].hierarchy),s&2&&(u.foregroundHeight=n[1]),s&1&&(u.foregroundWidth=n[0]),r.$set(u)},i(n){o||(c(r.$$.fragment,n),o=!0)},o(n){f(r.$$.fragment,n),o=!1},d(n){n&&l(t),p(r),e()}}}function te(a){var o,n;let t,r,e=((o=a[3])==null?void 0:o.curves)&&((n=a[3])==null?void 0:n.hierarchy)&&N(a);return{c(){e&&e.c(),t=v()},l(s){e&&e.l(s),t=v()},m(s,u){e&&e.m(s,u),h(s,t,u),r=!0},p(s,u){var g,i;((g=s[3])==null?void 0:g.curves)&&((i=s[3])==null?void 0:i.hierarchy)?e?(e.p(s,u),u&8&&c(e,1)):(e=N(s),e.c(),c(e,1),e.m(t.parentNode,t)):e&&(L(),f(e,1,1,()=>{e=null}),z())},i(s){r||(c(e),r=!0)},o(s){f(e),r=!1},d(s){e&&e.d(s),s&&l(t)}}}function re(a){let t;return{c(){t=I("Redraw borders")},l(r){t=j(r,"Redraw borders")},m(r,e){h(r,t,e)},d(r){r&&l(t)}}}function oe(a){let t,r;return t=new Q({props:{slot:"headerButton",to:"/scan/maptransform",back:!0,$$slots:{default:[re]},$$scope:{ctx:a}}}),{c(){m(t.$$.fragment)},l(e){_(t.$$.fragment,e)},m(e,o){b(t,e,o),r=!0},p(e,o){const n={};o&128&&(n.$$scope={dirty:o,ctx:e}),t.$set(n)},i(e){r||(c(t.$$.fragment,e),r=!0)},o(e){f(t.$$.fragment,e),r=!1},d(e){p(t,e)}}}function ne(a){let t;return{c(){t=k("div"),this.h()},l(r){t=w(r,"DIV",{slot:!0,style:!0}),y(t).forEach(l),this.h()},h(){M(t,"slot","background"),K(t,"background","#aaa")},m(r,e){h(r,t,e)},p:$,d(r){r&&l(t)}}}function se(a){let t,r;return{c(){t=k("span"),r=I("Visualise")},l(e){t=w(e,"SPAN",{});var o=y(t);r=j(o,"Visualise"),o.forEach(l)},m(e,o){h(e,t,o),O(t,r)},p:$,d(e){e&&l(t)}}}function ae(a){let t,r,e;return r=new U({props:{loading:!a[2],$$slots:{default:[se]},$$scope:{ctx:a}}}),r.$on("click",a[5]),{c(){t=k("div"),m(r.$$.fragment),this.h()},l(o){t=w(o,"DIV",{slot:!0});var n=y(t);_(r.$$.fragment,n),n.forEach(l),this.h()},h(){M(t,"slot","footer")},m(o,n){h(o,t,n),b(r,t,null),e=!0},p(o,n){const s={};n&4&&(s.loading=!o[2]),n&128&&(s.$$scope={dirty:n,ctx:o}),r.$set(s)},i(o){e||(c(r.$$.fragment,o),e=!0)},o(o){f(r.$$.fragment,o),e=!1},d(o){o&&l(t),p(r)}}}function ie(a){let t,r;return t=new G({props:{title:"image transformation",$$slots:{footer:[ae],background:[ne],headerButton:[oe],default:[te]},$$scope:{ctx:a}}}),{c(){m(t.$$.fragment)},l(e){_(t.$$.fragment,e)},m(e,o){b(t,e,o),r=!0},p(e,[o]){const n={};o&159&&(n.$$scope={dirty:o,ctx:e}),t.$set(n)},i(e){r||(c(t.$$.fragment,e),r=!0)},o(e){f(t.$$.fragment,e),r=!1},d(e){p(t,e)}}}function ue(a,t,r){let e,o;B(a,T,d=>r(3,e=d)),B(a,X,d=>r(4,o=d));let n,s,u=!1;function g(){E("/demo")}A(async()=>{if(!e.curves||!e.hierarchy)return E("/scan/mapscanning");await S.setup(e),S.build(),r(2,u=!0)});function i(){n=this.clientWidth,s=this.clientHeight,r(0,n),r(1,s)}return[n,s,u,e,o,g,i]}class ke extends C{constructor(t){super(),D(this,t,ue,ie,W,{})}}export{ke as default};
