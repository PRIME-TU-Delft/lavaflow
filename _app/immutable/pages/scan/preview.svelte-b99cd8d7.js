import{S as z,i as j,s as P,w as g,x as h,y as _,E as v,q as f,o as c,B as $,l as W,g as m,n as q,p as F,d as u,J as C,v as Q,e as k,c as w,a as y,b as E,W as T,a1 as U,f as X,k as H,m as S,K as V,t as B,h as N}from"../../chunks/index-b2cf3344.js";import{P as Y}from"../../chunks/P5-ab5ed039.js";import{B as I,I as J,a as K}from"../../chunks/Button-2751e271.js";import{P as Z}from"../../chunks/Page-bed51374.js";import{N as x}from"../../chunks/NavigationButton-f564c9bc.js";import{g as M}from"../../chunks/navigation-0e6511d1.js";import{c as ee,g as A}from"../../chunks/contourLineStore-66468231.js";import{d as te}from"../../chunks/debugStore-aae9bc5b.js";import"../../chunks/preload-helper-60cab3ee.js";import"../../chunks/singletons-d1fb5791.js";import"../../chunks/index-082afcc0.js";function D(i){let e,n;return e=new Y({props:{sketch:i[1]}}),{c(){g(e.$$.fragment)},l(t){h(e.$$.fragment,t)},m(t,o){_(e,t,o),n=!0},p:v,i(t){n||(f(e.$$.fragment,t),n=!0)},o(t){c(e.$$.fragment,t),n=!1},d(t){$(e,t)}}}function re(i){let e=i[0],n,t,o=D(i);return{c(){o.c(),n=W()},l(s){o.l(s),n=W()},m(s,r){o.m(s,r),m(s,n,r),t=!0},p(s,[r]){r&1&&P(e,e=s[0])?(q(),c(o,1,1,v),F(),o=D(s),o.c(),f(o,1),o.m(n.parentNode,n)):o.p(s,r)},i(s){t||(f(o),t=!0)},o(s){c(o),t=!1},d(s){s&&u(n),o.d(s)}}}function ne(i,e,n){let{debugMode:t=!1}=e,{foregroundWidth:o}=e,{foregroundHeight:s}=e,{curves:r}=e,{hierarchy:a}=e;const d=l=>{l.setup=()=>{l.createCanvas(o,s),l.background(230),r.forEach((b,p)=>{l.strokeWeight(1),l.stroke(30),l.fill(30),t&&l.text(`${p} (${a[p]})`,b[0][0]-10,b[0][1]-10),l.strokeWeight(4),l.noFill(),l.beginShape();for(let R of b){let O=R[0],G=R[1];l.vertex(O,G)}l.endShape(l.CLOSE)})}};return i.$$set=l=>{"debugMode"in l&&n(0,t=l.debugMode),"foregroundWidth"in l&&n(2,o=l.foregroundWidth),"foregroundHeight"in l&&n(3,s=l.foregroundHeight),"curves"in l&&n(4,r=l.curves),"hierarchy"in l&&n(5,a=l.hierarchy)},[t,d,o,s,r,a]}class oe extends z{constructor(e){super(),j(this,e,ne,re,P,{debugMode:0,foregroundWidth:2,foregroundHeight:3,curves:4,hierarchy:5})}}function L(i){let e,n,t,o;return n=new oe({props:{debugMode:i[4],curves:i[3].curves,hierarchy:i[3].hierarchy,foregroundHeight:i[1],foregroundWidth:i[0]}}),{c(){e=k("div"),g(n.$$.fragment),this.h()},l(s){e=w(s,"DIV",{class:!0});var r=y(e);h(n.$$.fragment,r),r.forEach(u),this.h()},h(){E(e,"class","sketch svelte-dbjsc6"),T(()=>i[7].call(e))},m(s,r){m(s,e,r),_(n,e,null),t=U(e,i[7].bind(e)),o=!0},p(s,r){const a={};r&16&&(a.debugMode=s[4]),r&8&&(a.curves=s[3].curves),r&8&&(a.hierarchy=s[3].hierarchy),r&2&&(a.foregroundHeight=s[1]),r&1&&(a.foregroundWidth=s[0]),n.$set(a)},i(s){o||(f(n.$$.fragment,s),o=!0)},o(s){c(n.$$.fragment,s),o=!1},d(s){s&&u(e),$(n),t()}}}function se(i){var o,s;let e,n,t=((o=i[3])==null?void 0:o.curves)&&((s=i[3])==null?void 0:s.hierarchy)&&L(i);return{c(){t&&t.c(),e=W()},l(r){t&&t.l(r),e=W()},m(r,a){t&&t.m(r,a),m(r,e,a),n=!0},p(r,a){var d,l;((d=r[3])==null?void 0:d.curves)&&((l=r[3])==null?void 0:l.hierarchy)?t?(t.p(r,a),a&8&&f(t,1)):(t=L(r),t.c(),f(t,1),t.m(e.parentNode,e)):t&&(q(),c(t,1,1,()=>{t=null}),F())},i(r){n||(f(t),n=!0)},o(r){c(t),n=!1},d(r){t&&t.d(r),r&&u(e)}}}function ae(i){let e;return{c(){e=B("Redraw borders")},l(n){e=N(n,"Redraw borders")},m(n,t){m(n,e,t)},d(n){n&&u(e)}}}function ie(i){let e,n;return e=new x({props:{slot:"headerButton",to:"/scan/maptransform",back:!0,$$slots:{default:[ae]},$$scope:{ctx:i}}}),{c(){g(e.$$.fragment)},l(t){h(e.$$.fragment,t)},m(t,o){_(e,t,o),n=!0},p(t,o){const s={};o&256&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){n||(f(e.$$.fragment,t),n=!0)},o(t){c(e.$$.fragment,t),n=!1},d(t){$(e,t)}}}function le(i){let e;return{c(){e=k("div"),this.h()},l(n){e=w(n,"DIV",{slot:!0,style:!0}),y(e).forEach(u),this.h()},h(){E(e,"slot","background"),X(e,"background","#aaa")},m(n,t){m(n,e,t)},p:v,d(n){n&&u(e)}}}function ue(i){let e,n,t,o,s;return o=new J({props:{path:K}}),{c(){e=k("span"),n=B("Visualise as model"),t=H(),g(o.$$.fragment)},l(r){e=w(r,"SPAN",{});var a=y(e);n=N(a,"Visualise as model"),a.forEach(u),t=S(r),h(o.$$.fragment,r)},m(r,a){m(r,e,a),V(e,n),m(r,t,a),_(o,r,a),s=!0},p:v,i(r){s||(f(o.$$.fragment,r),s=!0)},o(r){c(o.$$.fragment,r),s=!1},d(r){r&&u(e),r&&u(t),$(o,r)}}}function fe(i){let e,n,t,o,s;return o=new J({props:{path:K}}),{c(){e=k("span"),n=B("Visualise in AR"),t=H(),g(o.$$.fragment)},l(r){e=w(r,"SPAN",{});var a=y(e);n=N(a,"Visualise in AR"),a.forEach(u),t=S(r),h(o.$$.fragment,r)},m(r,a){m(r,e,a),V(e,n),m(r,t,a),_(o,r,a),s=!0},p:v,i(r){s||(f(o.$$.fragment,r),s=!0)},o(r){c(o.$$.fragment,r),s=!1},d(r){r&&u(e),r&&u(t),$(o,r)}}}function ce(i){let e,n,t,o,s;return n=new I({props:{secondary:!0,loading:!i[2],$$slots:{default:[ue]},$$scope:{ctx:i}}}),n.$on("click",i[5]),o=new I({props:{loading:!i[2],$$slots:{default:[fe]},$$scope:{ctx:i}}}),o.$on("click",i[6]),{c(){e=k("div"),g(n.$$.fragment),t=H(),g(o.$$.fragment),this.h()},l(r){e=w(r,"DIV",{slot:!0});var a=y(e);h(n.$$.fragment,a),t=S(a),h(o.$$.fragment,a),a.forEach(u),this.h()},h(){E(e,"slot","footer")},m(r,a){m(r,e,a),_(n,e,null),V(e,t),_(o,e,null),s=!0},p(r,a){const d={};a&4&&(d.loading=!r[2]),a&256&&(d.$$scope={dirty:a,ctx:r}),n.$set(d);const l={};a&4&&(l.loading=!r[2]),a&256&&(l.$$scope={dirty:a,ctx:r}),o.$set(l)},i(r){s||(f(n.$$.fragment,r),f(o.$$.fragment,r),s=!0)},o(r){c(n.$$.fragment,r),c(o.$$.fragment,r),s=!1},d(r){r&&u(e),$(n),$(o)}}}function de(i){let e,n;return e=new Z({props:{title:"Result of transformation",$$slots:{footer:[ce],background:[le],headerButton:[ie],default:[se]},$$scope:{ctx:i}}}),{c(){g(e.$$.fragment)},l(t){h(e.$$.fragment,t)},m(t,o){_(e,t,o),n=!0},p(t,[o]){const s={};o&287&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){n||(f(e.$$.fragment,t),n=!0)},o(t){c(e.$$.fragment,t),n=!1},d(t){$(e,t)}}}function me(i,e,n){let t,o;C(i,ee,p=>n(3,t=p)),C(i,te,p=>n(4,o=p));let s,r,a=!1;Q(async()=>{if(!t.curves||!t.hierarchy)return M("/scan/mapscanning");await A.setup(t),A.build(),n(2,a=!0)});const d=()=>M("/visualise/model"),l=()=>M("/visualise/ar");function b(){s=this.clientWidth,r=this.clientHeight,n(0,s),n(1,r)}return[s,r,a,t,o,d,l,b]}class Me extends z{constructor(e){super(),j(this,e,me,de,P,{})}}export{Me as default};
