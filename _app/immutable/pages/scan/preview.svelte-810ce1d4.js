import{S as D,i as S,s as P,w as _,x as p,y as $,E as V,q as l,o as g,B as v,l as k,g as h,n as z,p as C,d as c,J as H,v as J,e as w,c as y,a as M,b as W,V as K,a2 as F,k as G,m as O,t as L,h as q,K as Q}from"../../chunks/index-e0f51726.js";import{B as T}from"../../chunks/Button-cd47bace.js";import{P as U,p as X}from"../../chunks/imageStore-4cfab36d.js";import{I as R}from"../../chunks/Image-f8d187b2.js";import{N as Y}from"../../chunks/NavigationButton-877c01b7.js";import{c as Z}from"../../chunks/contourLineStore-edfeec73.js";import{g as B}from"../../chunks/navigation-0e6511d1.js";import{g as I}from"../../chunks/gltfStore-14a1016a.js";import{d as x}from"../../chunks/debugStore-22559e0e.js";import{P as ee}from"../../chunks/P5-cdfffe88.js";import"../../chunks/index-f300c76b.js";import"../../chunks/singletons-d1fb5791.js";import"../../chunks/draggable-873e1aaa.js";import"../../chunks/preload-helper-60cab3ee.js";function E(s){let e,r;return e=new ee({props:{sketch:s[1]}}),{c(){_(e.$$.fragment)},l(o){p(e.$$.fragment,o)},m(o,n){$(e,o,n),r=!0},p:V,i(o){r||(l(e.$$.fragment,o),r=!0)},o(o){g(e.$$.fragment,o),r=!1},d(o){v(e,o)}}}function te(s){let e=s[0],r,o,n=E(s);return{c(){n.c(),r=k()},l(t){n.l(t),r=k()},m(t,a){n.m(t,a),h(t,r,a),o=!0},p(t,[a]){a&1&&P(e,e=t[0])?(z(),g(n,1,1,V),C(),n=E(t),n.c(),l(n,1),n.m(r.parentNode,r)):n.p(t,a)},i(t){o||(l(n),o=!0)},o(t){g(n),o=!1},d(t){t&&c(r),n.d(t)}}}function re(s,e,r){let{debugMode:o=!1}=e,{foregroundWidth:n}=e,{foregroundHeight:t}=e,{curves:a}=e,{hierarchy:f}=e;const u=i=>{i.setup=()=>{i.createCanvas(n,t),i.fill(i.color(255,255,255)),i.stroke(i.color(255,255,255)),a.forEach((d,m)=>{o&&i.text(`${m} (${f[m]})`,d[0][0],d[0][1]);for(let b of d){let j=b[0],A=b[1];i.point(j,A)}})}};return s.$$set=i=>{"debugMode"in i&&r(0,o=i.debugMode),"foregroundWidth"in i&&r(2,n=i.foregroundWidth),"foregroundHeight"in i&&r(3,t=i.foregroundHeight),"curves"in i&&r(4,a=i.curves),"hierarchy"in i&&r(5,f=i.hierarchy)},[o,u,n,t,a,f]}class oe extends D{constructor(e){super(),S(this,e,re,te,P,{debugMode:0,foregroundWidth:2,foregroundHeight:3,curves:4,hierarchy:5})}}function N(s){let e,r,o,n;return r=new oe({props:{debugMode:s[5],curves:s[3].curves,hierarchy:s[3].hierarchy,foregroundHeight:s[1],foregroundWidth:s[0]}}),{c(){e=w("div"),_(r.$$.fragment),this.h()},l(t){e=y(t,"DIV",{class:!0});var a=M(e);p(r.$$.fragment,a),a.forEach(c),this.h()},h(){W(e,"class","sketch svelte-dbjsc6"),K(()=>s[7].call(e))},m(t,a){h(t,e,a),$(r,e,null),o=F(e,s[7].bind(e)),n=!0},p(t,a){const f={};a&32&&(f.debugMode=t[5]),a&8&&(f.curves=t[3].curves),a&8&&(f.hierarchy=t[3].hierarchy),a&2&&(f.foregroundHeight=t[1]),a&1&&(f.foregroundWidth=t[0]),r.$set(f)},i(t){n||(l(r.$$.fragment,t),n=!0)},o(t){g(r.$$.fragment,t),n=!1},d(t){t&&c(e),v(r),o()}}}function ne(s){var a,f;let e,r,o,n;e=new R({props:{src:s[4],alt:"foreground"}});let t=((a=s[3])==null?void 0:a.curves)&&((f=s[3])==null?void 0:f.hierarchy)&&N(s);return{c(){_(e.$$.fragment),r=G(),t&&t.c(),o=k()},l(u){p(e.$$.fragment,u),r=O(u),t&&t.l(u),o=k()},m(u,i){$(e,u,i),h(u,r,i),t&&t.m(u,i),h(u,o,i),n=!0},p(u,i){var m,b;const d={};i&16&&(d.src=u[4]),e.$set(d),((m=u[3])==null?void 0:m.curves)&&((b=u[3])==null?void 0:b.hierarchy)?t?(t.p(u,i),i&8&&l(t,1)):(t=N(u),t.c(),l(t,1),t.m(o.parentNode,o)):t&&(z(),g(t,1,1,()=>{t=null}),C())},i(u){n||(l(e.$$.fragment,u),l(t),n=!0)},o(u){g(e.$$.fragment,u),g(t),n=!1},d(u){v(e,u),u&&c(r),t&&t.d(u),u&&c(o)}}}function se(s){let e;return{c(){e=L("Redraw borders")},l(r){e=q(r,"Redraw borders")},m(r,o){h(r,e,o)},d(r){r&&c(e)}}}function ae(s){let e,r;return e=new Y({props:{slot:"headerButton",to:"/scan/maptransform",back:!0,$$slots:{default:[se]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},l(o){p(e.$$.fragment,o)},m(o,n){$(e,o,n),r=!0},p(o,n){const t={};n&256&&(t.$$scope={dirty:n,ctx:o}),e.$set(t)},i(o){r||(l(e.$$.fragment,o),r=!0)},o(o){g(e.$$.fragment,o),r=!1},d(o){v(e,o)}}}function ie(s){let e,r,o;return r=new R({props:{src:s[4],alt:"background"}}),{c(){e=w("div"),_(r.$$.fragment),this.h()},l(n){e=y(n,"DIV",{slot:!0});var t=M(e);p(r.$$.fragment,t),t.forEach(c),this.h()},h(){W(e,"slot","background")},m(n,t){h(n,e,t),$(r,e,null),o=!0},p(n,t){const a={};t&16&&(a.src=n[4]),r.$set(a)},i(n){o||(l(r.$$.fragment,n),o=!0)},o(n){g(r.$$.fragment,n),o=!1},d(n){n&&c(e),v(r)}}}function ue(s){let e,r;return{c(){e=w("span"),r=L("Visualise")},l(o){e=y(o,"SPAN",{});var n=M(e);r=q(n,"Visualise"),n.forEach(c)},m(o,n){h(o,e,n),Q(e,r)},p:V,d(o){o&&c(e)}}}function fe(s){let e,r,o;return r=new T({props:{loading:!s[2],$$slots:{default:[ue]},$$scope:{ctx:s}}}),r.$on("click",s[6]),{c(){e=w("div"),_(r.$$.fragment),this.h()},l(n){e=y(n,"DIV",{slot:!0});var t=M(e);p(r.$$.fragment,t),t.forEach(c),this.h()},h(){W(e,"slot","footer")},m(n,t){h(n,e,t),$(r,e,null),o=!0},p(n,t){const a={};t&4&&(a.loading=!n[2]),t&256&&(a.$$scope={dirty:t,ctx:n}),r.$set(a)},i(n){o||(l(r.$$.fragment,n),o=!0)},o(n){g(r.$$.fragment,n),o=!1},d(n){n&&c(e),v(r)}}}function le(s){let e,r;return e=new U({props:{title:"image transformation",$$slots:{footer:[fe],background:[ie],headerButton:[ae],default:[ne]},$$scope:{ctx:s}}}),{c(){_(e.$$.fragment)},l(o){p(e.$$.fragment,o)},m(o,n){$(e,o,n),r=!0},p(o,[n]){const t={};n&319&&(t.$$scope={dirty:n,ctx:o}),e.$set(t)},i(o){r||(l(e.$$.fragment,o),r=!0)},o(o){g(e.$$.fragment,o),r=!1},d(o){v(e,o)}}}function ce(s,e,r){let o,n,t;H(s,Z,m=>r(3,o=m)),H(s,X,m=>r(4,n=m)),H(s,x,m=>r(5,t=m));let a,f,u=!1;function i(){B("/demo")}J(async()=>{if(!n||!o.curves||!o.hierarchy)return B("/scan/mapscanning");await I.setup(o),I.build(),r(2,u=!0)});function d(){a=this.clientWidth,f=this.clientHeight,r(0,a),r(1,f)}return[a,f,u,o,n,t,i,d]}class Pe extends D{constructor(e){super(),S(this,e,ce,le,P,{})}}export{Pe as default};
