import{S as q,i as A,s as G,w as p,x as $,y as h,E as M,q as u,o as m,B as b,O as w,v as O,l as E,g as _,n as B,p as H,d as g,e as N,c as T,a as W,b as D,k as X,m as Y,t as v,h as S,j as Z,X as F,Y as J,Z as K}from"../chunks/index-6ef4ca18.js";import{B as j,f as Q,g as U}from"../chunks/Button-4b8f6361.js";import{N as z}from"../chunks/NavigationButton-bb539df9.js";import{I as y}from"../chunks/Image-cb38b7e4.js";import{P as L}from"../chunks/P5-da498645.js";import{p as P,P as x,d as ee}from"../chunks/imageStore-794ecfdf.js";import{t as I}from"../chunks/gltfStore-677f7d4b.js";import{D as te}from"../chunks/draggable-873e1aaa.js";import"../chunks/preload-helper-60cab3ee.js";import"../chunks/index-381b1206.js";function re(a){let t,n;return t=new L({props:{sketch:a[0]}}),{c(){p(t.$$.fragment)},l(e){$(t.$$.fragment,e)},m(e,r){h(t,e,r),n=!0},p:M,i(e){n||(u(t.$$.fragment,e),n=!0)},o(e){m(t.$$.fragment,e),n=!1},d(e){b(t,e)}}}function ne(a,t,n){let e,r;w(a,I,f=>n(5,e=f)),w(a,P,f=>n(6,r=f));let{foregroundWidth:o}=t,{foregroundHeight:l}=t,{targetSelected:i}=t;console.log({foregroundWidth:o,foregroundHeight:l});let s;function c(f){f.preload=()=>{r&&(s=f.loadImage(r))},f.setup=()=>{f.createCanvas(o,l)},f.draw=()=>{if(!s)return;f.image(s,0,0,o,l);let d=20;if(e!=null&&e.length)for(let k=0;k<e.length;k++){let C=e[k];C.update(f),C.drawCircle(f,d,k)}},f.mousePressed=()=>{if(!!(e!=null&&e.length)){for(let d=0;d<e.length;d++)if(e[d].pressed(f)){n(1,i=d);break}}},f.mouseReleased=()=>{if(!!(e!=null&&e.length))for(let d of e)d.released()}}return a.$$set=f=>{"foregroundWidth"in f&&n(2,o=f.foregroundWidth),"foregroundHeight"in f&&n(3,l=f.foregroundHeight),"targetSelected"in f&&n(1,i=f.targetSelected)},[c,i,o,l]}class ae extends q{constructor(t){super(),A(this,t,ne,re,G,{foregroundWidth:2,foregroundHeight:3,targetSelected:1})}}function oe(a){let t,n;return t=new z({props:{to:"/scan/mapscanning",$$slots:{default:[se]},$$scope:{ctx:a}}}),{c(){p(t.$$.fragment)},l(e){$(t.$$.fragment,e)},m(e,r){h(t,e,r),n=!0},p(e,r){const o={};r&256&&(o.$$scope={dirty:r,ctx:e}),t.$set(o)},i(e){n||(u(t.$$.fragment,e),n=!0)},o(e){m(t.$$.fragment,e),n=!1},d(e){b(t,e)}}}function le(a){let t,n,e,r;function o(i){a[5](i)}let l={foregroundHeight:a[6],foregroundWidth:a[7]};return a[0]!==void 0&&(l.targetSelected=a[0]),n=new ae({props:l}),F.push(()=>J(n,"targetSelected",o)),{c(){t=N("div"),p(n.$$.fragment),this.h()},l(i){t=T(i,"DIV",{class:!0});var s=W(t);$(n.$$.fragment,s),s.forEach(g),this.h()},h(){D(t,"class","sketch")},m(i,s){_(i,t,s),h(n,t,null),r=!0},p(i,s){const c={};s&64&&(c.foregroundHeight=i[6]),s&128&&(c.foregroundWidth=i[7]),!e&&s&1&&(e=!0,c.targetSelected=i[0],K(()=>e=!1)),n.$set(c)},i(i){r||(u(n.$$.fragment,i),r=!0)},o(i){m(n.$$.fragment,i),r=!1},d(i){i&&g(t),b(n)}}}function se(a){let t;return{c(){t=v("No image found. Go to map scanning")},l(n){t=S(n,"No image found. Go to map scanning")},m(n,e){_(n,t,e)},d(n){n&&g(t)}}}function ie(a){let t,n,e,r;const o=[le,oe],l=[];function i(s,c){return s[1]?0:1}return t=i(a),n=l[t]=o[t](a),{c(){n.c(),e=E()},l(s){n.l(s),e=E()},m(s,c){l[t].m(s,c),_(s,e,c),r=!0},p(s,c){let f=t;t=i(s),t===f?l[t].p(s,c):(B(),m(l[f],1,1,()=>{l[f]=null}),H(),n=l[t],n?n.p(s,c):(n=l[t]=o[t](s),n.c()),u(n,1),n.m(e.parentNode,e))},i(s){r||(u(n),r=!0)},o(s){m(n),r=!1},d(s){l[t].d(s),s&&g(e)}}}function fe(a){let t;return{c(){t=v("Back to visualise")},l(n){t=S(n,"Back to visualise")},m(n,e){_(n,t,e)},d(n){n&&g(t)}}}function ce(a){let t,n;return t=new z({props:{slot:"headerButton",to:"demo",back:!0,$$slots:{default:[fe]},$$scope:{ctx:a}}}),{c(){p(t.$$.fragment)},l(e){$(t.$$.fragment,e)},m(e,r){h(t,e,r),n=!0},p(e,r){const o={};r&256&&(o.$$scope={dirty:r,ctx:e}),t.$set(o)},i(e){n||(u(t.$$.fragment,e),n=!0)},o(e){m(t.$$.fragment,e),n=!1},d(e){b(t,e)}}}function ue(a){let t,n,e;return n=new y({props:{src:a[1],alt:"background"}}),{c(){t=N("div"),p(n.$$.fragment),this.h()},l(r){t=T(r,"DIV",{slot:!0});var o=W(t);$(n.$$.fragment,o),o.forEach(g),this.h()},h(){D(t,"slot","background")},m(r,o){_(r,t,o),h(n,t,null),e=!0},p(r,o){const l={};o&2&&(l.src=r[1]),n.$set(l)},i(r){e||(u(n.$$.fragment,r),e=!0)},o(r){m(n.$$.fragment,r),e=!1},d(r){r&&g(t),b(n)}}}function R(a){let t,n,e,r=a[0]!=-1&&V(a);function o(){return a[4](a[7],a[6])}return n=new j({props:{icon:Q,$$slots:{default:[ge]},$$scope:{ctx:a}}}),n.$on("click",o),{c(){r&&r.c(),t=X(),p(n.$$.fragment)},l(l){r&&r.l(l),t=Y(l),$(n.$$.fragment,l)},m(l,i){r&&r.m(l,i),_(l,t,i),h(n,l,i),e=!0},p(l,i){a=l,a[0]!=-1?r?(r.p(a,i),i&1&&u(r,1)):(r=V(a),r.c(),u(r,1),r.m(t.parentNode,t)):r&&(B(),m(r,1,1,()=>{r=null}),H());const s={};i&256&&(s.$$scope={dirty:i,ctx:a}),n.$set(s)},i(l){e||(u(r),u(n.$$.fragment,l),e=!0)},o(l){m(r),m(n.$$.fragment,l),e=!1},d(l){r&&r.d(l),l&&g(t),b(n,l)}}}function V(a){let t,n;return t=new j({props:{secondary:!0,icon:U,$$slots:{default:[me]},$$scope:{ctx:a}}}),t.$on("click",a[3]),{c(){p(t.$$.fragment)},l(e){$(t.$$.fragment,e)},m(e,r){h(t,e,r),n=!0},p(e,r){const o={};r&257&&(o.$$scope={dirty:r,ctx:e}),t.$set(o)},i(e){n||(u(t.$$.fragment,e),n=!0)},o(e){m(t.$$.fragment,e),n=!1},d(e){b(t,e)}}}function me(a){let t,n;return{c(){t=v("Remove target #"),n=v(a[0])},l(e){t=S(e,"Remove target #"),n=S(e,a[0])},m(e,r){_(e,t,r),_(e,n,r)},p(e,r){r&1&&Z(n,e[0])},d(e){e&&g(t),e&&g(n)}}}function ge(a){let t;return{c(){t=v("Add target")},l(n){t=S(n,"Add target")},m(n,e){_(n,t,e)},d(n){n&&g(t)}}}function de(a){let t,n,e=a[1]&&R(a);return{c(){t=N("div"),e&&e.c(),this.h()},l(r){t=T(r,"DIV",{slot:!0});var o=W(t);e&&e.l(o),o.forEach(g),this.h()},h(){D(t,"slot","footer")},m(r,o){_(r,t,o),e&&e.m(t,null),n=!0},p(r,o){r[1]?e?(e.p(r,o),o&2&&u(e,1)):(e=R(r),e.c(),u(e,1),e.m(t,null)):e&&(B(),m(e,1,1,()=>{e=null}),H())},i(r){n||(u(e),n=!0)},o(r){m(e),n=!1},d(r){r&&g(t),e&&e.d()}}}function _e(a){let t,n;return t=new x({props:{title:"image transformation",$$slots:{footer:[de,({foregroundHeight:e,foregroundWidth:r})=>({6:e,7:r}),({foregroundHeight:e,foregroundWidth:r})=>(e?64:0)|(r?128:0)],background:[ue,({foregroundHeight:e,foregroundWidth:r})=>({6:e,7:r}),({foregroundHeight:e,foregroundWidth:r})=>(e?64:0)|(r?128:0)],headerButton:[ce,({foregroundHeight:e,foregroundWidth:r})=>({6:e,7:r}),({foregroundHeight:e,foregroundWidth:r})=>(e?64:0)|(r?128:0)],default:[ie,({foregroundHeight:e,foregroundWidth:r})=>({6:e,7:r}),({foregroundHeight:e,foregroundWidth:r})=>(e?64:0)|(r?128:0)]},$$scope:{ctx:a}}}),{c(){p(t.$$.fragment)},l(e){$(t.$$.fragment,e)},m(e,r){h(t,e,r),n=!0},p(e,[r]){const o={};r&451&&(o.$$scope={dirty:r,ctx:e}),t.$set(o)},i(e){n||(u(t.$$.fragment,e),n=!0)},o(e){m(t.$$.fragment,e),n=!1},d(e){b(t,e)}}}function pe(a,t,n){let e;w(a,P,c=>n(1,e=c));let r=-1;function o(c,f){const d=new te(c,f,20);I.add(d)}function l(){r!=-1&&(I.remove(r),n(0,r=-1))}O(()=>{e||P.set(ee)});const i=(c,f)=>o(c/2,f/2);function s(c){r=c,n(0,r)}return[r,e,o,l,i,s]}class He extends q{constructor(t){super(),A(this,t,pe,_e,G,{})}}export{He as default};
