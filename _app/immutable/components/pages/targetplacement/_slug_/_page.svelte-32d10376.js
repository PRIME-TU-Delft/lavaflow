import{S as x,i as J,s as K,w as y,x as T,y as S,I as L,f as g,t as h,z as P,G as H,k as V,q as I,a as R,l as W,m as Y,r as D,h as _,c as q,n as M,b,H as C,N as se,O as ae,P as oe,e as j,g as Q,d as U,p as fe,C as me,D as _e,E as de,F as ge,u as he}from"../../../../chunks/index-5adb68ea.js";import{N as le}from"../../../../chunks/NavigationButton-5fbaa702.js";import{B as Z,d as pe,f as $e,g as be}from"../../../../chunks/Button-52912701.js";import{P as ve}from"../../../../chunks/P5-902ad660.js";import{t as O,c as ie,a as ke,D as te}from"../../../../chunks/contourLineStore-ac16300d.js";import{d as ue}from"../../../../chunks/difficultyStore-7cc4eead.js";import{P as we}from"../../../../chunks/Page-3bb88c34.js";import{M as ye}from"../../../../chunks/Modal-74a3b537.js";import{p as Te}from"../../../../chunks/stores-9dfa457b.js";function Se(l){let t,n;return t=new ve({props:{sketch:l[0]}}),{c(){y(t.$$.fragment)},l(e){T(t.$$.fragment,e)},m(e,r){S(t,e,r),n=!0},p:L,i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){P(t,e)}}}function Pe(l,t,n){let e,r,s;H(l,O,o=>n(5,e=o)),H(l,ue,o=>n(6,r=o)),H(l,ie,o=>n(7,s=o));let{foregroundWidth:f}=t,{foregroundHeight:u}=t,{targetSelected:a}=t,{curves:i}=t;function c(o){o.setup=()=>{o.createCanvas(f,u)},o.draw=()=>{o.background(230),o.stroke(30),i.forEach(k=>{o.strokeWeight(4),o.noFill(),o.beginShape();for(let[E,F]of k)o.vertex(E,F);o.endShape(o.CLOSE)});const v=s!=null?s:[];for(let k of s){o.strokeWeight(1),o.stroke("#e15f55f0");const[E,F]=k;o.fill("#e15f55f0"),o.ellipse(E,F,50,50),o.noFill(),o.strokeWeight(.5),o.ellipse(E,F,r.min_crater_distance*2,r.min_crater_distance*2)}let p=20;for(let k=0;k<e.length;k++){let E=e[k];E.update(o,v,r.min_crater_distance,e,r.min_steam_turbine_separation,k),E.drawCircle(o,p,k+1)}let $="";if(e.length!=r.min_steam_turbines&&r.min_steam_turbines==r.max_steam_turbines?$="You must place exactly "+r.min_steam_turbines+" steam turbines":e.length<r.min_steam_turbines?$="You must place at least "+r.min_steam_turbines+" steam turbines":e.length==r.max_steam_turbines&&($="You have reached the maximal amount of "+r.max_steam_turbines+" steam turbines"),e.length<r.min_steam_turbines||e.length>=r.max_steam_turbines){o.noStroke(),o.fill(51),o.textSize(15),o.textAlign(o.CENTER);let k=o.textWidth($);o.rectMode(o.CENTER),o.rect(o.width/2,60,k+10,30),o.strokeWeight(1),o.fill(255),o.text($,o.width/2,65)}},o.mousePressed=()=>{if(!(e!=null&&e.length))return;let v=!1;for(let p=0;p<e.length;p++){let $=!1;e[p].deselect(),v||($=e[p].pressed(o,!0),v=$),$&&n(1,a=p)}},o.mouseReleased=()=>{if(!!(e!=null&&e.length)){for(let v of e)v.released();O.set(e)}}}return l.$$set=o=>{"foregroundWidth"in o&&n(2,f=o.foregroundWidth),"foregroundHeight"in o&&n(3,u=o.foregroundHeight),"targetSelected"in o&&n(1,a=o.targetSelected),"curves"in o&&n(4,i=o.curves)},[c,a,f,u,i]}class Ee extends x{constructor(t){super(),J(this,t,Pe,Se,K,{foregroundWidth:2,foregroundHeight:3,targetSelected:1,curves:4})}}function Ce(l){let t,n,e,r,s,f,u,a,i;return{c(){t=V("div"),n=V("h2"),e=I("Instructions"),r=R(),s=V("div"),f=I(`Add targets where you think the lava will flow. You can't place targets too close to the craters
		or too close to other targets. How close you can place targets to craters and other targets
		depends on the difficulty mode you selected. There is also a minimum amount of targets you need
		to place, which also depends on your difficulty mode. You can never place more than 10 targets.`),u=R(),a=V("div"),i=I(`Points are based on how close the steam turbine is placed to the lava stream, divided by the
		number of turbines. The points represent how much energy the average steam turbine generates,
		measured in megawatts.`),this.h()},l(c){t=W(c,"DIV",{class:!0});var o=Y(t);n=W(o,"H2",{});var v=Y(n);e=D(v,"Instructions"),v.forEach(_),r=q(o),s=W(o,"DIV",{class:!0});var p=Y(s);f=D(p,`Add targets where you think the lava will flow. You can't place targets too close to the craters
		or too close to other targets. How close you can place targets to craters and other targets
		depends on the difficulty mode you selected. There is also a minimum amount of targets you need
		to place, which also depends on your difficulty mode. You can never place more than 10 targets.`),p.forEach(_),u=q(o),a=W(o,"DIV",{class:!0});var $=Y(a);i=D($,`Points are based on how close the steam turbine is placed to the lava stream, divided by the
		number of turbines. The points represent how much energy the average steam turbine generates,
		measured in megawatts.`),$.forEach(_),o.forEach(_),this.h()},h(){M(s,"class","instruction"),M(a,"class","instruction"),M(t,"class","instructions svelte-tryer5")},m(c,o){b(c,t,o),C(t,n),C(n,e),C(t,r),C(t,s),C(s,f),C(t,u),C(t,a),C(a,i)},p:L,i:L,o:L,d(c){c&&_(t)}}}class Ie extends x{constructor(t){super(),J(this,t,null,Ce,K,{})}}function De(l){let t,n;return t=new Ie({}),{c(){y(t.$$.fragment)},l(e){T(t.$$.fragment,e)},m(e,r){S(t,e,r),n=!0},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){P(t,e)}}}function ne(l){let t,n,e,r;function s(u){l[11](u)}let f={foregroundHeight:l[16],foregroundWidth:l[17],curves:l[4].curves};return l[0]!==void 0&&(f.targetSelected=l[0]),n=new Ee({props:f}),se.push(()=>ae(n,"targetSelected",s)),{c(){t=V("div"),y(n.$$.fragment),this.h()},l(u){t=W(u,"DIV",{class:!0});var a=Y(t);T(n.$$.fragment,a),a.forEach(_),this.h()},h(){M(t,"class","sketch svelte-1invhxf")},m(u,a){b(u,t,a),S(n,t,null),r=!0},p(u,a){const i={};a&65536&&(i.foregroundHeight=u[16]),a&131072&&(i.foregroundWidth=u[17]),a&16&&(i.curves=u[4].curves),!e&&a&1&&(e=!0,i.targetSelected=u[0],oe(()=>e=!1)),n.$set(i)},i(u){r||(g(n.$$.fragment,u),r=!0)},o(u){h(n.$$.fragment,u),r=!1},d(u){u&&_(t),P(n)}}}function Ne(l){var r;let t,n,e=((r=l[4])==null?void 0:r.curves)&&l[2]&&l[3]&&ne(l);return{c(){e&&e.c(),t=j()},l(s){e&&e.l(s),t=j()},m(s,f){e&&e.m(s,f),b(s,t,f),n=!0},p(s,f){var u;((u=s[4])==null?void 0:u.curves)&&s[2]&&s[3]?e?(e.p(s,f),f&28&&g(e,1)):(e=ne(s),e.c(),g(e,1),e.m(t.parentNode,t)):e&&(Q(),h(e,1,1,()=>{e=null}),U())},i(s){n||(g(e),n=!0)},o(s){h(e),n=!1},d(s){e&&e.d(s),s&&_(t)}}}function Ae(l){let t;return{c(){t=V("div"),this.h()},l(n){t=W(n,"DIV",{slot:!0,style:!0}),Y(t).forEach(_),this.h()},h(){M(t,"slot","background"),fe(t,"background","#aaa")},m(n,e){b(n,t,e)},p:L,d(n){n&&_(t)}}}function He(l){let t,n;const e=l[7].default,r=me(e,l,l[12],null);return{c(){t=V("div"),r&&r.c(),this.h()},l(s){t=W(s,"DIV",{slot:!0});var f=Y(t);r&&r.l(f),f.forEach(_),this.h()},h(){M(t,"slot","headerButton")},m(s,f){b(s,t,f),r&&r.m(t,null),n=!0},p(s,f){r&&r.p&&(!n||f&4096)&&_e(r,e,s,s[12],n?ge(e,s[12],f,null):de(s[12]),null)},i(s){n||(g(r,s),n=!0)},o(s){h(r,s),n=!1},d(s){s&&_(t),r&&r.d(s)}}}function Ve(l){let t;return{c(){t=I("Place turbine | Instructions")},l(n){t=D(n,"Place turbine | Instructions")},m(n,e){b(n,t,e)},d(n){n&&_(t)}}}function We(l){let t,n;return t=new le({props:{back:!0,to:"/scan/mapscanning",$$slots:{default:[Be]},$$scope:{ctx:l}}}),{c(){y(t.$$.fragment)},l(e){T(t.$$.fragment,e)},m(e,r){S(t,e,r),n=!0},p(e,r){const s={};r&4096&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){P(t,e)}}}function Ye(l){let t,n,e,r,s=l[3].length>0&&re(l);function f(){return l[10](l[17],l[16])}return e=new Z({props:{icon:$e,$$slots:{default:[Fe]},$$scope:{ctx:l}}}),e.$on("click",f),{c(){t=V("div"),s&&s.c(),n=R(),y(e.$$.fragment),this.h()},l(u){t=W(u,"DIV",{class:!0});var a=Y(t);s&&s.l(a),n=q(a),T(e.$$.fragment,a),a.forEach(_),this.h()},h(){M(t,"class","editTurbines svelte-1invhxf")},m(u,a){b(u,t,a),s&&s.m(t,null),C(t,n),S(e,t,null),r=!0},p(u,a){l=u,l[3].length>0?s?(s.p(l,a),a&8&&g(s,1)):(s=re(l),s.c(),g(s,1),s.m(t,n)):s&&(Q(),h(s,1,1,()=>{s=null}),U());const i={};a&4096&&(i.$$scope={dirty:a,ctx:l}),e.$set(i)},i(u){r||(g(s),g(e.$$.fragment,u),r=!0)},o(u){h(s),h(e.$$.fragment,u),r=!1},d(u){u&&_(t),s&&s.d(),P(e)}}}function Be(l){let t;return{c(){t=I("No image found. Go to map scanning")},l(n){t=D(n,"No image found. Go to map scanning")},m(n,e){b(n,t,e)},d(n){n&&_(t)}}}function re(l){let t,n;return t=new Z({props:{secondary:!0,icon:be,$$slots:{default:[Me]},$$scope:{ctx:l}}}),t.$on("click",l[5]),{c(){y(t.$$.fragment)},l(e){T(t.$$.fragment,e)},m(e,r){S(t,e,r),n=!0},p(e,r){const s={};r&4096&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){P(t,e)}}}function Me(l){let t;return{c(){t=I("Clear all")},l(n){t=D(n,"Clear all")},m(n,e){b(n,t,e)},d(n){n&&_(t)}}}function Fe(l){let t;return{c(){t=I("Add steam turbine")},l(n){t=D(n,"Add steam turbine")},m(n,e){b(n,t,e)},d(n){n&&_(t)}}}function ze(l){let t,n,e,r,s,f;t=new Z({props:{secondary:!0,icon:pe,$$slots:{default:[Ve]},$$scope:{ctx:l}}}),t.$on("click",l[9]);const u=[Ye,We],a=[];function i(c,o){return c[4]?0:1}return e=i(l),r=a[e]=u[e](l),{c(){y(t.$$.fragment),n=R(),r.c(),s=j()},l(c){T(t.$$.fragment,c),n=q(c),r.l(c),s=j()},m(c,o){S(t,c,o),b(c,n,o),a[e].m(c,o),b(c,s,o),f=!0},p(c,o){const v={};o&4096&&(v.$$scope={dirty:o,ctx:c}),t.$set(v);let p=e;e=i(c),e===p?a[e].p(c,o):(Q(),h(a[p],1,1,()=>{a[p]=null}),U(),r=a[e],r?r.p(c,o):(r=a[e]=u[e](c),r.c()),g(r,1),r.m(s.parentNode,s))},i(c){f||(g(t.$$.fragment,c),g(r),f=!0)},o(c){h(t.$$.fragment,c),h(r),f=!1},d(c){P(t,c),c&&_(n),a[e].d(c),c&&_(s)}}}function Ge(l){let t,n,e,r,s;function f(a){l[8](a)}let u={title:"transformation instructions",closeButtons:"top",$$slots:{default:[De]},$$scope:{ctx:l}};return l[1]!==void 0&&(u.visible=l[1]),t=new ye({props:u}),se.push(()=>ae(t,"visible",f)),r=new we({props:{$$slots:{footer:[ze,({foregroundHeight:a,foregroundWidth:i})=>({16:a,17:i}),({foregroundHeight:a,foregroundWidth:i})=>(a?65536:0)|(i?131072:0)],headerButton:[He,({foregroundHeight:a,foregroundWidth:i})=>({16:a,17:i}),({foregroundHeight:a,foregroundWidth:i})=>(a?65536:0)|(i?131072:0)],background:[Ae,({foregroundHeight:a,foregroundWidth:i})=>({16:a,17:i}),({foregroundHeight:a,foregroundWidth:i})=>(a?65536:0)|(i?131072:0)],default:[Ne,({foregroundHeight:a,foregroundWidth:i})=>({16:a,17:i}),({foregroundHeight:a,foregroundWidth:i})=>(a?65536:0)|(i?131072:0)]},$$scope:{ctx:l}}}),{c(){y(t.$$.fragment),e=R(),y(r.$$.fragment)},l(a){T(t.$$.fragment,a),e=q(a),T(r.$$.fragment,a)},m(a,i){S(t,a,i),b(a,e,i),S(r,a,i),s=!0},p(a,[i]){const c={};i&4096&&(c.$$scope={dirty:i,ctx:a}),!n&&i&2&&(n=!0,c.visible=a[1],oe(()=>n=!1)),t.$set(c);const o={};i&200735&&(o.$$scope={dirty:i,ctx:a}),r.$set(o)},i(a){s||(g(t.$$.fragment,a),g(r.$$.fragment,a),s=!0)},o(a){h(t.$$.fragment,a),h(r.$$.fragment,a),s=!1},d(a){P(t,a),a&&_(e),P(r,a)}}}function Le(l,t,n){let e,r,s,f;H(l,ue,m=>n(2,e=m)),H(l,O,m=>n(3,r=m)),H(l,ie,m=>n(13,s=m)),H(l,ke,m=>n(4,f=m));let{$$slots:u={},$$scope:a}=t,i=-1,c=!1;function o(m,N,z,ee){if(r.length>=e.max_steam_turbines)return;const d=new te(m,N,20);d.enableSelection();for(let A of r)for(;d.isTooCloseTo(A.x,A.y,e.min_steam_turbine_separation);){let B=d.x-A.x,w=d.y-A.y;B==0&&(B=.001),w==0&&(w=.001),d.x+=B,d.y+=w}let G=!1,X=d;for(;;){G=!1,(d.x<=0||d.x>=z||d.y<=0||d.y>=ee)&&(d.x=20+Math.random()*(z-40),d.y=20+Math.random()*(ee-40));for(let w of r)d.isTooCloseTo(w.x,w.y,e.min_steam_turbine_separation)&&(G=!0,X=w);for(let w of s)d.isTooCloseTo(w[0],w[1],e.min_crater_distance)&&(G==!1&&(X=new te(w[0],w[1],20)),G=!0);if(!G)break;let A=d.x-X.x,B=d.y-X.y;A==0&&(A=.001),B==0&&(B=.001),d.x+=A,d.y+=B}O.add(d)}function v(){i!=-1&&(O.remove(i),n(0,i=-1))}function p(){for(let m=r.length-1;m>=0;m--)n(0,i=m),v()}function $(m,N){let z=!1;for(;r.length<e.min_steam_turbines;)o(m/8,N/8,m,N),z=!0;z||o(m/8,N/8,m,N-100)}function k(m){c=m,n(1,c)}const E=()=>n(1,c=!c),F=(m,N)=>$(m,N-100);function ce(m){i=m,n(0,i)}return l.$$set=m=>{"$$scope"in m&&n(12,a=m.$$scope)},[i,c,e,r,f,p,$,u,k,E,F,ce,a]}class Oe extends x{constructor(t){super(),J(this,t,Le,Ge,K,{})}}function Re(l){let t,n=l[0].params.slug+"",e;return{c(){t=I("Apply and go to "),e=I(n)},l(r){t=D(r,"Apply and go to "),e=D(r,n)},m(r,s){b(r,t,s),b(r,e,s)},p(r,s){s&1&&n!==(n=r[0].params.slug+"")&&he(e,n)},d(r){r&&_(t),r&&_(e)}}}function qe(l){let t,n;return t=new le({props:{back:!0,to:"/visualise/"+l[0].params.slug,$$slots:{default:[Re]},$$scope:{ctx:l}}}),{c(){y(t.$$.fragment)},l(e){T(t.$$.fragment,e)},m(e,r){S(t,e,r),n=!0},p(e,r){const s={};r&1&&(s.to="/visualise/"+e[0].params.slug),r&3&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){P(t,e)}}}function Xe(l){let t,n;return t=new Oe({props:{$$slots:{default:[qe]},$$scope:{ctx:l}}}),{c(){y(t.$$.fragment)},l(e){T(t.$$.fragment,e)},m(e,r){S(t,e,r),n=!0},p(e,[r]){const s={};r&3&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){P(t,e)}}}const rt=!0;function je(l,t,n){let e;return H(l,Te,r=>n(0,e=r)),[e]}class st extends x{constructor(t){super(),J(this,t,je,Xe,K,{})}}export{st as default,rt as prerender};
