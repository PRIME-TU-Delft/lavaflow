import{S as K,i as Q,s as U,k as P,w as h,a as N,l as S,m as M,x as y,h as c,c as I,n as B,b as m,y as V,H as X,g as Y,t as v,d as Z,f as k,z as A,G as D,q as w,r as E,e as G,I as ee,u as te,N as x,O as ne,a2 as q,p as j,P as se,o as le}from"../../../../chunks/index-5adb68ea.js";import{B as L,I as ae,h as re,i as oe}from"../../../../chunks/Button-52912701.js";import{t as ie,a as J}from"../../../../chunks/contourLineStore-ac16300d.js";import{g as H}from"../../../../chunks/gltfStore-3cd6707b.js";import{g as O}from"../../../../chunks/navigation-5b342094.js";import{A as ue,h as fe,a as ce}from"../../../../chunks/aframe-master-018190e7.js";import{d as _e}from"../../../../chunks/debugStore-f048b367.js";import{d as me}from"../../../../chunks/difficultyStore-7cc4eead.js";function $e(i){let e;return{c(){e=w("Back to preview")},l(t){e=E(t,"Back to preview")},m(t,n){m(t,e,n)},d(t){t&&c(e)}}}function pe(i){let e;return{c(){e=w("Place targets")},l(t){e=E(t,"Place targets")},m(t,n){m(t,e,n)},d(t){t&&c(e)}}}function be(i){let e,t;return e=new L({props:{disabled:!0,secondary:!0,$$slots:{default:[de]},$$scope:{ctx:i}}}),{c(){h(e.$$.fragment)},l(n){y(e.$$.fragment,n)},m(n,a){V(e,n,a),t=!0},p(n,a){const l={};a&512&&(l.$$scope={dirty:a,ctx:n}),e.$set(l)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){v(e.$$.fragment,n),t=!1},d(n){A(e,n)}}}function ge(i){let e,t,n,a;const l=[ke,ve],s=[];function o(f,$){return f[0]?0:1}return e=o(i),t=s[e]=l[e](i),{c(){t.c(),n=G()},l(f){t.l(f),n=G()},m(f,$){s[e].m(f,$),m(f,n,$),a=!0},p(f,$){let g=e;e=o(f),e===g?s[e].p(f,$):(Y(),v(s[g],1,1,()=>{s[g]=null}),Z(),t=s[e],t?t.p(f,$):(t=s[e]=l[e](f),t.c()),k(t,1),t.m(n.parentNode,n))},i(f){a||(k(t),a=!0)},o(f){v(t),a=!1},d(f){s[e].d(f),f&&c(n)}}}function de(i){let e;return{c(){e=w("Place targets to begin")},l(t){e=E(t,"Place targets to begin")},m(t,n){m(t,e,n)},d(t){t&&c(e)}}}function ve(i){let e,t;return e=new L({props:{$$slots:{default:[we]},$$scope:{ctx:i}}}),e.$on("click",i[5]),{c(){h(e.$$.fragment)},l(n){y(e.$$.fragment,n)},m(n,a){V(e,n,a),t=!0},p(n,a){const l={};a&512&&(l.$$scope={dirty:a,ctx:n}),e.$set(l)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){v(e.$$.fragment,n),t=!1},d(n){A(e,n)}}}function ke(i){let e,t,n,a;return e=new L({props:{secondary:!0,$$slots:{default:[Ee]},$$scope:{ctx:i}}}),e.$on("click",i[7]),n=new L({props:{green:!0,$$slots:{default:[he]},$$scope:{ctx:i}}}),{c(){h(e.$$.fragment),t=N(),h(n.$$.fragment)},l(l){y(e.$$.fragment,l),t=I(l),y(n.$$.fragment,l)},m(l,s){V(e,l,s),m(l,t,s),V(n,l,s),a=!0},p(l,s){const o={};s&512&&(o.$$scope={dirty:s,ctx:l}),e.$set(o);const f={};s&514&&(f.$$scope={dirty:s,ctx:l}),n.$set(f)},i(l){a||(k(e.$$.fragment,l),k(n.$$.fragment,l),a=!0)},o(l){v(e.$$.fragment,l),v(n.$$.fragment,l),a=!1},d(l){A(e,l),l&&c(t),A(n,l)}}}function we(i){let e,t,n,a,l;return a=new ae({props:{path:re}}),{c(){e=P("span"),t=w("Reveal lava"),n=N(),h(a.$$.fragment)},l(s){e=S(s,"SPAN",{});var o=M(e);t=E(o,"Reveal lava"),o.forEach(c),n=I(s),y(a.$$.fragment,s)},m(s,o){m(s,e,o),X(e,t),m(s,n,o),V(a,s,o),l=!0},p:ee,i(s){l||(k(a.$$.fragment,s),l=!0)},o(s){v(a.$$.fragment,s),l=!1},d(s){s&&c(e),s&&c(n),A(a,s)}}}function Ee(i){let e;return{c(){e=w("Hide lava")},l(t){e=E(t,"Hide lava")},m(t,n){m(t,e,n)},d(t){t&&c(e)}}}function he(i){let e,t,n,a,l;return{c(){e=w("Energy: "),t=w(i[1]),n=w(" / "),a=w(T),l=w(" MW")},l(s){e=E(s,"Energy: "),t=E(s,i[1]),n=E(s," / "),a=E(s,T),l=E(s," MW")},m(s,o){m(s,e,o),m(s,t,o),m(s,n,o),m(s,a,o),m(s,l,o)},p(s,o){o&2&&te(t,s[1])},d(s){s&&c(e),s&&c(t),s&&c(n),s&&c(a),s&&c(l)}}}function ye(i){let e,t,n,a,l,s,o,f,$;t=new L({props:{$$slots:{default:[$e]},$$scope:{ctx:i}}}),t.$on("click",i[4]),l=new L({props:{$$slots:{default:[pe]},$$scope:{ctx:i}}}),l.$on("click",i[3]);const g=[ge,be],d=[];function _(r,p){return r[2].length>0?0:1}return o=_(i),f=d[o]=g[o](i),{c(){e=P("div"),h(t.$$.fragment),n=N(),a=P("div"),h(l.$$.fragment),s=N(),f.c(),this.h()},l(r){e=S(r,"DIV",{class:!0});var p=M(e);y(t.$$.fragment,p),p.forEach(c),n=I(r),a=S(r,"DIV",{class:!0});var R=M(a);y(l.$$.fragment,R),s=I(R),f.l(R),R.forEach(c),this.h()},h(){B(e,"class","backButton"),B(a,"class","button rightButton svelte-x4wr97")},m(r,p){m(r,e,p),V(t,e,null),m(r,n,p),m(r,a,p),V(l,a,null),X(a,s),d[o].m(a,null),$=!0},p(r,[p]){const R={};p&512&&(R.$$scope={dirty:p,ctx:r}),t.$set(R);const z={};p&512&&(z.$$scope={dirty:p,ctx:r}),l.$set(z);let u=o;o=_(r),o===u?d[o].p(r,p):(Y(),v(d[u],1,1,()=>{d[u]=null}),Z(),f=d[o],f?f.p(r,p):(f=d[o]=g[o](r),f.c()),k(f,1),f.m(a,null))},i(r){$||(k(t.$$.fragment,r),k(l.$$.fragment,r),k(f),$=!0)},o(r){v(t.$$.fragment,r),v(l.$$.fragment,r),v(f),$=!1},d(r){r&&c(e),A(t),r&&c(n),r&&c(a),A(l),d[o].d()}}}const T=1e3;function Ve(i,e,t){let n;D(i,ie,_=>t(2,n=_));let{sceneEl:a}=e,{lavaVisible:l=!1}=e,{points:s=0}=e;async function o(){await a.exitVR()}async function f(){await o(),O("/targetplacement/ar")}async function $(){await o(),O("/scan/preview")}function g(){t(1,s=H.computePlayerPoints(T)),t(0,l=!0)}const d=()=>t(0,l=!1);return i.$$set=_=>{"sceneEl"in _&&t(6,a=_.sceneEl),"lavaVisible"in _&&t(0,l=_.lavaVisible),"points"in _&&t(1,s=_.points)},[l,s,n,f,$,g,a,d]}class Ae extends K{constructor(e){super(),Q(this,e,Ve,ye,U,{sceneEl:6,lavaVisible:0,points:1})}}function Re(i){let e;return{c(){e=w("Native AR Mode")},l(t){e=E(t,"Native AR Mode")},m(t,n){m(t,e,n)},d(t){t&&c(e)}}}function Be(i){let e,t,n,a,l,s,o,f,$,g,d,_,r,p;t=new ue({props:{scale:i[2],rotation:Pe,lava_revealed:i[1]}});function R(u){i[4](u)}let z={sceneEl:i[0]};return i[1]!==void 0&&(z.lavaVisible=i[1]),o=new Ae({props:z}),x.push(()=>ne(o,"lavaVisible",R)),r=new L({props:{icon:oe,$$slots:{default:[Re]},$$scope:{ctx:i}}}),{c(){e=P("a-scene"),h(t.$$.fragment),n=N(),a=P("a-camera"),l=N(),s=P("div"),h(o.$$.fragment),$=N(),g=P("a"),d=N(),_=P("a"),h(r.$$.fragment),this.h()},l(u){e=S(u,"A-SCENE",{"vr-mode-ui":!0,webxr:!0});var b=M(e);y(t.$$.fragment,b),n=I(b),a=S(b,"A-CAMERA",{position:!0}),M(a).forEach(c),b.forEach(c),l=I(u),s=S(u,"DIV",{id:!0,class:!0});var C=M(s);y(o.$$.fragment,C),C.forEach(c),$=I(u),g=S(u,"A",{id:!0,style:!0}),M(g).forEach(c),d=I(u),_=S(u,"A",{id:!0,href:!0,style:!0,class:!0});var W=M(_);y(r.$$.fragment,W),W.forEach(c),this.h()},h(){q(a,"position","0 3 3"),q(e,"vr-mode-ui","enterVRButton: #myEnterVRButton; enterARButton: #myEnterARButton"),q(e,"webxr","optionalFeatures: dom-overlay; overlayElement: #overlay;"),B(s,"id","overlay"),B(s,"class","svelte-o8ubtv"),B(g,"id","myEnterVRButton"),j(g,"display","none"),B(_,"id","myEnterARButton"),B(_,"href",""),j(_,"z-index","200000"),B(_,"class","svelte-o8ubtv")},m(u,b){m(u,e,b),V(t,e,null),X(e,n),X(e,a),i[3](e),m(u,l,b),m(u,s,b),V(o,s,null),m(u,$,b),m(u,g,b),m(u,d,b),m(u,_,b),V(r,_,null),p=!0},p(u,[b]){const C={};b&4&&(C.scale=u[2]),b&2&&(C.lava_revealed=u[1]),t.$set(C);const W={};b&1&&(W.sceneEl=u[0]),!f&&b&2&&(f=!0,W.lavaVisible=u[1],se(()=>f=!1)),o.$set(W);const F={};b&1024&&(F.$$scope={dirty:b,ctx:u}),r.$set(F)},i(u){p||(k(t.$$.fragment,u),k(o.$$.fragment,u),k(r.$$.fragment,u),p=!0)},o(u){v(t.$$.fragment,u),v(o.$$.fragment,u),v(r.$$.fragment,u),p=!1},d(u){u&&c(e),A(t),i[3](null),u&&c(l),u&&c(s),A(o),u&&c($),u&&c(g),u&&c(d),u&&c(_),A(r)}}}let Pe=0;function Se(i,e,t){let n,a,l,s,o;D(i,J,r=>t(5,a=r)),D(i,me,r=>t(6,l=r)),D(i,_e,r=>t(7,s=r)),D(i,H,r=>t(8,o=r));let f,$=!1,g=[.05,.025,.05];le(async()=>{if(!o){if(!s&&!a){O("/scan/mapscanning");return}a||(console.warn("SCENE VIEWER: gltf is loaded from hardcoded data"),J.setup({curves:fe,hierarchy:ce,size:{width:800,height:960}})),await H.setup(a,l.lava_forking),H.build(a)}});function d(r){x[r?"unshift":"push"](()=>{f=r,t(0,f)})}function _(r){$=r,t(1,$)}return t(2,n=g.map(r=>r)),[f,$,n,d,_]}class He extends K{constructor(e){super(),Q(this,e,Se,Be,U,{})}}export{He as default};
