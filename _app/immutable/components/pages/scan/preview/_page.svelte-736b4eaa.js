import{S as A,i as L,s as P,e as y,b as g,g as R,t as c,I as k,d as q,f,h as l,w as _,x as h,y as $,z as p,G as H,o as Q,k as w,l as S,m as W,n as F,p as T,a as B,c as V,J as U,K as X,q as E,r as N,H as G}from"../../../../chunks/index-5adb68ea.js";import{P as Y}from"../../../../chunks/P5-902ad660.js";import{N as Z,B as C,I as J,d as K}from"../../../../chunks/NavigationButton-c1f93d2e.js";import{P as x}from"../../../../chunks/Page-9ad24f39.js";import{g as M}from"../../../../chunks/navigation-5b342094.js";import{a as ee}from"../../../../chunks/contourLineStore-50093bfb.js";import{g as D}from"../../../../chunks/gltfStore-129b4548.js";import{d as te}from"../../../../chunks/difficultyStore-7cc4eead.js";import{d as re}from"../../../../chunks/debugStore-f048b367.js";function I(a){let t,o;return t=new Y({props:{sketch:a[1]}}),{c(){_(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,s){$(t,e,s),o=!0},p:k,i(e){o||(f(t.$$.fragment,e),o=!0)},o(e){c(t.$$.fragment,e),o=!1},d(e){p(t,e)}}}function ne(a){let t=a[0],o,e,s=I(a);return{c(){s.c(),o=y()},l(n){s.l(n),o=y()},m(n,r){s.m(n,r),g(n,o,r),e=!0},p(n,[r]){r&1&&P(t,t=n[0])?(R(),c(s,1,1,k),q(),s=I(n),s.c(),f(s,1),s.m(o.parentNode,o)):s.p(n,r)},i(n){e||(f(s),e=!0)},o(n){c(s),e=!1},d(n){n&&l(o),s.d(n)}}}function oe(a,t,o){let{debugMode:e=!1}=t,{foregroundWidth:s}=t,{foregroundHeight:n}=t,{curves:r}=t,{hierarchy:i}=t;const m=u=>{u.setup=()=>{u.createCanvas(s,n),u.background(230),r.forEach((b,v)=>{u.strokeWeight(1),u.stroke(30),u.fill(30),e&&u.text(`${v} (${i[v]})`,b[0][0]-10,b[0][1]-10),u.strokeWeight(4),u.noFill(),u.beginShape();for(let d of b){let O=d[0],j=d[1];u.vertex(O,j)}u.endShape(u.CLOSE)})}};return a.$$set=u=>{"debugMode"in u&&o(0,e=u.debugMode),"foregroundWidth"in u&&o(2,s=u.foregroundWidth),"foregroundHeight"in u&&o(3,n=u.foregroundHeight),"curves"in u&&o(4,r=u.curves),"hierarchy"in u&&o(5,i=u.hierarchy)},[e,m,s,n,r,i]}class se extends A{constructor(t){super(),L(this,t,oe,ne,P,{debugMode:0,foregroundWidth:2,foregroundHeight:3,curves:4,hierarchy:5})}}function z(a){let t,o,e,s;return o=new se({props:{debugMode:a[4],curves:a[3].curves,hierarchy:a[3].hierarchy,foregroundHeight:a[1],foregroundWidth:a[0]}}),{c(){t=w("div"),_(o.$$.fragment),this.h()},l(n){t=S(n,"DIV",{class:!0});var r=W(t);h(o.$$.fragment,r),r.forEach(l),this.h()},h(){F(t,"class","sketch svelte-1upoge"),U(()=>a[7].call(t))},m(n,r){g(n,t,r),$(o,t,null),e=X(t,a[7].bind(t)),s=!0},p(n,r){const i={};r&16&&(i.debugMode=n[4]),r&8&&(i.curves=n[3].curves),r&8&&(i.hierarchy=n[3].hierarchy),r&2&&(i.foregroundHeight=n[1]),r&1&&(i.foregroundWidth=n[0]),o.$set(i)},i(n){s||(f(o.$$.fragment,n),s=!0)},o(n){c(o.$$.fragment,n),s=!1},d(n){n&&l(t),p(o),e()}}}function ae(a){var s,n;let t,o,e=((s=a[3])==null?void 0:s.curves)&&((n=a[3])==null?void 0:n.hierarchy)&&z(a);return{c(){e&&e.c(),t=y()},l(r){e&&e.l(r),t=y()},m(r,i){e&&e.m(r,i),g(r,t,i),o=!0},p(r,i){var m,u;((m=r[3])==null?void 0:m.curves)&&((u=r[3])==null?void 0:u.hierarchy)?e?(e.p(r,i),i&8&&f(e,1)):(e=z(r),e.c(),f(e,1),e.m(t.parentNode,t)):e&&(R(),c(e,1,1,()=>{e=null}),q())},i(r){o||(f(e),o=!0)},o(r){c(e),o=!1},d(r){e&&e.d(r),r&&l(t)}}}function ie(a){let t;return{c(){t=E("Back to selection")},l(o){t=N(o,"Back to selection")},m(o,e){g(o,t,e)},d(o){o&&l(t)}}}function ue(a){let t,o;return t=new Z({props:{slot:"headerButton",to:"/scan/maptransform",back:!0,$$slots:{default:[ie]},$$scope:{ctx:a}}}),{c(){_(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,s){$(t,e,s),o=!0},p(e,s){const n={};s&512&&(n.$$scope={dirty:s,ctx:e}),t.$set(n)},i(e){o||(f(t.$$.fragment,e),o=!0)},o(e){c(t.$$.fragment,e),o=!1},d(e){p(t,e)}}}function le(a){let t;return{c(){t=w("div"),this.h()},l(o){t=S(o,"DIV",{slot:!0,style:!0}),W(t).forEach(l),this.h()},h(){F(t,"slot","background"),T(t,"background","#aaa")},m(o,e){g(o,t,e)},p:k,d(o){o&&l(t)}}}function fe(a){let t,o,e,s,n;return s=new J({props:{path:K}}),{c(){t=w("span"),o=E("Visualise as 3D model"),e=B(),_(s.$$.fragment)},l(r){t=S(r,"SPAN",{});var i=W(t);o=N(i,"Visualise as 3D model"),i.forEach(l),e=V(r),h(s.$$.fragment,r)},m(r,i){g(r,t,i),G(t,o),g(r,e,i),$(s,r,i),n=!0},p:k,i(r){n||(f(s.$$.fragment,r),n=!0)},o(r){c(s.$$.fragment,r),n=!1},d(r){r&&l(t),r&&l(e),p(s,r)}}}function ce(a){let t,o,e,s,n;return s=new J({props:{path:K}}),{c(){t=w("span"),o=E("Visualise in AR"),e=B(),_(s.$$.fragment)},l(r){t=S(r,"SPAN",{});var i=W(t);o=N(i,"Visualise in AR"),i.forEach(l),e=V(r),h(s.$$.fragment,r)},m(r,i){g(r,t,i),G(t,o),g(r,e,i),$(s,r,i),n=!0},p:k,i(r){n||(f(s.$$.fragment,r),n=!0)},o(r){c(s.$$.fragment,r),n=!1},d(r){r&&l(t),r&&l(e),p(s,r)}}}function me(a){let t,o,e,s;return t=new C({props:{secondary:!0,loading:!a[2],$$slots:{default:[fe]},$$scope:{ctx:a}}}),t.$on("click",a[5]),e=new C({props:{loading:!a[2],$$slots:{default:[ce]},$$scope:{ctx:a}}}),e.$on("click",a[6]),{c(){_(t.$$.fragment),o=B(),_(e.$$.fragment)},l(n){h(t.$$.fragment,n),o=V(n),h(e.$$.fragment,n)},m(n,r){$(t,n,r),g(n,o,r),$(e,n,r),s=!0},p(n,r){const i={};r&4&&(i.loading=!n[2]),r&512&&(i.$$scope={dirty:r,ctx:n}),t.$set(i);const m={};r&4&&(m.loading=!n[2]),r&512&&(m.$$scope={dirty:r,ctx:n}),e.$set(m)},i(n){s||(f(t.$$.fragment,n),f(e.$$.fragment,n),s=!0)},o(n){c(t.$$.fragment,n),c(e.$$.fragment,n),s=!1},d(n){p(t,n),n&&l(o),p(e,n)}}}function ge(a){let t,o;return t=new x({props:{$$slots:{footer:[me],background:[le],headerButton:[ue],default:[ae]},$$scope:{ctx:a}}}),{c(){_(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,s){$(t,e,s),o=!0},p(e,[s]){const n={};s&543&&(n.$$scope={dirty:s,ctx:e}),t.$set(n)},i(e){o||(f(t.$$.fragment,e),o=!0)},o(e){c(t.$$.fragment,e),o=!1},d(e){p(t,e)}}}const Se=!0;function de(a,t,o){let e,s,n;H(a,ee,d=>o(3,e=d)),H(a,te,d=>o(8,s=d)),H(a,re,d=>o(4,n=d));let r,i,m=!1;Q(async()=>{if(!e.curves||!e.hierarchy)return M("/scan/mapscanning");await D.setup(e,s.lava_forking),D.build(e),o(2,m=!0)});const u=()=>M("/visualise/model"),b=()=>M("/visualise/ar");function v(){r=this.clientWidth,i=this.clientHeight,o(0,r),o(1,i)}return[r,i,m,e,n,u,b,v]}class We extends A{constructor(t){super(),L(this,t,de,ge,P,{})}}export{We as default,Se as prerender};
